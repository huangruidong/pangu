{"version":3,"sources":["webpack:///./node_modules/nedb/index.js","webpack:///./node_modules/core-js/modules/es.string.split.js","webpack:///./node_modules/core-js/modules/web.dom-collections.for-each.js","webpack:///./node_modules/core-js/internals/array-for-each.js","webpack:///./node_modules/nedb/browser-version/browser-specific/lib/storage.js","webpack:///./node_modules/core-js/modules/es.regexp.to-string.js","webpack:///./node_modules/util/node_modules/inherits/inherits_browser.js","webpack:///./node_modules/util/util.js","webpack:///./node_modules/nedb/browser-version/browser-specific/lib/customUtils.js","webpack:///./node_modules/core-js/modules/es.array.for-each.js","webpack:///./node_modules/node-libs-browser/mock/process.js","webpack:///./node_modules/core-js/internals/is-regexp.js","webpack:///./node_modules/nedb/lib/datastore.js","webpack:///./node_modules/nedb/node_modules/underscore/underscore.js","webpack:///./node_modules/nedb/lib/model.js","webpack:///./node_modules/nedb/lib/persistence.js","webpack:///./node_modules/core-js/modules/es.array.find.js","webpack:///./node_modules/binary-search-tree/node_modules/underscore/underscore.js","webpack:///./node_modules/binary-search-tree/lib/customUtils.js","webpack:///./node_modules/binary-search-tree/lib/bst.js","webpack:///./node_modules/nedb/node_modules/async/lib/async.js","webpack:///./node_modules/localforage/dist/localforage.js","webpack:///./node_modules/binary-search-tree/lib/avltree.js","webpack:///./node_modules/core-js/internals/array-method-is-strict.js","webpack:///./node_modules/nedb/lib/indexes.js","webpack:///./node_modules/binary-search-tree/index.js","webpack:///./node_modules/core-js/internals/array-iteration.js","webpack:///./node_modules/util/support/isBufferBrowser.js","webpack:///./node_modules/core-js/modules/web.dom-collections.iterator.js","webpack:///./node_modules/path-browserify/index.js","webpack:///./node_modules/nedb/lib/executor.js","webpack:///./node_modules/events/events.js","webpack:///./node_modules/nedb/lib/cursor.js","webpack:///./node_modules/core-js/internals/dom-iterables.js"],"names":["Datastore","module","exports","fixRegExpWellKnownSymbolLogic","isRegExp","anObject","requireObjectCoercible","speciesConstructor","advanceStringIndex","toLength","callRegExpExec","regexpExec","fails","arrayPush","push","min","Math","MAX_UINT32","SUPPORTS_Y","RegExp","SPLIT","nativeSplit","maybeCallNative","internalSplit","split","length","separator","limit","string","String","this","lim","undefined","call","match","lastIndex","lastLength","output","flags","ignoreCase","multiline","unicode","sticky","lastLastIndex","separatorCopy","source","slice","index","apply","test","O","splitter","regexp","res","done","value","rx","S","C","unicodeMatching","p","q","A","e","z","i","global","DOMIterables","forEach","createNonEnumerableProperty","COLLECTION_NAME","Collection","CollectionPrototype","prototype","error","$forEach","arrayMethodIsStrict","arrayMethodUsesToLength","STRICT_METHOD","USES_TO_LENGTH","callbackfn","arguments","localforage","exists","filename","callback","getItem","err","rename","newFilename","removeItem","setItem","writeFile","contents","options","appendFile","toAppend","readFile","unlink","mkdirp","dir","ensureDatafileIntegrity","config","name","storeName","crashSafeWriteFile","redefine","TO_STRING","RegExpPrototype","nativeToString","NOT_GENERIC","INCORRECT_NAME","R","rf","f","unsafe","Object","create","ctor","superCtor","super_","constructor","enumerable","writable","configurable","TempCtor","getOwnPropertyDescriptors","obj","keys","descriptors","getOwnPropertyDescriptor","formatRegExp","format","isString","objects","inspect","join","args","len","str","replace","x","Number","JSON","stringify","_","isNull","isObject","deprecate","fn","msg","process","noDeprecation","warned","deprecated","throwDeprecation","Error","traceDeprecation","console","trace","debugEnviron","debugs","opts","ctx","seen","stylize","stylizeNoColor","depth","colors","isBoolean","showHidden","_extend","isUndefined","customInspect","stylizeWithColor","formatValue","styleType","style","styles","arrayToHash","array","hash","val","idx","recurseTimes","isFunction","ret","primitive","formatPrimitive","visibleKeys","getOwnPropertyNames","isError","indexOf","formatError","toString","isDate","Date","base","braces","isArray","n","toUTCString","formatArray","map","key","formatProperty","pop","reduceToSingleString","simple","isNumber","l","hasOwnProperty","desc","get","set","line","substr","reduce","prev","cur","numLinesEst","ar","Array","arg","isNullOrUndefined","isSymbol","re","objectToString","d","isPrimitive","o","pad","debuglog","NODE_DEBUG","toUpperCase","pid","isBuffer","months","timestamp","time","getHours","getMinutes","getSeconds","getDate","getMonth","prop","log","inherits","origin","add","kCustomPromisifiedSymbol","Symbol","callbackifyOnRejected","reason","cb","newReason","callbackify","original","TypeError","callbackified","maybeCb","self","then","nextTick","rej","setPrototypeOf","getPrototypeOf","defineProperties","promisify","defineProperty","promiseResolve","promiseReject","promise","Promise","resolve","reject","custom","randomBytes","size","r","bytes","random","byteArrayToBase64","uint8","temp","lookup","extraBytes","tripletToBase64","num","uid","ceil","max","$","target","proto","forced","shift","setTimeout","platform","arch","execPath","title","browser","env","argv","binding","path","cwd","chdir","exit","kill","umask","dlopen","uptime","memoryUsage","uvCounters","features","classof","wellKnownSymbol","MATCH","it","customUtils","model","async","Executor","Index","util","Persistence","Cursor","inMemoryOnly","autoload","timestampData","compareStrings","persistence","db","nodeWebkitAppName","afterSerialization","beforeDeserialization","corruptAlertThreshold","executor","ready","indexes","_id","fieldName","unique","ttlIndexes","loadDatabase","onload","EventEmitter","getAllData","getAll","resetIndexes","newData","reset","ensureIndex","missingFieldName","expireAfterSeconds","insert","persistNewState","$$indexCreated","removeIndex","$$indexRemoved","addToIndexes","doc","failingIndex","remove","removeFromIndexes","updateIndexes","oldDoc","newDoc","update","revertUpdate","getCandidates","query","dontExpireStaleDocs","usableQueryKeys","indexNames","waterfall","k","intersection","getMatching","$in","getBetweenBounds","docs","expiredDocsIds","validDocs","ttlIndexesFieldNames","valid","now","getTime","eachSeries","_remove","_insert","preparedDoc","prepareDocumentForInsertion","_insertInCache","deepCopy","createNewId","tentativeId","createdAt","updatedAt","checkObject","_insertMultipleDocsInCache","preparedDocs","failingI","count","cursor","exec","find","projection","findOne","_update","updateQuery","multi","upsert","numReplaced","_exec","toBeInserted","modify","modifiedDoc","modifications","candidates","updatedDocs","pluck","returnUpdatedDocs","updatedDocsDC","numRemoved","removedDocs","$$deleted","root","previousUnderscore","breaker","ArrayProto","ObjProto","FuncProto","Function","concat","nativeForEach","nativeMap","nativeReduce","nativeReduceRight","reduceRight","nativeFilter","filter","nativeEvery","every","nativeSome","some","nativeIndexOf","nativeLastIndexOf","lastIndexOf","nativeIsArray","nativeKeys","nativeBind","bind","_wrapped","VERSION","each","iterator","context","has","collect","results","list","reduceError","foldl","inject","memo","initial","foldr","detect","result","any","select","all","identity","contains","include","invoke","method","isFunc","where","attrs","first","isEmpty","findWhere","Infinity","computed","shuffle","rand","shuffled","lookupIterator","sortBy","criteria","sort","left","right","a","b","group","behavior","groupBy","countBy","sortedIndex","low","high","mid","toArray","values","head","take","guard","last","rest","tail","drop","compact","flatten","input","shallow","without","difference","uniq","isSorted","union","item","other","zip","object","from","hasIndex","range","start","stop","step","func","partial","bindAll","funcs","functions","memoize","hasher","delay","wait","defer","throttle","timeout","previous","later","remaining","clearTimeout","debounce","immediate","callNow","once","ran","wrap","wrapper","compose","after","times","pairs","invert","methods","names","extend","pick","copy","omit","defaults","clone","tap","interceptor","eq","aStack","bStack","className","aCtor","bCtor","isEqual","isElement","nodeType","isArguments","isFinite","isNaN","parseFloat","noConflict","accum","floor","entityMap","escape","unescape","entityRegexes","property","mixin","idCounter","uniqueId","prefix","id","templateSettings","evaluate","interpolate","noMatch","escapes","escaper","template","text","data","settings","render","matcher","offset","variable","chain","_chain","modifierFunctions","lastStepModifierFunctions","comparisonFunctions","logicalOperators","arrayComparisonFunctions","checkKey","v","serialize","$$date","deserialize","rawData","parse","strictKeys","isPrimitiveType","compareNSB","compareArrays","comp","compareThings","_compareStrings","aKeys","bKeys","createModifierFunction","modifier","field","fieldParts","modifiers","firstChars","dollarFirstChars","c","m","getDotValue","objs","parseInt","areThingsEqual","areComparable","queryKeys","queryKey","queryValue","matchQueryPart","needAKey","treatObjAsValue","objValue","$regex","$set","$unset","$push","$slice","$each","end","$addToSet","addToSet","$pop","$pull","arr","splice","$inc","$max","$min","$lt","$lte","$gt","$gte","$ne","$nin","$exists","$size","$elemMatch","$or","$and","$not","$where","storage","j","randomString","charAt","s","getNWAppFilename","ensureDirectoryExists","appName","relativeFilename","home","LOCALAPPDATA","APPDATA","HOME","persistCachedDatabase","toPersist","sparse","emit","compactDatafile","setAutocompactionInterval","interval","minInterval","realInterval","stopAutocompaction","autocompactionIntervalId","setInterval","clearInterval","newDocs","treatRawData","dataById","tdata","corruptItems","dirname","treatedData","processBuffer","$find","addToUnscopables","FIND","SKIPS_HOLES","getRandomArray","next","defaultCompareKeysFunction","defaultCheckValueEquality","BinarySearchTree","parent","compareKeys","checkValueEquality","append","getMaxKeyDescendant","getMaxKey","getMinKeyDescendant","getMinKey","checkAllNodesFullfillCondition","checkNodeOrdering","checkInternalPointers","checkIsBST","getNumberOfKeys","createSimilar","createLeftChild","leftChild","createRightChild","rightChild","errorType","search","getLowerBoundMatcher","getUpperBoundMatcher","betweenBounds","lbm","ubm","deleteIfLeaf","deleteIfOnlyOneChild","child","delete","replaceWith","executeOnEveryNode","prettyPrint","printData","spacing","previous_async","only_once","called","_each","_map","_reduce","_keys","setImmediate","completed","iterate","forEachSeries","eachLimit","_eachLimit","forEachLimit","started","running","replenish","doParallel","doParallelLimit","doSeries","_asyncMap","eachfn","mapSeries","mapLimit","_mapLimit","reversed","reverse","_filter","filterSeries","selectSeries","_reject","rejectSeries","_detect","main_callback","detectSeries","auto","tasks","listeners","addListener","unshift","removeListener","taskComplete","task","taskCallback","safeResults","rkey","requires","abs","listener","wrapIterator","_parallel","parallel","parallelLimit","series","makeCallback","_concat","y","concatSeries","whilst","doWhilst","until","doUntil","queue","worker","concurrency","pos","saturated","workers","empty","drain","cargo","payload","working","ts","ds","_console_fn","queues","memoized","unmemoized","unmemoize","counter","timesSeries","fns","that","newargs","nextargs","_applyEach","go","applyEach","applyEachSeries","forever","t","u","require","code","1","_dereq_","scheduleDrain","draining","Mutation","MutationObserver","WebKitMutationObserver","observer","element","document","createTextNode","observe","characterData","MessageChannel","createElement","scriptEl","onreadystatechange","parentNode","removeChild","documentElement","appendChild","channel","port1","onmessage","port2","postMessage","oldQueue","window","2","INTERNAL","handlers","REJECTED","FULFILLED","PENDING","resolver","state","outcome","safelyResolveThenable","QueueItem","onFulfilled","onRejected","callFulfilled","otherCallFulfilled","callRejected","otherCallRejected","unwrap","returnValue","getThen","thenable","onError","onSuccess","tryToUnwrap","tryCatch","status","out","iterable","resolved","allResolver","resolveFromAll","outValue","race","response","3","4","_typeof","_classCallCheck","instance","Constructor","getIDB","indexedDB","webkitIndexedDB","mozIndexedDB","OIndexedDB","msIndexedDB","idb","isIndexedDBValid","isSafari","openDatabase","navigator","userAgent","hasFetch","fetch","IDBKeyRange","createBlob","parts","properties","Blob","Builder","BlobBuilder","MSBlobBuilder","MozBlobBuilder","WebKitBlobBuilder","builder","getBlob","type","Promise$1","executeCallback","executeTwoCallbacks","errorCallback","normalizeKey","warn","getCallback","DETECT_BLOB_SUPPORT_STORE","supportsBlobs","dbContexts","READ_ONLY","READ_WRITE","_binStringToArrayBuffer","bin","buf","ArrayBuffer","Uint8Array","charCodeAt","_checkBlobSupportWithoutCaching","txn","transaction","blob","objectStore","put","onabort","preventDefault","stopPropagation","oncomplete","matchedChrome","matchedEdge","_checkBlobSupport","_deferReadiness","dbInfo","dbContext","deferredOperation","deferredOperations","dbReady","_advanceReadiness","_rejectReadiness","_getConnection","upgradeNeeded","createDbContext","close","dbArgs","version","openreq","open","onupgradeneeded","createObjectStore","oldVersion","ex","newVersion","onerror","onsuccess","_getOriginalConnection","_getUpgradedConnection","_isUpgradeNeeded","defaultVersion","isNewStore","objectStoreNames","isDowngrade","isUpgrade","incVersion","_encodeBlob","reader","FileReader","onloadend","base64","btoa","__local_forage_encoded_blob","readAsBinaryString","_decodeBlob","encodedBlob","arrayBuff","atob","_isEncodedBlob","_fullyReady","_initReady","_dbInfo","_tryReconnect","forages","forage","createTransaction","mode","retries","tx","_initStorage","initPromises","ignoreErrors","_defaultConfig","store","req","openCursor","iterationNumber","blobSupport","clear","advanced","advance","dropInstance","currentConfig","isCurrentDb","dbPromise","dropObjectPromise","deleteObjectStore","_forage2","dropDBPromise","deleteDatabase","onblocked","_forage","asyncStorage","_driver","_support","isWebSQLValid","BASE_CHARS","BLOB_TYPE_PREFIX","BLOB_TYPE_PREFIX_REGEX","SERIALIZED_MARKER","SERIALIZED_MARKER_LENGTH","TYPE_ARRAYBUFFER","TYPE_BLOB","TYPE_INT8ARRAY","TYPE_UINT8ARRAY","TYPE_UINT8CLAMPEDARRAY","TYPE_INT16ARRAY","TYPE_INT32ARRAY","TYPE_UINT16ARRAY","TYPE_UINT32ARRAY","TYPE_FLOAT32ARRAY","TYPE_FLOAT64ARRAY","TYPE_SERIALIZED_MARKER_LENGTH","toString$1","stringToBuffer","serializedString","encoded1","encoded2","encoded3","encoded4","bufferLength","buffer","bufferToString","base64String","substring","valueType","marker","fileReader","readAsArrayBuffer","blobType","Int8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","localforageSerializer","createDbTable","executeSql","_initStorage$1","dbInfoPromise","description","serializer","tryExecuteSql","sqlStatement","SYNTAX_ERR","rows","getItem$1","iterate$1","_setItem","retriesLeft","originalValue","sqlError","QUOTA_ERR","setItem$1","removeItem$1","clear$1","length$1","key$1","keys$1","getAllStoreNames","storeNames","dropInstance$1","operationInfo","dropTable","operations","webSQLStorage","isLocalStorageValid","localStorage","_getKeyPrefix","defaultConfig","keyPrefix","checkIfLocalStorageThrows","localStorageTestKey","_isLocalStorageUsable","_initStorage$2","clear$2","getItem$2","iterate$2","keyPrefixLength","key$2","keys$2","itemKey","length$2","removeItem$2","setItem$2","dropInstance$2","localStorageWrapper","sameValue","includes","searchElement","DefinedDrivers","DriverSupport","DefaultDrivers","INDEXEDDB","WEBSQL","LOCALSTORAGE","DefaultDriverOrder","OptionalDriverMethods","LibraryMethods","DefaultConfig","driver","callWhenReady","localForageInstance","libraryMethod","_args","_key","LocalForage","driverTypeKey","driverName","defineDriver","_config","_driverSet","_initDriver","_ready","_wrapLibraryMethodsWithReady","setDriver","driverObject","complianceError","driverMethods","driverMethodName","isRequired","configureMissingMethods","methodNotImplementedFactory","methodName","_i","_len","optionalDriverMethod","setDriverSupport","support","info","getDriver","getDriverPromise","getSerializer","serializerPromise","drivers","supportedDrivers","_getSupportedDrivers","setDriverToConfig","extendSelfWithDriver","initDriver","currentDriverIndex","driverPromiseLoop","oldDriverSetDone","supports","libraryMethodsAndProperties","createInstance","localforage_js","AVLTree","tree","_AVLTree","checkHeightCorrect","leftH","rightH","height","balanceFactor","checkBalanceFactors","checkIsAVLT","rightRotation","ah","bh","ch","leftRotation","rightTooSmall","leftTooSmall","rebalanceAlongPath","rotated","newRoot","insertPath","currentNode","newTree","deletePath","METHOD_NAME","argument","projectForUnique","elt","treeOptions","insertMultipleDocs","updateMultipleDocs","revert","pair","_res","node","IndexedObject","toObject","arraySpeciesCreate","createMethod","TYPE","IS_MAP","IS_FILTER","IS_SOME","IS_EVERY","IS_FIND_INDEX","NO_HOLES","$this","specificCreate","boundFunction","findIndex","fill","readUInt8","ArrayIteratorMethods","ITERATOR","TO_STRING_TAG","ArrayValues","normalizeArray","allowAboveRoot","up","basename","matchedSlash","xs","resolvedPath","resolvedAbsolute","normalize","isAbsolute","trailingSlash","paths","relative","to","trim","fromParts","toParts","samePartsLength","outputParts","sep","delimiter","hasRoot","ext","extname","startDot","startPart","preDotState","newArguments","lastArg","forceQueuing","ReflectOwnKeys","Reflect","ReflectApply","receiver","ProcessEmitWarning","warning","ownKeys","getOwnPropertySymbols","NumberIsNaN","init","_events","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","_getMaxListeners","_addListener","prepend","events","existing","newListener","w","emitter","onceWrapper","fired","wrapFn","_onceWrap","wrapped","_listeners","evlistener","unwrapListeners","arrayClone","listenerCount","spliceOne","RangeError","setMaxListeners","getMaxListeners","doError","er","message","handler","on","prependListener","prependOnceListener","position","originalListener","off","removeAllListeners","rawListeners","eventNames","execFn","_limit","skip","_skip","sortQuery","_sort","_projection","project","keepId","action","candidate","toPush","_callback","added","skipped","direction","criterion","compare","CSSRuleList","CSSStyleDeclaration","CSSValueList","ClientRectList","DOMRectList","DOMStringList","DOMTokenList","DataTransferItemList","FileList","HTMLAllCollection","HTMLCollection","HTMLFormElement","HTMLSelectElement","MediaList","MimeTypeArray","NamedNodeMap","NodeList","PaintRequestList","Plugin","PluginArray","SVGLengthList","SVGNumberList","SVGPathSegList","SVGPointList","SVGStringList","SVGTransformList","SourceBufferList","StyleSheetList","TextTrackCueList","TextTrackList","TouchList"],"mappings":"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","file":"js/chunk-84c0a4a8.d991c289.js","sourcesContent":["var Datastore = require('./lib/datastore');\n\nmodule.exports = Datastore;\n","'use strict';\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar isRegExp = require('../internals/is-regexp');\nvar anObject = require('../internals/an-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar speciesConstructor = require('../internals/species-constructor');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar toLength = require('../internals/to-length');\nvar callRegExpExec = require('../internals/regexp-exec-abstract');\nvar regexpExec = require('../internals/regexp-exec');\nvar fails = require('../internals/fails');\n\nvar arrayPush = [].push;\nvar min = Math.min;\nvar MAX_UINT32 = 0xFFFFFFFF;\n\n// babel-minify transpiles RegExp('x', 'y') -> /x/y and it causes SyntaxError\nvar SUPPORTS_Y = !fails(function () { return !RegExp(MAX_UINT32, 'y'); });\n\n// @@split logic\nfixRegExpWellKnownSymbolLogic('split', 2, function (SPLIT, nativeSplit, maybeCallNative) {\n  var internalSplit;\n  if (\n    'abbc'.split(/(b)*/)[1] == 'c' ||\n    'test'.split(/(?:)/, -1).length != 4 ||\n    'ab'.split(/(?:ab)*/).length != 2 ||\n    '.'.split(/(.?)(.?)/).length != 4 ||\n    '.'.split(/()()/).length > 1 ||\n    ''.split(/.?/).length\n  ) {\n    // based on es5-shim implementation, need to rework it\n    internalSplit = function (separator, limit) {\n      var string = String(requireObjectCoercible(this));\n      var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;\n      if (lim === 0) return [];\n      if (separator === undefined) return [string];\n      // If `separator` is not a regex, use native split\n      if (!isRegExp(separator)) {\n        return nativeSplit.call(string, separator, lim);\n      }\n      var output = [];\n      var flags = (separator.ignoreCase ? 'i' : '') +\n                  (separator.multiline ? 'm' : '') +\n                  (separator.unicode ? 'u' : '') +\n                  (separator.sticky ? 'y' : '');\n      var lastLastIndex = 0;\n      // Make `global` and avoid `lastIndex` issues by working with a copy\n      var separatorCopy = new RegExp(separator.source, flags + 'g');\n      var match, lastIndex, lastLength;\n      while (match = regexpExec.call(separatorCopy, string)) {\n        lastIndex = separatorCopy.lastIndex;\n        if (lastIndex > lastLastIndex) {\n          output.push(string.slice(lastLastIndex, match.index));\n          if (match.length > 1 && match.index < string.length) arrayPush.apply(output, match.slice(1));\n          lastLength = match[0].length;\n          lastLastIndex = lastIndex;\n          if (output.length >= lim) break;\n        }\n        if (separatorCopy.lastIndex === match.index) separatorCopy.lastIndex++; // Avoid an infinite loop\n      }\n      if (lastLastIndex === string.length) {\n        if (lastLength || !separatorCopy.test('')) output.push('');\n      } else output.push(string.slice(lastLastIndex));\n      return output.length > lim ? output.slice(0, lim) : output;\n    };\n  // Chakra, V8\n  } else if ('0'.split(undefined, 0).length) {\n    internalSplit = function (separator, limit) {\n      return separator === undefined && limit === 0 ? [] : nativeSplit.call(this, separator, limit);\n    };\n  } else internalSplit = nativeSplit;\n\n  return [\n    // `String.prototype.split` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.split\n    function split(separator, limit) {\n      var O = requireObjectCoercible(this);\n      var splitter = separator == undefined ? undefined : separator[SPLIT];\n      return splitter !== undefined\n        ? splitter.call(separator, O, limit)\n        : internalSplit.call(String(O), separator, limit);\n    },\n    // `RegExp.prototype[@@split]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@split\n    //\n    // NOTE: This cannot be properly polyfilled in engines that don't support\n    // the 'y' flag.\n    function (regexp, limit) {\n      var res = maybeCallNative(internalSplit, regexp, this, limit, internalSplit !== nativeSplit);\n      if (res.done) return res.value;\n\n      var rx = anObject(regexp);\n      var S = String(this);\n      var C = speciesConstructor(rx, RegExp);\n\n      var unicodeMatching = rx.unicode;\n      var flags = (rx.ignoreCase ? 'i' : '') +\n                  (rx.multiline ? 'm' : '') +\n                  (rx.unicode ? 'u' : '') +\n                  (SUPPORTS_Y ? 'y' : 'g');\n\n      // ^(? + rx + ) is needed, in combination with some S slicing, to\n      // simulate the 'y' flag.\n      var splitter = new C(SUPPORTS_Y ? rx : '^(?:' + rx.source + ')', flags);\n      var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;\n      if (lim === 0) return [];\n      if (S.length === 0) return callRegExpExec(splitter, S) === null ? [S] : [];\n      var p = 0;\n      var q = 0;\n      var A = [];\n      while (q < S.length) {\n        splitter.lastIndex = SUPPORTS_Y ? q : 0;\n        var z = callRegExpExec(splitter, SUPPORTS_Y ? S : S.slice(q));\n        var e;\n        if (\n          z === null ||\n          (e = min(toLength(splitter.lastIndex + (SUPPORTS_Y ? 0 : q)), S.length)) === p\n        ) {\n          q = advanceStringIndex(S, q, unicodeMatching);\n        } else {\n          A.push(S.slice(p, q));\n          if (A.length === lim) return A;\n          for (var i = 1; i <= z.length - 1; i++) {\n            A.push(z[i]);\n            if (A.length === lim) return A;\n          }\n          q = p = e;\n        }\n      }\n      A.push(S.slice(p));\n      return A;\n    }\n  ];\n}, !SUPPORTS_Y);\n","var global = require('../internals/global');\nvar DOMIterables = require('../internals/dom-iterables');\nvar forEach = require('../internals/array-for-each');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  var Collection = global[COLLECTION_NAME];\n  var CollectionPrototype = Collection && Collection.prototype;\n  // some Chrome versions have non-configurable methods on DOMTokenList\n  if (CollectionPrototype && CollectionPrototype.forEach !== forEach) try {\n    createNonEnumerableProperty(CollectionPrototype, 'forEach', forEach);\n  } catch (error) {\n    CollectionPrototype.forEach = forEach;\n  }\n}\n","'use strict';\nvar $forEach = require('../internals/array-iteration').forEach;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar STRICT_METHOD = arrayMethodIsStrict('forEach');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('forEach');\n\n// `Array.prototype.forEach` method implementation\n// https://tc39.github.io/ecma262/#sec-array.prototype.foreach\nmodule.exports = (!STRICT_METHOD || !USES_TO_LENGTH) ? function forEach(callbackfn /* , thisArg */) {\n  return $forEach(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n} : [].forEach;\n","/**\n * Way data is stored for this database\n * For a Node.js/Node Webkit database it's the file system\n * For a browser-side database it's localforage, which uses the best backend available (IndexedDB then WebSQL then localStorage)\n *\n * This version is the browser version\n */\n\nvar localforage = require('localforage')\n\n// Configure localforage to display NeDB name for now. Would be a good idea to let user use his own app name\nlocalforage.config({\n  name: 'NeDB'\n, storeName: 'nedbdata'\n});\n\n\nfunction exists (filename, callback) {\n  localforage.getItem(filename, function (err, value) {\n    if (value !== null) {   // Even if value is undefined, localforage returns null\n      return callback(true);\n    } else {\n      return callback(false);\n    }\n  });\n}\n\n\nfunction rename (filename, newFilename, callback) {\n  localforage.getItem(filename, function (err, value) {\n    if (value === null) {\n      localforage.removeItem(newFilename, function () { return callback(); });\n    } else {\n      localforage.setItem(newFilename, value, function () {\n        localforage.removeItem(filename, function () { return callback(); });\n      });\n    }\n  });\n}\n\n\nfunction writeFile (filename, contents, options, callback) {\n  // Options do not matter in browser setup\n  if (typeof options === 'function') { callback = options; }\n  localforage.setItem(filename, contents, function () { return callback(); });\n}\n\n\nfunction appendFile (filename, toAppend, options, callback) {\n  // Options do not matter in browser setup\n  if (typeof options === 'function') { callback = options; }\n\n  localforage.getItem(filename, function (err, contents) {\n    contents = contents || '';\n    contents += toAppend;\n    localforage.setItem(filename, contents, function () { return callback(); });\n  });\n}\n\n\nfunction readFile (filename, options, callback) {\n  // Options do not matter in browser setup\n  if (typeof options === 'function') { callback = options; }\n  localforage.getItem(filename, function (err, contents) { return callback(null, contents || ''); });\n}\n\n\nfunction unlink (filename, callback) {\n  localforage.removeItem(filename, function () { return callback(); });\n}\n\n\n// Nothing to do, no directories will be used on the browser\nfunction mkdirp (dir, callback) {\n  return callback();\n}\n\n\n// Nothing to do, no data corruption possible in the brower\nfunction ensureDatafileIntegrity (filename, callback) {\n  return callback(null);\n}\n\n\n// Interface\nmodule.exports.exists = exists;\nmodule.exports.rename = rename;\nmodule.exports.writeFile = writeFile;\nmodule.exports.crashSafeWriteFile = writeFile;   // No need for a crash safe function in the browser\nmodule.exports.appendFile = appendFile;\nmodule.exports.readFile = readFile;\nmodule.exports.unlink = unlink;\nmodule.exports.mkdirp = mkdirp;\nmodule.exports.ensureDatafileIntegrity = ensureDatafileIntegrity;\n\n","'use strict';\nvar redefine = require('../internals/redefine');\nvar anObject = require('../internals/an-object');\nvar fails = require('../internals/fails');\nvar flags = require('../internals/regexp-flags');\n\nvar TO_STRING = 'toString';\nvar RegExpPrototype = RegExp.prototype;\nvar nativeToString = RegExpPrototype[TO_STRING];\n\nvar NOT_GENERIC = fails(function () { return nativeToString.call({ source: 'a', flags: 'b' }) != '/a/b'; });\n// FF44- RegExp#toString has a wrong name\nvar INCORRECT_NAME = nativeToString.name != TO_STRING;\n\n// `RegExp.prototype.toString` method\n// https://tc39.github.io/ecma262/#sec-regexp.prototype.tostring\nif (NOT_GENERIC || INCORRECT_NAME) {\n  redefine(RegExp.prototype, TO_STRING, function toString() {\n    var R = anObject(this);\n    var p = String(R.source);\n    var rf = R.flags;\n    var f = String(rf === undefined && R instanceof RegExp && !('flags' in RegExpPrototype) ? flags.call(R) : rf);\n    return '/' + p + '/' + f;\n  }, { unsafe: true });\n}\n","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar getOwnPropertyDescriptors = Object.getOwnPropertyDescriptors ||\n  function getOwnPropertyDescriptors(obj) {\n    var keys = Object.keys(obj);\n    var descriptors = {};\n    for (var i = 0; i < keys.length; i++) {\n      descriptors[keys[i]] = Object.getOwnPropertyDescriptor(obj, keys[i]);\n    }\n    return descriptors;\n  };\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  if (typeof process !== 'undefined' && process.noDeprecation === true) {\n    return fn;\n  }\n\n  // Allow for deprecating things in the process of starting up.\n  if (typeof process === 'undefined') {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nvar kCustomPromisifiedSymbol = typeof Symbol !== 'undefined' ? Symbol('util.promisify.custom') : undefined;\n\nexports.promisify = function promisify(original) {\n  if (typeof original !== 'function')\n    throw new TypeError('The \"original\" argument must be of type Function');\n\n  if (kCustomPromisifiedSymbol && original[kCustomPromisifiedSymbol]) {\n    var fn = original[kCustomPromisifiedSymbol];\n    if (typeof fn !== 'function') {\n      throw new TypeError('The \"util.promisify.custom\" argument must be of type Function');\n    }\n    Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n      value: fn, enumerable: false, writable: false, configurable: true\n    });\n    return fn;\n  }\n\n  function fn() {\n    var promiseResolve, promiseReject;\n    var promise = new Promise(function (resolve, reject) {\n      promiseResolve = resolve;\n      promiseReject = reject;\n    });\n\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n    args.push(function (err, value) {\n      if (err) {\n        promiseReject(err);\n      } else {\n        promiseResolve(value);\n      }\n    });\n\n    try {\n      original.apply(this, args);\n    } catch (err) {\n      promiseReject(err);\n    }\n\n    return promise;\n  }\n\n  Object.setPrototypeOf(fn, Object.getPrototypeOf(original));\n\n  if (kCustomPromisifiedSymbol) Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n    value: fn, enumerable: false, writable: false, configurable: true\n  });\n  return Object.defineProperties(\n    fn,\n    getOwnPropertyDescriptors(original)\n  );\n}\n\nexports.promisify.custom = kCustomPromisifiedSymbol\n\nfunction callbackifyOnRejected(reason, cb) {\n  // `!reason` guard inspired by bluebird (Ref: https://goo.gl/t5IS6M).\n  // Because `null` is a special error value in callbacks which means \"no error\n  // occurred\", we error-wrap so the callback consumer can distinguish between\n  // \"the promise rejected with null\" or \"the promise fulfilled with undefined\".\n  if (!reason) {\n    var newReason = new Error('Promise was rejected with a falsy value');\n    newReason.reason = reason;\n    reason = newReason;\n  }\n  return cb(reason);\n}\n\nfunction callbackify(original) {\n  if (typeof original !== 'function') {\n    throw new TypeError('The \"original\" argument must be of type Function');\n  }\n\n  // We DO NOT return the promise as it gives the user a false sense that\n  // the promise is actually somehow related to the callback's execution\n  // and that the callback throwing will reject the promise.\n  function callbackified() {\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n\n    var maybeCb = args.pop();\n    if (typeof maybeCb !== 'function') {\n      throw new TypeError('The last argument must be of type Function');\n    }\n    var self = this;\n    var cb = function() {\n      return maybeCb.apply(self, arguments);\n    };\n    // In true node style we process the callback on `nextTick` with all the\n    // implications (stack, `uncaughtException`, `async_hooks`)\n    original.apply(this, args)\n      .then(function(ret) { process.nextTick(cb, null, ret) },\n            function(rej) { process.nextTick(callbackifyOnRejected, rej, cb) });\n  }\n\n  Object.setPrototypeOf(callbackified, Object.getPrototypeOf(original));\n  Object.defineProperties(callbackified,\n                          getOwnPropertyDescriptors(original));\n  return callbackified;\n}\nexports.callbackify = callbackify;\n","/**\n * Specific customUtils for the browser, where we don't have access to the Crypto and Buffer modules\n */\n\n/**\n * Taken from the crypto-browserify module\n * https://github.com/dominictarr/crypto-browserify\n * NOTE: Math.random() does not guarantee \"cryptographic quality\" but we actually don't need it\n */\nfunction randomBytes (size) {\n  var bytes = new Array(size);\n  var r;\n\n  for (var i = 0, r; i < size; i++) {\n    if ((i & 0x03) == 0) r = Math.random() * 0x100000000;\n    bytes[i] = r >>> ((i & 0x03) << 3) & 0xff;\n  }\n\n  return bytes;\n}\n\n\n/**\n * Taken from the base64-js module\n * https://github.com/beatgammit/base64-js/\n */\nfunction byteArrayToBase64 (uint8) {\n  var lookup = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\n    , extraBytes = uint8.length % 3   // if we have 1 byte left, pad 2 bytes\n    , output = \"\"\n    , temp, length, i;\n\n  function tripletToBase64 (num) {\n    return lookup[num >> 18 & 0x3F] + lookup[num >> 12 & 0x3F] + lookup[num >> 6 & 0x3F] + lookup[num & 0x3F];\n  };\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (i = 0, length = uint8.length - extraBytes; i < length; i += 3) {\n    temp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2]);\n    output += tripletToBase64(temp);\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  switch (extraBytes) {\n    case 1:\n      temp = uint8[uint8.length - 1];\n      output += lookup[temp >> 2];\n      output += lookup[(temp << 4) & 0x3F];\n      output += '==';\n      break;\n    case 2:\n      temp = (uint8[uint8.length - 2] << 8) + (uint8[uint8.length - 1]);\n      output += lookup[temp >> 10];\n      output += lookup[(temp >> 4) & 0x3F];\n      output += lookup[(temp << 2) & 0x3F];\n      output += '=';\n      break;\n  }\n\n  return output;\n}\n\n\n/**\n * Return a random alphanumerical string of length len\n * There is a very small probability (less than 1/1,000,000) for the length to be less than len\n * (il the base64 conversion yields too many pluses and slashes) but\n * that's not an issue here\n * The probability of a collision is extremely small (need 3*10^12 documents to have one chance in a million of a collision)\n * See http://en.wikipedia.org/wiki/Birthday_problem\n */\nfunction uid (len) {\n  return byteArrayToBase64(randomBytes(Math.ceil(Math.max(8, len * 2)))).replace(/[+\\/]/g, '').slice(0, len);\n}\n\n\n\nmodule.exports.uid = uid;\n","'use strict';\nvar $ = require('../internals/export');\nvar forEach = require('../internals/array-for-each');\n\n// `Array.prototype.forEach` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.foreach\n$({ target: 'Array', proto: true, forced: [].forEach != forEach }, {\n  forEach: forEach\n});\n","exports.nextTick = function nextTick(fn) {\n    var args = Array.prototype.slice.call(arguments);\n    args.shift();\n    setTimeout(function () {\n        fn.apply(null, args);\n    }, 0);\n};\n\nexports.platform = exports.arch = \nexports.execPath = exports.title = 'browser';\nexports.pid = 1;\nexports.browser = true;\nexports.env = {};\nexports.argv = [];\n\nexports.binding = function (name) {\n\tthrow new Error('No such module. (Possibly not yet loaded)')\n};\n\n(function () {\n    var cwd = '/';\n    var path;\n    exports.cwd = function () { return cwd };\n    exports.chdir = function (dir) {\n        if (!path) path = require('path');\n        cwd = path.resolve(dir, cwd);\n    };\n})();\n\nexports.exit = exports.kill = \nexports.umask = exports.dlopen = \nexports.uptime = exports.memoryUsage = \nexports.uvCounters = function() {};\nexports.features = {};\n","var isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\n\n// `IsRegExp` abstract operation\n// https://tc39.github.io/ecma262/#sec-isregexp\nmodule.exports = function (it) {\n  var isRegExp;\n  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : classof(it) == 'RegExp');\n};\n","var customUtils = require('./customUtils')\n  , model = require('./model')\n  , async = require('async')\n  , Executor = require('./executor')\n  , Index = require('./indexes')\n  , util = require('util')\n  , _ = require('underscore')\n  , Persistence = require('./persistence')\n  , Cursor = require('./cursor')\n  ;\n\n\n/**\n * Create a new collection\n * @param {String} options.filename Optional, datastore will be in-memory only if not provided\n * @param {Boolean} options.timestampData Optional, defaults to false. If set to true, createdAt and updatedAt will be created and populated automatically (if not specified by user)\n * @param {Boolean} options.inMemoryOnly Optional, defaults to false\n * @param {String} options.nodeWebkitAppName Optional, specify the name of your NW app if you want options.filename to be relative to the directory where\n *                                            Node Webkit stores application data such as cookies and local storage (the best place to store data in my opinion)\n * @param {Boolean} options.autoload Optional, defaults to false\n * @param {Function} options.onload Optional, if autoload is used this will be called after the load database with the error object as parameter. If you don't pass it the error will be thrown\n * @param {Function} options.afterSerialization/options.beforeDeserialization Optional, serialization hooks\n * @param {Number} options.corruptAlertThreshold Optional, threshold after which an alert is thrown if too much data is corrupt\n * @param {Function} options.compareStrings Optional, string comparison function that overrides default for sorting\n *\n * Event Emitter - Events\n * * compaction.done - Fired whenever a compaction operation was finished\n */\nfunction Datastore (options) {\n  var filename;\n\n  // Retrocompatibility with v0.6 and before\n  if (typeof options === 'string') {\n    filename = options;\n    this.inMemoryOnly = false;   // Default\n  } else {\n    options = options || {};\n    filename = options.filename;\n    this.inMemoryOnly = options.inMemoryOnly || false;\n    this.autoload = options.autoload || false;\n    this.timestampData = options.timestampData || false;\n  }\n\n  // Determine whether in memory or persistent\n  if (!filename || typeof filename !== 'string' || filename.length === 0) {\n    this.filename = null;\n    this.inMemoryOnly = true;\n  } else {\n    this.filename = filename;\n  }\n\n  // String comparison function\n  this.compareStrings = options.compareStrings;\n\n  // Persistence handling\n  this.persistence = new Persistence({ db: this, nodeWebkitAppName: options.nodeWebkitAppName\n                                      , afterSerialization: options.afterSerialization\n                                      , beforeDeserialization: options.beforeDeserialization\n                                      , corruptAlertThreshold: options.corruptAlertThreshold\n                                      });\n\n  // This new executor is ready if we don't use persistence\n  // If we do, it will only be ready once loadDatabase is called\n  this.executor = new Executor();\n  if (this.inMemoryOnly) { this.executor.ready = true; }\n\n  // Indexed by field name, dot notation can be used\n  // _id is always indexed and since _ids are generated randomly the underlying\n  // binary is always well-balanced\n  this.indexes = {};\n  this.indexes._id = new Index({ fieldName: '_id', unique: true });\n  this.ttlIndexes = {};\n\n  // Queue a load of the database right away and call the onload handler\n  // By default (no onload handler), if there is an error there, no operation will be possible so warn the user by throwing an exception\n  if (this.autoload) { this.loadDatabase(options.onload || function (err) {\n    if (err) { throw err; }\n  }); }\n}\n\nutil.inherits(Datastore, require('events').EventEmitter);\n\n\n/**\n * Load the database from the datafile, and trigger the execution of buffered commands if any\n */\nDatastore.prototype.loadDatabase = function () {\n  this.executor.push({ this: this.persistence, fn: this.persistence.loadDatabase, arguments: arguments }, true);\n};\n\n\n/**\n * Get an array of all the data in the database\n */\nDatastore.prototype.getAllData = function () {\n  return this.indexes._id.getAll();\n};\n\n\n/**\n * Reset all currently defined indexes\n */\nDatastore.prototype.resetIndexes = function (newData) {\n  var self = this;\n\n  Object.keys(this.indexes).forEach(function (i) {\n    self.indexes[i].reset(newData);\n  });\n};\n\n\n/**\n * Ensure an index is kept for this field. Same parameters as lib/indexes\n * For now this function is synchronous, we need to test how much time it takes\n * We use an async API for consistency with the rest of the code\n * @param {String} options.fieldName\n * @param {Boolean} options.unique\n * @param {Boolean} options.sparse\n * @param {Number} options.expireAfterSeconds - Optional, if set this index becomes a TTL index (only works on Date fields, not arrays of Date)\n * @param {Function} cb Optional callback, signature: err\n */\nDatastore.prototype.ensureIndex = function (options, cb) {\n  var err\n    , callback = cb || function () {};\n\n  options = options || {};\n\n  if (!options.fieldName) {\n    err = new Error(\"Cannot create an index without a fieldName\");\n    err.missingFieldName = true;\n    return callback(err);\n  }\n  if (this.indexes[options.fieldName]) { return callback(null); }\n\n  this.indexes[options.fieldName] = new Index(options);\n  if (options.expireAfterSeconds !== undefined) { this.ttlIndexes[options.fieldName] = options.expireAfterSeconds; }   // With this implementation index creation is not necessary to ensure TTL but we stick with MongoDB's API here\n\n  try {\n    this.indexes[options.fieldName].insert(this.getAllData());\n  } catch (e) {\n    delete this.indexes[options.fieldName];\n    return callback(e);\n  }\n\n  // We may want to force all options to be persisted including defaults, not just the ones passed the index creation function\n  this.persistence.persistNewState([{ $$indexCreated: options }], function (err) {\n    if (err) { return callback(err); }\n    return callback(null);\n  });\n};\n\n\n/**\n * Remove an index\n * @param {String} fieldName\n * @param {Function} cb Optional callback, signature: err\n */\nDatastore.prototype.removeIndex = function (fieldName, cb) {\n  var callback = cb || function () {};\n\n  delete this.indexes[fieldName];\n\n  this.persistence.persistNewState([{ $$indexRemoved: fieldName }], function (err) {\n    if (err) { return callback(err); }\n    return callback(null);\n  });\n};\n\n\n/**\n * Add one or several document(s) to all indexes\n */\nDatastore.prototype.addToIndexes = function (doc) {\n  var i, failingIndex, error\n    , keys = Object.keys(this.indexes)\n    ;\n\n  for (i = 0; i < keys.length; i += 1) {\n    try {\n      this.indexes[keys[i]].insert(doc);\n    } catch (e) {\n      failingIndex = i;\n      error = e;\n      break;\n    }\n  }\n\n  // If an error happened, we need to rollback the insert on all other indexes\n  if (error) {\n    for (i = 0; i < failingIndex; i += 1) {\n      this.indexes[keys[i]].remove(doc);\n    }\n\n    throw error;\n  }\n};\n\n\n/**\n * Remove one or several document(s) from all indexes\n */\nDatastore.prototype.removeFromIndexes = function (doc) {\n  var self = this;\n\n  Object.keys(this.indexes).forEach(function (i) {\n    self.indexes[i].remove(doc);\n  });\n};\n\n\n/**\n * Update one or several documents in all indexes\n * To update multiple documents, oldDoc must be an array of { oldDoc, newDoc } pairs\n * If one update violates a constraint, all changes are rolled back\n */\nDatastore.prototype.updateIndexes = function (oldDoc, newDoc) {\n  var i, failingIndex, error\n    , keys = Object.keys(this.indexes)\n    ;\n\n  for (i = 0; i < keys.length; i += 1) {\n    try {\n      this.indexes[keys[i]].update(oldDoc, newDoc);\n    } catch (e) {\n      failingIndex = i;\n      error = e;\n      break;\n    }\n  }\n\n  // If an error happened, we need to rollback the update on all other indexes\n  if (error) {\n    for (i = 0; i < failingIndex; i += 1) {\n      this.indexes[keys[i]].revertUpdate(oldDoc, newDoc);\n    }\n\n    throw error;\n  }\n};\n\n\n/**\n * Return the list of candidates for a given query\n * Crude implementation for now, we return the candidates given by the first usable index if any\n * We try the following query types, in this order: basic match, $in match, comparison match\n * One way to make it better would be to enable the use of multiple indexes if the first usable index\n * returns too much data. I may do it in the future.\n *\n * Returned candidates will be scanned to find and remove all expired documents\n *\n * @param {Query} query\n * @param {Boolean} dontExpireStaleDocs Optional, defaults to false, if true don't remove stale docs. Useful for the remove function which shouldn't be impacted by expirations\n * @param {Function} callback Signature err, docs\n */\nDatastore.prototype.getCandidates = function (query, dontExpireStaleDocs, callback) {\n  var indexNames = Object.keys(this.indexes)\n    , self = this\n    , usableQueryKeys;\n\n  if (typeof dontExpireStaleDocs === 'function') {\n    callback = dontExpireStaleDocs;\n    dontExpireStaleDocs = false;\n  }\n\n  async.waterfall([\n  // STEP 1: get candidates list by checking indexes from most to least frequent usecase\n  function (cb) {\n    // For a basic match\n    usableQueryKeys = [];\n    Object.keys(query).forEach(function (k) {\n      if (typeof query[k] === 'string' || typeof query[k] === 'number' || typeof query[k] === 'boolean' || util.isDate(query[k]) || query[k] === null) {\n        usableQueryKeys.push(k);\n      }\n    });\n    usableQueryKeys = _.intersection(usableQueryKeys, indexNames);\n    if (usableQueryKeys.length > 0) {\n      return cb(null, self.indexes[usableQueryKeys[0]].getMatching(query[usableQueryKeys[0]]));\n    }\n\n    // For a $in match\n    usableQueryKeys = [];\n    Object.keys(query).forEach(function (k) {\n      if (query[k] && query[k].hasOwnProperty('$in')) {\n        usableQueryKeys.push(k);\n      }\n    });\n    usableQueryKeys = _.intersection(usableQueryKeys, indexNames);\n    if (usableQueryKeys.length > 0) {\n      return cb(null, self.indexes[usableQueryKeys[0]].getMatching(query[usableQueryKeys[0]].$in));\n    }\n\n    // For a comparison match\n    usableQueryKeys = [];\n    Object.keys(query).forEach(function (k) {\n      if (query[k] && (query[k].hasOwnProperty('$lt') || query[k].hasOwnProperty('$lte') || query[k].hasOwnProperty('$gt') || query[k].hasOwnProperty('$gte'))) {\n        usableQueryKeys.push(k);\n      }\n    });\n    usableQueryKeys = _.intersection(usableQueryKeys, indexNames);\n    if (usableQueryKeys.length > 0) {\n      return cb(null, self.indexes[usableQueryKeys[0]].getBetweenBounds(query[usableQueryKeys[0]]));\n    }\n\n    // By default, return all the DB data\n    return cb(null, self.getAllData());\n  }\n  // STEP 2: remove all expired documents\n  , function (docs) {\n    if (dontExpireStaleDocs) { return callback(null, docs); }\n\n    var expiredDocsIds = [], validDocs = [], ttlIndexesFieldNames = Object.keys(self.ttlIndexes);\n\n    docs.forEach(function (doc) {\n      var valid = true;\n      ttlIndexesFieldNames.forEach(function (i) {\n        if (doc[i] !== undefined && util.isDate(doc[i]) && Date.now() > doc[i].getTime() + self.ttlIndexes[i] * 1000) {\n          valid = false;\n        }\n      });\n      if (valid) { validDocs.push(doc); } else { expiredDocsIds.push(doc._id); }\n    });\n\n    async.eachSeries(expiredDocsIds, function (_id, cb) {\n      self._remove({ _id: _id }, {}, function (err) {\n        if (err) { return callback(err); }\n        return cb();\n      });\n    }, function (err) {\n      return callback(null, validDocs);\n    });\n  }]);\n};\n\n\n/**\n * Insert a new document\n * @param {Function} cb Optional callback, signature: err, insertedDoc\n *\n * @api private Use Datastore.insert which has the same signature\n */\nDatastore.prototype._insert = function (newDoc, cb) {\n  var callback = cb || function () {}\n    , preparedDoc\n    ;\n\n  try {\n    preparedDoc = this.prepareDocumentForInsertion(newDoc)\n    this._insertInCache(preparedDoc);\n  } catch (e) {\n    return callback(e);\n  }\n\n  this.persistence.persistNewState(util.isArray(preparedDoc) ? preparedDoc : [preparedDoc], function (err) {\n    if (err) { return callback(err); }\n    return callback(null, model.deepCopy(preparedDoc));\n  });\n};\n\n/**\n * Create a new _id that's not already in use\n */\nDatastore.prototype.createNewId = function () {\n  var tentativeId = customUtils.uid(16);\n  // Try as many times as needed to get an unused _id. As explained in customUtils, the probability of this ever happening is extremely small, so this is O(1)\n  if (this.indexes._id.getMatching(tentativeId).length > 0) {\n    tentativeId = this.createNewId();\n  }\n  return tentativeId;\n};\n\n/**\n * Prepare a document (or array of documents) to be inserted in a database\n * Meaning adds _id and timestamps if necessary on a copy of newDoc to avoid any side effect on user input\n * @api private\n */\nDatastore.prototype.prepareDocumentForInsertion = function (newDoc) {\n  var preparedDoc, self = this;\n\n  if (util.isArray(newDoc)) {\n    preparedDoc = [];\n    newDoc.forEach(function (doc) { preparedDoc.push(self.prepareDocumentForInsertion(doc)); });\n  } else {\n    preparedDoc = model.deepCopy(newDoc);\n    if (preparedDoc._id === undefined) { preparedDoc._id = this.createNewId(); }\n    var now = new Date();\n    if (this.timestampData && preparedDoc.createdAt === undefined) { preparedDoc.createdAt = now; }\n    if (this.timestampData && preparedDoc.updatedAt === undefined) { preparedDoc.updatedAt = now; }\n    model.checkObject(preparedDoc);\n  }\n\n  return preparedDoc;\n};\n\n/**\n * If newDoc is an array of documents, this will insert all documents in the cache\n * @api private\n */\nDatastore.prototype._insertInCache = function (preparedDoc) {\n  if (util.isArray(preparedDoc)) {\n    this._insertMultipleDocsInCache(preparedDoc);\n  } else {\n    this.addToIndexes(preparedDoc);\n  }\n};\n\n/**\n * If one insertion fails (e.g. because of a unique constraint), roll back all previous\n * inserts and throws the error\n * @api private\n */\nDatastore.prototype._insertMultipleDocsInCache = function (preparedDocs) {\n  var i, failingI, error;\n\n  for (i = 0; i < preparedDocs.length; i += 1) {\n    try {\n      this.addToIndexes(preparedDocs[i]);\n    } catch (e) {\n      error = e;\n      failingI = i;\n      break;\n    }\n  }\n\n  if (error) {\n    for (i = 0; i < failingI; i += 1) {\n      this.removeFromIndexes(preparedDocs[i]);\n    }\n\n    throw error;\n  }\n};\n\nDatastore.prototype.insert = function () {\n  this.executor.push({ this: this, fn: this._insert, arguments: arguments });\n};\n\n\n/**\n * Count all documents matching the query\n * @param {Object} query MongoDB-style query\n */\nDatastore.prototype.count = function(query, callback) {\n  var cursor = new Cursor(this, query, function(err, docs, callback) {\n    if (err) { return callback(err); }\n    return callback(null, docs.length);\n  });\n\n  if (typeof callback === 'function') {\n    cursor.exec(callback);\n  } else {\n    return cursor;\n  }\n};\n\n\n/**\n * Find all documents matching the query\n * If no callback is passed, we return the cursor so that user can limit, skip and finally exec\n * @param {Object} query MongoDB-style query\n * @param {Object} projection MongoDB-style projection\n */\nDatastore.prototype.find = function (query, projection, callback) {\n  switch (arguments.length) {\n    case 1:\n      projection = {};\n      // callback is undefined, will return a cursor\n      break;\n    case 2:\n      if (typeof projection === 'function') {\n        callback = projection;\n        projection = {};\n      }   // If not assume projection is an object and callback undefined\n      break;\n  }\n\n  var cursor = new Cursor(this, query, function(err, docs, callback) {\n    var res = [], i;\n\n    if (err) { return callback(err); }\n\n    for (i = 0; i < docs.length; i += 1) {\n      res.push(model.deepCopy(docs[i]));\n    }\n    return callback(null, res);\n  });\n\n  cursor.projection(projection);\n  if (typeof callback === 'function') {\n    cursor.exec(callback);\n  } else {\n    return cursor;\n  }\n};\n\n\n/**\n * Find one document matching the query\n * @param {Object} query MongoDB-style query\n * @param {Object} projection MongoDB-style projection\n */\nDatastore.prototype.findOne = function (query, projection, callback) {\n  switch (arguments.length) {\n    case 1:\n      projection = {};\n      // callback is undefined, will return a cursor\n      break;\n    case 2:\n      if (typeof projection === 'function') {\n        callback = projection;\n        projection = {};\n      }   // If not assume projection is an object and callback undefined\n      break;\n  }\n\n  var cursor = new Cursor(this, query, function(err, docs, callback) {\n    if (err) { return callback(err); }\n    if (docs.length === 1) {\n      return callback(null, model.deepCopy(docs[0]));\n    } else {\n      return callback(null, null);\n    }\n  });\n\n  cursor.projection(projection).limit(1);\n  if (typeof callback === 'function') {\n    cursor.exec(callback);\n  } else {\n    return cursor;\n  }\n};\n\n\n/**\n * Update all docs matching query\n * @param {Object} query\n * @param {Object} updateQuery\n * @param {Object} options Optional options\n *                 options.multi If true, can update multiple documents (defaults to false)\n *                 options.upsert If true, document is inserted if the query doesn't match anything\n *                 options.returnUpdatedDocs Defaults to false, if true return as third argument the array of updated matched documents (even if no change actually took place)\n * @param {Function} cb Optional callback, signature: (err, numAffected, affectedDocuments, upsert)\n *                      If update was an upsert, upsert flag is set to true\n *                      affectedDocuments can be one of the following:\n *                        * For an upsert, the upserted document\n *                        * For an update with returnUpdatedDocs option false, null\n *                        * For an update with returnUpdatedDocs true and multi false, the updated document\n *                        * For an update with returnUpdatedDocs true and multi true, the array of updated documents\n *\n * WARNING: The API was changed between v1.7.4 and v1.8, for consistency and readability reasons. Prior and including to v1.7.4,\n *          the callback signature was (err, numAffected, updated) where updated was the updated document in case of an upsert\n *          or the array of updated documents for an update if the returnUpdatedDocs option was true. That meant that the type of\n *          affectedDocuments in a non multi update depended on whether there was an upsert or not, leaving only two ways for the\n *          user to check whether an upsert had occured: checking the type of affectedDocuments or running another find query on\n *          the whole dataset to check its size. Both options being ugly, the breaking change was necessary.\n *\n * @api private Use Datastore.update which has the same signature\n */\nDatastore.prototype._update = function (query, updateQuery, options, cb) {\n  var callback\n    , self = this\n    , numReplaced = 0\n    , multi, upsert\n    , i\n    ;\n\n  if (typeof options === 'function') { cb = options; options = {}; }\n  callback = cb || function () {};\n  multi = options.multi !== undefined ? options.multi : false;\n  upsert = options.upsert !== undefined ? options.upsert : false;\n\n  async.waterfall([\n  function (cb) {   // If upsert option is set, check whether we need to insert the doc\n    if (!upsert) { return cb(); }\n\n    // Need to use an internal function not tied to the executor to avoid deadlock\n    var cursor = new Cursor(self, query);\n    cursor.limit(1)._exec(function (err, docs) {\n      if (err) { return callback(err); }\n      if (docs.length === 1) {\n        return cb();\n      } else {\n        var toBeInserted;\n\n        try {\n          model.checkObject(updateQuery);\n          // updateQuery is a simple object with no modifier, use it as the document to insert\n          toBeInserted = updateQuery;\n        } catch (e) {\n          // updateQuery contains modifiers, use the find query as the base,\n          // strip it from all operators and update it according to updateQuery\n          try {\n            toBeInserted = model.modify(model.deepCopy(query, true), updateQuery);\n          } catch (err) {\n            return callback(err);\n          }\n        }\n\n        return self._insert(toBeInserted, function (err, newDoc) {\n          if (err) { return callback(err); }\n          return callback(null, 1, newDoc, true);\n        });\n      }\n    });\n  }\n  , function () {   // Perform the update\n    var modifiedDoc , modifications = [], createdAt;\n\n    self.getCandidates(query, function (err, candidates) {\n      if (err) { return callback(err); }\n\n      // Preparing update (if an error is thrown here neither the datafile nor\n      // the in-memory indexes are affected)\n      try {\n        for (i = 0; i < candidates.length; i += 1) {\n          if (model.match(candidates[i], query) && (multi || numReplaced === 0)) {\n            numReplaced += 1;\n            if (self.timestampData) { createdAt = candidates[i].createdAt; }\n            modifiedDoc = model.modify(candidates[i], updateQuery);\n            if (self.timestampData) {\n              modifiedDoc.createdAt = createdAt;\n              modifiedDoc.updatedAt = new Date();\n            }\n            modifications.push({ oldDoc: candidates[i], newDoc: modifiedDoc });\n          }\n        }\n      } catch (err) {\n        return callback(err);\n      }\n\n      // Change the docs in memory\n      try {\n        self.updateIndexes(modifications);\n      } catch (err) {\n        return callback(err);\n      }\n\n      // Update the datafile\n      var updatedDocs = _.pluck(modifications, 'newDoc');\n      self.persistence.persistNewState(updatedDocs, function (err) {\n        if (err) { return callback(err); }\n        if (!options.returnUpdatedDocs) {\n          return callback(null, numReplaced);\n        } else {\n          var updatedDocsDC = [];\n          updatedDocs.forEach(function (doc) { updatedDocsDC.push(model.deepCopy(doc)); });\n          if (! multi) { updatedDocsDC = updatedDocsDC[0]; }\n          return callback(null, numReplaced, updatedDocsDC);\n        }\n      });\n    });\n  }]);\n};\n\nDatastore.prototype.update = function () {\n  this.executor.push({ this: this, fn: this._update, arguments: arguments });\n};\n\n\n/**\n * Remove all docs matching the query\n * For now very naive implementation (similar to update)\n * @param {Object} query\n * @param {Object} options Optional options\n *                 options.multi If true, can update multiple documents (defaults to false)\n * @param {Function} cb Optional callback, signature: err, numRemoved\n *\n * @api private Use Datastore.remove which has the same signature\n */\nDatastore.prototype._remove = function (query, options, cb) {\n  var callback\n    , self = this, numRemoved = 0, removedDocs = [], multi\n    ;\n\n  if (typeof options === 'function') { cb = options; options = {}; }\n  callback = cb || function () {};\n  multi = options.multi !== undefined ? options.multi : false;\n\n  this.getCandidates(query, true, function (err, candidates) {\n    if (err) { return callback(err); }\n\n    try {\n      candidates.forEach(function (d) {\n        if (model.match(d, query) && (multi || numRemoved === 0)) {\n          numRemoved += 1;\n          removedDocs.push({ $$deleted: true, _id: d._id });\n          self.removeFromIndexes(d);\n        }\n      });\n    } catch (err) { return callback(err); }\n\n    self.persistence.persistNewState(removedDocs, function (err) {\n      if (err) { return callback(err); }\n      return callback(null, numRemoved);\n    });\n  });\n};\n\nDatastore.prototype.remove = function () {\n  this.executor.push({ this: this, fn: this._remove, arguments: arguments });\n};\n\n\n\nmodule.exports = Datastore;\n","//     Underscore.js 1.4.4\n//     http://underscorejs.org\n//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.\n//     Underscore may be freely distributed under the MIT license.\n\n(function() {\n\n  // Baseline setup\n  // --------------\n\n  // Establish the root object, `window` in the browser, or `global` on the server.\n  var root = this;\n\n  // Save the previous value of the `_` variable.\n  var previousUnderscore = root._;\n\n  // Establish the object that gets returned to break out of a loop iteration.\n  var breaker = {};\n\n  // Save bytes in the minified (but not gzipped) version:\n  var ArrayProto = Array.prototype, ObjProto = Object.prototype, FuncProto = Function.prototype;\n\n  // Create quick reference variables for speed access to core prototypes.\n  var push             = ArrayProto.push,\n      slice            = ArrayProto.slice,\n      concat           = ArrayProto.concat,\n      toString         = ObjProto.toString,\n      hasOwnProperty   = ObjProto.hasOwnProperty;\n\n  // All **ECMAScript 5** native function implementations that we hope to use\n  // are declared here.\n  var\n    nativeForEach      = ArrayProto.forEach,\n    nativeMap          = ArrayProto.map,\n    nativeReduce       = ArrayProto.reduce,\n    nativeReduceRight  = ArrayProto.reduceRight,\n    nativeFilter       = ArrayProto.filter,\n    nativeEvery        = ArrayProto.every,\n    nativeSome         = ArrayProto.some,\n    nativeIndexOf      = ArrayProto.indexOf,\n    nativeLastIndexOf  = ArrayProto.lastIndexOf,\n    nativeIsArray      = Array.isArray,\n    nativeKeys         = Object.keys,\n    nativeBind         = FuncProto.bind;\n\n  // Create a safe reference to the Underscore object for use below.\n  var _ = function(obj) {\n    if (obj instanceof _) return obj;\n    if (!(this instanceof _)) return new _(obj);\n    this._wrapped = obj;\n  };\n\n  // Export the Underscore object for **Node.js**, with\n  // backwards-compatibility for the old `require()` API. If we're in\n  // the browser, add `_` as a global object via a string identifier,\n  // for Closure Compiler \"advanced\" mode.\n  if (typeof exports !== 'undefined') {\n    if (typeof module !== 'undefined' && module.exports) {\n      exports = module.exports = _;\n    }\n    exports._ = _;\n  } else {\n    root._ = _;\n  }\n\n  // Current version.\n  _.VERSION = '1.4.4';\n\n  // Collection Functions\n  // --------------------\n\n  // The cornerstone, an `each` implementation, aka `forEach`.\n  // Handles objects with the built-in `forEach`, arrays, and raw objects.\n  // Delegates to **ECMAScript 5**'s native `forEach` if available.\n  var each = _.each = _.forEach = function(obj, iterator, context) {\n    if (obj == null) return;\n    if (nativeForEach && obj.forEach === nativeForEach) {\n      obj.forEach(iterator, context);\n    } else if (obj.length === +obj.length) {\n      for (var i = 0, l = obj.length; i < l; i++) {\n        if (iterator.call(context, obj[i], i, obj) === breaker) return;\n      }\n    } else {\n      for (var key in obj) {\n        if (_.has(obj, key)) {\n          if (iterator.call(context, obj[key], key, obj) === breaker) return;\n        }\n      }\n    }\n  };\n\n  // Return the results of applying the iterator to each element.\n  // Delegates to **ECMAScript 5**'s native `map` if available.\n  _.map = _.collect = function(obj, iterator, context) {\n    var results = [];\n    if (obj == null) return results;\n    if (nativeMap && obj.map === nativeMap) return obj.map(iterator, context);\n    each(obj, function(value, index, list) {\n      results[results.length] = iterator.call(context, value, index, list);\n    });\n    return results;\n  };\n\n  var reduceError = 'Reduce of empty array with no initial value';\n\n  // **Reduce** builds up a single result from a list of values, aka `inject`,\n  // or `foldl`. Delegates to **ECMAScript 5**'s native `reduce` if available.\n  _.reduce = _.foldl = _.inject = function(obj, iterator, memo, context) {\n    var initial = arguments.length > 2;\n    if (obj == null) obj = [];\n    if (nativeReduce && obj.reduce === nativeReduce) {\n      if (context) iterator = _.bind(iterator, context);\n      return initial ? obj.reduce(iterator, memo) : obj.reduce(iterator);\n    }\n    each(obj, function(value, index, list) {\n      if (!initial) {\n        memo = value;\n        initial = true;\n      } else {\n        memo = iterator.call(context, memo, value, index, list);\n      }\n    });\n    if (!initial) throw new TypeError(reduceError);\n    return memo;\n  };\n\n  // The right-associative version of reduce, also known as `foldr`.\n  // Delegates to **ECMAScript 5**'s native `reduceRight` if available.\n  _.reduceRight = _.foldr = function(obj, iterator, memo, context) {\n    var initial = arguments.length > 2;\n    if (obj == null) obj = [];\n    if (nativeReduceRight && obj.reduceRight === nativeReduceRight) {\n      if (context) iterator = _.bind(iterator, context);\n      return initial ? obj.reduceRight(iterator, memo) : obj.reduceRight(iterator);\n    }\n    var length = obj.length;\n    if (length !== +length) {\n      var keys = _.keys(obj);\n      length = keys.length;\n    }\n    each(obj, function(value, index, list) {\n      index = keys ? keys[--length] : --length;\n      if (!initial) {\n        memo = obj[index];\n        initial = true;\n      } else {\n        memo = iterator.call(context, memo, obj[index], index, list);\n      }\n    });\n    if (!initial) throw new TypeError(reduceError);\n    return memo;\n  };\n\n  // Return the first value which passes a truth test. Aliased as `detect`.\n  _.find = _.detect = function(obj, iterator, context) {\n    var result;\n    any(obj, function(value, index, list) {\n      if (iterator.call(context, value, index, list)) {\n        result = value;\n        return true;\n      }\n    });\n    return result;\n  };\n\n  // Return all the elements that pass a truth test.\n  // Delegates to **ECMAScript 5**'s native `filter` if available.\n  // Aliased as `select`.\n  _.filter = _.select = function(obj, iterator, context) {\n    var results = [];\n    if (obj == null) return results;\n    if (nativeFilter && obj.filter === nativeFilter) return obj.filter(iterator, context);\n    each(obj, function(value, index, list) {\n      if (iterator.call(context, value, index, list)) results[results.length] = value;\n    });\n    return results;\n  };\n\n  // Return all the elements for which a truth test fails.\n  _.reject = function(obj, iterator, context) {\n    return _.filter(obj, function(value, index, list) {\n      return !iterator.call(context, value, index, list);\n    }, context);\n  };\n\n  // Determine whether all of the elements match a truth test.\n  // Delegates to **ECMAScript 5**'s native `every` if available.\n  // Aliased as `all`.\n  _.every = _.all = function(obj, iterator, context) {\n    iterator || (iterator = _.identity);\n    var result = true;\n    if (obj == null) return result;\n    if (nativeEvery && obj.every === nativeEvery) return obj.every(iterator, context);\n    each(obj, function(value, index, list) {\n      if (!(result = result && iterator.call(context, value, index, list))) return breaker;\n    });\n    return !!result;\n  };\n\n  // Determine if at least one element in the object matches a truth test.\n  // Delegates to **ECMAScript 5**'s native `some` if available.\n  // Aliased as `any`.\n  var any = _.some = _.any = function(obj, iterator, context) {\n    iterator || (iterator = _.identity);\n    var result = false;\n    if (obj == null) return result;\n    if (nativeSome && obj.some === nativeSome) return obj.some(iterator, context);\n    each(obj, function(value, index, list) {\n      if (result || (result = iterator.call(context, value, index, list))) return breaker;\n    });\n    return !!result;\n  };\n\n  // Determine if the array or object contains a given value (using `===`).\n  // Aliased as `include`.\n  _.contains = _.include = function(obj, target) {\n    if (obj == null) return false;\n    if (nativeIndexOf && obj.indexOf === nativeIndexOf) return obj.indexOf(target) != -1;\n    return any(obj, function(value) {\n      return value === target;\n    });\n  };\n\n  // Invoke a method (with arguments) on every item in a collection.\n  _.invoke = function(obj, method) {\n    var args = slice.call(arguments, 2);\n    var isFunc = _.isFunction(method);\n    return _.map(obj, function(value) {\n      return (isFunc ? method : value[method]).apply(value, args);\n    });\n  };\n\n  // Convenience version of a common use case of `map`: fetching a property.\n  _.pluck = function(obj, key) {\n    return _.map(obj, function(value){ return value[key]; });\n  };\n\n  // Convenience version of a common use case of `filter`: selecting only objects\n  // containing specific `key:value` pairs.\n  _.where = function(obj, attrs, first) {\n    if (_.isEmpty(attrs)) return first ? null : [];\n    return _[first ? 'find' : 'filter'](obj, function(value) {\n      for (var key in attrs) {\n        if (attrs[key] !== value[key]) return false;\n      }\n      return true;\n    });\n  };\n\n  // Convenience version of a common use case of `find`: getting the first object\n  // containing specific `key:value` pairs.\n  _.findWhere = function(obj, attrs) {\n    return _.where(obj, attrs, true);\n  };\n\n  // Return the maximum element or (element-based computation).\n  // Can't optimize arrays of integers longer than 65,535 elements.\n  // See: https://bugs.webkit.org/show_bug.cgi?id=80797\n  _.max = function(obj, iterator, context) {\n    if (!iterator && _.isArray(obj) && obj[0] === +obj[0] && obj.length < 65535) {\n      return Math.max.apply(Math, obj);\n    }\n    if (!iterator && _.isEmpty(obj)) return -Infinity;\n    var result = {computed : -Infinity, value: -Infinity};\n    each(obj, function(value, index, list) {\n      var computed = iterator ? iterator.call(context, value, index, list) : value;\n      computed >= result.computed && (result = {value : value, computed : computed});\n    });\n    return result.value;\n  };\n\n  // Return the minimum element (or element-based computation).\n  _.min = function(obj, iterator, context) {\n    if (!iterator && _.isArray(obj) && obj[0] === +obj[0] && obj.length < 65535) {\n      return Math.min.apply(Math, obj);\n    }\n    if (!iterator && _.isEmpty(obj)) return Infinity;\n    var result = {computed : Infinity, value: Infinity};\n    each(obj, function(value, index, list) {\n      var computed = iterator ? iterator.call(context, value, index, list) : value;\n      computed < result.computed && (result = {value : value, computed : computed});\n    });\n    return result.value;\n  };\n\n  // Shuffle an array.\n  _.shuffle = function(obj) {\n    var rand;\n    var index = 0;\n    var shuffled = [];\n    each(obj, function(value) {\n      rand = _.random(index++);\n      shuffled[index - 1] = shuffled[rand];\n      shuffled[rand] = value;\n    });\n    return shuffled;\n  };\n\n  // An internal function to generate lookup iterators.\n  var lookupIterator = function(value) {\n    return _.isFunction(value) ? value : function(obj){ return obj[value]; };\n  };\n\n  // Sort the object's values by a criterion produced by an iterator.\n  _.sortBy = function(obj, value, context) {\n    var iterator = lookupIterator(value);\n    return _.pluck(_.map(obj, function(value, index, list) {\n      return {\n        value : value,\n        index : index,\n        criteria : iterator.call(context, value, index, list)\n      };\n    }).sort(function(left, right) {\n      var a = left.criteria;\n      var b = right.criteria;\n      if (a !== b) {\n        if (a > b || a === void 0) return 1;\n        if (a < b || b === void 0) return -1;\n      }\n      return left.index < right.index ? -1 : 1;\n    }), 'value');\n  };\n\n  // An internal function used for aggregate \"group by\" operations.\n  var group = function(obj, value, context, behavior) {\n    var result = {};\n    var iterator = lookupIterator(value || _.identity);\n    each(obj, function(value, index) {\n      var key = iterator.call(context, value, index, obj);\n      behavior(result, key, value);\n    });\n    return result;\n  };\n\n  // Groups the object's values by a criterion. Pass either a string attribute\n  // to group by, or a function that returns the criterion.\n  _.groupBy = function(obj, value, context) {\n    return group(obj, value, context, function(result, key, value) {\n      (_.has(result, key) ? result[key] : (result[key] = [])).push(value);\n    });\n  };\n\n  // Counts instances of an object that group by a certain criterion. Pass\n  // either a string attribute to count by, or a function that returns the\n  // criterion.\n  _.countBy = function(obj, value, context) {\n    return group(obj, value, context, function(result, key) {\n      if (!_.has(result, key)) result[key] = 0;\n      result[key]++;\n    });\n  };\n\n  // Use a comparator function to figure out the smallest index at which\n  // an object should be inserted so as to maintain order. Uses binary search.\n  _.sortedIndex = function(array, obj, iterator, context) {\n    iterator = iterator == null ? _.identity : lookupIterator(iterator);\n    var value = iterator.call(context, obj);\n    var low = 0, high = array.length;\n    while (low < high) {\n      var mid = (low + high) >>> 1;\n      iterator.call(context, array[mid]) < value ? low = mid + 1 : high = mid;\n    }\n    return low;\n  };\n\n  // Safely convert anything iterable into a real, live array.\n  _.toArray = function(obj) {\n    if (!obj) return [];\n    if (_.isArray(obj)) return slice.call(obj);\n    if (obj.length === +obj.length) return _.map(obj, _.identity);\n    return _.values(obj);\n  };\n\n  // Return the number of elements in an object.\n  _.size = function(obj) {\n    if (obj == null) return 0;\n    return (obj.length === +obj.length) ? obj.length : _.keys(obj).length;\n  };\n\n  // Array Functions\n  // ---------------\n\n  // Get the first element of an array. Passing **n** will return the first N\n  // values in the array. Aliased as `head` and `take`. The **guard** check\n  // allows it to work with `_.map`.\n  _.first = _.head = _.take = function(array, n, guard) {\n    if (array == null) return void 0;\n    return (n != null) && !guard ? slice.call(array, 0, n) : array[0];\n  };\n\n  // Returns everything but the last entry of the array. Especially useful on\n  // the arguments object. Passing **n** will return all the values in\n  // the array, excluding the last N. The **guard** check allows it to work with\n  // `_.map`.\n  _.initial = function(array, n, guard) {\n    return slice.call(array, 0, array.length - ((n == null) || guard ? 1 : n));\n  };\n\n  // Get the last element of an array. Passing **n** will return the last N\n  // values in the array. The **guard** check allows it to work with `_.map`.\n  _.last = function(array, n, guard) {\n    if (array == null) return void 0;\n    if ((n != null) && !guard) {\n      return slice.call(array, Math.max(array.length - n, 0));\n    } else {\n      return array[array.length - 1];\n    }\n  };\n\n  // Returns everything but the first entry of the array. Aliased as `tail` and `drop`.\n  // Especially useful on the arguments object. Passing an **n** will return\n  // the rest N values in the array. The **guard**\n  // check allows it to work with `_.map`.\n  _.rest = _.tail = _.drop = function(array, n, guard) {\n    return slice.call(array, (n == null) || guard ? 1 : n);\n  };\n\n  // Trim out all falsy values from an array.\n  _.compact = function(array) {\n    return _.filter(array, _.identity);\n  };\n\n  // Internal implementation of a recursive `flatten` function.\n  var flatten = function(input, shallow, output) {\n    each(input, function(value) {\n      if (_.isArray(value)) {\n        shallow ? push.apply(output, value) : flatten(value, shallow, output);\n      } else {\n        output.push(value);\n      }\n    });\n    return output;\n  };\n\n  // Return a completely flattened version of an array.\n  _.flatten = function(array, shallow) {\n    return flatten(array, shallow, []);\n  };\n\n  // Return a version of the array that does not contain the specified value(s).\n  _.without = function(array) {\n    return _.difference(array, slice.call(arguments, 1));\n  };\n\n  // Produce a duplicate-free version of the array. If the array has already\n  // been sorted, you have the option of using a faster algorithm.\n  // Aliased as `unique`.\n  _.uniq = _.unique = function(array, isSorted, iterator, context) {\n    if (_.isFunction(isSorted)) {\n      context = iterator;\n      iterator = isSorted;\n      isSorted = false;\n    }\n    var initial = iterator ? _.map(array, iterator, context) : array;\n    var results = [];\n    var seen = [];\n    each(initial, function(value, index) {\n      if (isSorted ? (!index || seen[seen.length - 1] !== value) : !_.contains(seen, value)) {\n        seen.push(value);\n        results.push(array[index]);\n      }\n    });\n    return results;\n  };\n\n  // Produce an array that contains the union: each distinct element from all of\n  // the passed-in arrays.\n  _.union = function() {\n    return _.uniq(concat.apply(ArrayProto, arguments));\n  };\n\n  // Produce an array that contains every item shared between all the\n  // passed-in arrays.\n  _.intersection = function(array) {\n    var rest = slice.call(arguments, 1);\n    return _.filter(_.uniq(array), function(item) {\n      return _.every(rest, function(other) {\n        return _.indexOf(other, item) >= 0;\n      });\n    });\n  };\n\n  // Take the difference between one array and a number of other arrays.\n  // Only the elements present in just the first array will remain.\n  _.difference = function(array) {\n    var rest = concat.apply(ArrayProto, slice.call(arguments, 1));\n    return _.filter(array, function(value){ return !_.contains(rest, value); });\n  };\n\n  // Zip together multiple lists into a single array -- elements that share\n  // an index go together.\n  _.zip = function() {\n    var args = slice.call(arguments);\n    var length = _.max(_.pluck(args, 'length'));\n    var results = new Array(length);\n    for (var i = 0; i < length; i++) {\n      results[i] = _.pluck(args, \"\" + i);\n    }\n    return results;\n  };\n\n  // Converts lists into objects. Pass either a single array of `[key, value]`\n  // pairs, or two parallel arrays of the same length -- one of keys, and one of\n  // the corresponding values.\n  _.object = function(list, values) {\n    if (list == null) return {};\n    var result = {};\n    for (var i = 0, l = list.length; i < l; i++) {\n      if (values) {\n        result[list[i]] = values[i];\n      } else {\n        result[list[i][0]] = list[i][1];\n      }\n    }\n    return result;\n  };\n\n  // If the browser doesn't supply us with indexOf (I'm looking at you, **MSIE**),\n  // we need this function. Return the position of the first occurrence of an\n  // item in an array, or -1 if the item is not included in the array.\n  // Delegates to **ECMAScript 5**'s native `indexOf` if available.\n  // If the array is large and already in sort order, pass `true`\n  // for **isSorted** to use binary search.\n  _.indexOf = function(array, item, isSorted) {\n    if (array == null) return -1;\n    var i = 0, l = array.length;\n    if (isSorted) {\n      if (typeof isSorted == 'number') {\n        i = (isSorted < 0 ? Math.max(0, l + isSorted) : isSorted);\n      } else {\n        i = _.sortedIndex(array, item);\n        return array[i] === item ? i : -1;\n      }\n    }\n    if (nativeIndexOf && array.indexOf === nativeIndexOf) return array.indexOf(item, isSorted);\n    for (; i < l; i++) if (array[i] === item) return i;\n    return -1;\n  };\n\n  // Delegates to **ECMAScript 5**'s native `lastIndexOf` if available.\n  _.lastIndexOf = function(array, item, from) {\n    if (array == null) return -1;\n    var hasIndex = from != null;\n    if (nativeLastIndexOf && array.lastIndexOf === nativeLastIndexOf) {\n      return hasIndex ? array.lastIndexOf(item, from) : array.lastIndexOf(item);\n    }\n    var i = (hasIndex ? from : array.length);\n    while (i--) if (array[i] === item) return i;\n    return -1;\n  };\n\n  // Generate an integer Array containing an arithmetic progression. A port of\n  // the native Python `range()` function. See\n  // [the Python documentation](http://docs.python.org/library/functions.html#range).\n  _.range = function(start, stop, step) {\n    if (arguments.length <= 1) {\n      stop = start || 0;\n      start = 0;\n    }\n    step = arguments[2] || 1;\n\n    var len = Math.max(Math.ceil((stop - start) / step), 0);\n    var idx = 0;\n    var range = new Array(len);\n\n    while(idx < len) {\n      range[idx++] = start;\n      start += step;\n    }\n\n    return range;\n  };\n\n  // Function (ahem) Functions\n  // ------------------\n\n  // Create a function bound to a given object (assigning `this`, and arguments,\n  // optionally). Delegates to **ECMAScript 5**'s native `Function.bind` if\n  // available.\n  _.bind = function(func, context) {\n    if (func.bind === nativeBind && nativeBind) return nativeBind.apply(func, slice.call(arguments, 1));\n    var args = slice.call(arguments, 2);\n    return function() {\n      return func.apply(context, args.concat(slice.call(arguments)));\n    };\n  };\n\n  // Partially apply a function by creating a version that has had some of its\n  // arguments pre-filled, without changing its dynamic `this` context.\n  _.partial = function(func) {\n    var args = slice.call(arguments, 1);\n    return function() {\n      return func.apply(this, args.concat(slice.call(arguments)));\n    };\n  };\n\n  // Bind all of an object's methods to that object. Useful for ensuring that\n  // all callbacks defined on an object belong to it.\n  _.bindAll = function(obj) {\n    var funcs = slice.call(arguments, 1);\n    if (funcs.length === 0) funcs = _.functions(obj);\n    each(funcs, function(f) { obj[f] = _.bind(obj[f], obj); });\n    return obj;\n  };\n\n  // Memoize an expensive function by storing its results.\n  _.memoize = function(func, hasher) {\n    var memo = {};\n    hasher || (hasher = _.identity);\n    return function() {\n      var key = hasher.apply(this, arguments);\n      return _.has(memo, key) ? memo[key] : (memo[key] = func.apply(this, arguments));\n    };\n  };\n\n  // Delays a function for the given number of milliseconds, and then calls\n  // it with the arguments supplied.\n  _.delay = function(func, wait) {\n    var args = slice.call(arguments, 2);\n    return setTimeout(function(){ return func.apply(null, args); }, wait);\n  };\n\n  // Defers a function, scheduling it to run after the current call stack has\n  // cleared.\n  _.defer = function(func) {\n    return _.delay.apply(_, [func, 1].concat(slice.call(arguments, 1)));\n  };\n\n  // Returns a function, that, when invoked, will only be triggered at most once\n  // during a given window of time.\n  _.throttle = function(func, wait) {\n    var context, args, timeout, result;\n    var previous = 0;\n    var later = function() {\n      previous = new Date;\n      timeout = null;\n      result = func.apply(context, args);\n    };\n    return function() {\n      var now = new Date;\n      var remaining = wait - (now - previous);\n      context = this;\n      args = arguments;\n      if (remaining <= 0) {\n        clearTimeout(timeout);\n        timeout = null;\n        previous = now;\n        result = func.apply(context, args);\n      } else if (!timeout) {\n        timeout = setTimeout(later, remaining);\n      }\n      return result;\n    };\n  };\n\n  // Returns a function, that, as long as it continues to be invoked, will not\n  // be triggered. The function will be called after it stops being called for\n  // N milliseconds. If `immediate` is passed, trigger the function on the\n  // leading edge, instead of the trailing.\n  _.debounce = function(func, wait, immediate) {\n    var timeout, result;\n    return function() {\n      var context = this, args = arguments;\n      var later = function() {\n        timeout = null;\n        if (!immediate) result = func.apply(context, args);\n      };\n      var callNow = immediate && !timeout;\n      clearTimeout(timeout);\n      timeout = setTimeout(later, wait);\n      if (callNow) result = func.apply(context, args);\n      return result;\n    };\n  };\n\n  // Returns a function that will be executed at most one time, no matter how\n  // often you call it. Useful for lazy initialization.\n  _.once = function(func) {\n    var ran = false, memo;\n    return function() {\n      if (ran) return memo;\n      ran = true;\n      memo = func.apply(this, arguments);\n      func = null;\n      return memo;\n    };\n  };\n\n  // Returns the first function passed as an argument to the second,\n  // allowing you to adjust arguments, run code before and after, and\n  // conditionally execute the original function.\n  _.wrap = function(func, wrapper) {\n    return function() {\n      var args = [func];\n      push.apply(args, arguments);\n      return wrapper.apply(this, args);\n    };\n  };\n\n  // Returns a function that is the composition of a list of functions, each\n  // consuming the return value of the function that follows.\n  _.compose = function() {\n    var funcs = arguments;\n    return function() {\n      var args = arguments;\n      for (var i = funcs.length - 1; i >= 0; i--) {\n        args = [funcs[i].apply(this, args)];\n      }\n      return args[0];\n    };\n  };\n\n  // Returns a function that will only be executed after being called N times.\n  _.after = function(times, func) {\n    if (times <= 0) return func();\n    return function() {\n      if (--times < 1) {\n        return func.apply(this, arguments);\n      }\n    };\n  };\n\n  // Object Functions\n  // ----------------\n\n  // Retrieve the names of an object's properties.\n  // Delegates to **ECMAScript 5**'s native `Object.keys`\n  _.keys = nativeKeys || function(obj) {\n    if (obj !== Object(obj)) throw new TypeError('Invalid object');\n    var keys = [];\n    for (var key in obj) if (_.has(obj, key)) keys[keys.length] = key;\n    return keys;\n  };\n\n  // Retrieve the values of an object's properties.\n  _.values = function(obj) {\n    var values = [];\n    for (var key in obj) if (_.has(obj, key)) values.push(obj[key]);\n    return values;\n  };\n\n  // Convert an object into a list of `[key, value]` pairs.\n  _.pairs = function(obj) {\n    var pairs = [];\n    for (var key in obj) if (_.has(obj, key)) pairs.push([key, obj[key]]);\n    return pairs;\n  };\n\n  // Invert the keys and values of an object. The values must be serializable.\n  _.invert = function(obj) {\n    var result = {};\n    for (var key in obj) if (_.has(obj, key)) result[obj[key]] = key;\n    return result;\n  };\n\n  // Return a sorted list of the function names available on the object.\n  // Aliased as `methods`\n  _.functions = _.methods = function(obj) {\n    var names = [];\n    for (var key in obj) {\n      if (_.isFunction(obj[key])) names.push(key);\n    }\n    return names.sort();\n  };\n\n  // Extend a given object with all the properties in passed-in object(s).\n  _.extend = function(obj) {\n    each(slice.call(arguments, 1), function(source) {\n      if (source) {\n        for (var prop in source) {\n          obj[prop] = source[prop];\n        }\n      }\n    });\n    return obj;\n  };\n\n  // Return a copy of the object only containing the whitelisted properties.\n  _.pick = function(obj) {\n    var copy = {};\n    var keys = concat.apply(ArrayProto, slice.call(arguments, 1));\n    each(keys, function(key) {\n      if (key in obj) copy[key] = obj[key];\n    });\n    return copy;\n  };\n\n   // Return a copy of the object without the blacklisted properties.\n  _.omit = function(obj) {\n    var copy = {};\n    var keys = concat.apply(ArrayProto, slice.call(arguments, 1));\n    for (var key in obj) {\n      if (!_.contains(keys, key)) copy[key] = obj[key];\n    }\n    return copy;\n  };\n\n  // Fill in a given object with default properties.\n  _.defaults = function(obj) {\n    each(slice.call(arguments, 1), function(source) {\n      if (source) {\n        for (var prop in source) {\n          if (obj[prop] == null) obj[prop] = source[prop];\n        }\n      }\n    });\n    return obj;\n  };\n\n  // Create a (shallow-cloned) duplicate of an object.\n  _.clone = function(obj) {\n    if (!_.isObject(obj)) return obj;\n    return _.isArray(obj) ? obj.slice() : _.extend({}, obj);\n  };\n\n  // Invokes interceptor with the obj, and then returns obj.\n  // The primary purpose of this method is to \"tap into\" a method chain, in\n  // order to perform operations on intermediate results within the chain.\n  _.tap = function(obj, interceptor) {\n    interceptor(obj);\n    return obj;\n  };\n\n  // Internal recursive comparison function for `isEqual`.\n  var eq = function(a, b, aStack, bStack) {\n    // Identical objects are equal. `0 === -0`, but they aren't identical.\n    // See the Harmony `egal` proposal: http://wiki.ecmascript.org/doku.php?id=harmony:egal.\n    if (a === b) return a !== 0 || 1 / a == 1 / b;\n    // A strict comparison is necessary because `null == undefined`.\n    if (a == null || b == null) return a === b;\n    // Unwrap any wrapped objects.\n    if (a instanceof _) a = a._wrapped;\n    if (b instanceof _) b = b._wrapped;\n    // Compare `[[Class]]` names.\n    var className = toString.call(a);\n    if (className != toString.call(b)) return false;\n    switch (className) {\n      // Strings, numbers, dates, and booleans are compared by value.\n      case '[object String]':\n        // Primitives and their corresponding object wrappers are equivalent; thus, `\"5\"` is\n        // equivalent to `new String(\"5\")`.\n        return a == String(b);\n      case '[object Number]':\n        // `NaN`s are equivalent, but non-reflexive. An `egal` comparison is performed for\n        // other numeric values.\n        return a != +a ? b != +b : (a == 0 ? 1 / a == 1 / b : a == +b);\n      case '[object Date]':\n      case '[object Boolean]':\n        // Coerce dates and booleans to numeric primitive values. Dates are compared by their\n        // millisecond representations. Note that invalid dates with millisecond representations\n        // of `NaN` are not equivalent.\n        return +a == +b;\n      // RegExps are compared by their source patterns and flags.\n      case '[object RegExp]':\n        return a.source == b.source &&\n               a.global == b.global &&\n               a.multiline == b.multiline &&\n               a.ignoreCase == b.ignoreCase;\n    }\n    if (typeof a != 'object' || typeof b != 'object') return false;\n    // Assume equality for cyclic structures. The algorithm for detecting cyclic\n    // structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.\n    var length = aStack.length;\n    while (length--) {\n      // Linear search. Performance is inversely proportional to the number of\n      // unique nested structures.\n      if (aStack[length] == a) return bStack[length] == b;\n    }\n    // Add the first object to the stack of traversed objects.\n    aStack.push(a);\n    bStack.push(b);\n    var size = 0, result = true;\n    // Recursively compare objects and arrays.\n    if (className == '[object Array]') {\n      // Compare array lengths to determine if a deep comparison is necessary.\n      size = a.length;\n      result = size == b.length;\n      if (result) {\n        // Deep compare the contents, ignoring non-numeric properties.\n        while (size--) {\n          if (!(result = eq(a[size], b[size], aStack, bStack))) break;\n        }\n      }\n    } else {\n      // Objects with different constructors are not equivalent, but `Object`s\n      // from different frames are.\n      var aCtor = a.constructor, bCtor = b.constructor;\n      if (aCtor !== bCtor && !(_.isFunction(aCtor) && (aCtor instanceof aCtor) &&\n                               _.isFunction(bCtor) && (bCtor instanceof bCtor))) {\n        return false;\n      }\n      // Deep compare objects.\n      for (var key in a) {\n        if (_.has(a, key)) {\n          // Count the expected number of properties.\n          size++;\n          // Deep compare each member.\n          if (!(result = _.has(b, key) && eq(a[key], b[key], aStack, bStack))) break;\n        }\n      }\n      // Ensure that both objects contain the same number of properties.\n      if (result) {\n        for (key in b) {\n          if (_.has(b, key) && !(size--)) break;\n        }\n        result = !size;\n      }\n    }\n    // Remove the first object from the stack of traversed objects.\n    aStack.pop();\n    bStack.pop();\n    return result;\n  };\n\n  // Perform a deep comparison to check if two objects are equal.\n  _.isEqual = function(a, b) {\n    return eq(a, b, [], []);\n  };\n\n  // Is a given array, string, or object empty?\n  // An \"empty\" object has no enumerable own-properties.\n  _.isEmpty = function(obj) {\n    if (obj == null) return true;\n    if (_.isArray(obj) || _.isString(obj)) return obj.length === 0;\n    for (var key in obj) if (_.has(obj, key)) return false;\n    return true;\n  };\n\n  // Is a given value a DOM element?\n  _.isElement = function(obj) {\n    return !!(obj && obj.nodeType === 1);\n  };\n\n  // Is a given value an array?\n  // Delegates to ECMA5's native Array.isArray\n  _.isArray = nativeIsArray || function(obj) {\n    return toString.call(obj) == '[object Array]';\n  };\n\n  // Is a given variable an object?\n  _.isObject = function(obj) {\n    return obj === Object(obj);\n  };\n\n  // Add some isType methods: isArguments, isFunction, isString, isNumber, isDate, isRegExp.\n  each(['Arguments', 'Function', 'String', 'Number', 'Date', 'RegExp'], function(name) {\n    _['is' + name] = function(obj) {\n      return toString.call(obj) == '[object ' + name + ']';\n    };\n  });\n\n  // Define a fallback version of the method in browsers (ahem, IE), where\n  // there isn't any inspectable \"Arguments\" type.\n  if (!_.isArguments(arguments)) {\n    _.isArguments = function(obj) {\n      return !!(obj && _.has(obj, 'callee'));\n    };\n  }\n\n  // Optimize `isFunction` if appropriate.\n  if (typeof (/./) !== 'function') {\n    _.isFunction = function(obj) {\n      return typeof obj === 'function';\n    };\n  }\n\n  // Is a given object a finite number?\n  _.isFinite = function(obj) {\n    return isFinite(obj) && !isNaN(parseFloat(obj));\n  };\n\n  // Is the given value `NaN`? (NaN is the only number which does not equal itself).\n  _.isNaN = function(obj) {\n    return _.isNumber(obj) && obj != +obj;\n  };\n\n  // Is a given value a boolean?\n  _.isBoolean = function(obj) {\n    return obj === true || obj === false || toString.call(obj) == '[object Boolean]';\n  };\n\n  // Is a given value equal to null?\n  _.isNull = function(obj) {\n    return obj === null;\n  };\n\n  // Is a given variable undefined?\n  _.isUndefined = function(obj) {\n    return obj === void 0;\n  };\n\n  // Shortcut function for checking if an object has a given property directly\n  // on itself (in other words, not on a prototype).\n  _.has = function(obj, key) {\n    return hasOwnProperty.call(obj, key);\n  };\n\n  // Utility Functions\n  // -----------------\n\n  // Run Underscore.js in *noConflict* mode, returning the `_` variable to its\n  // previous owner. Returns a reference to the Underscore object.\n  _.noConflict = function() {\n    root._ = previousUnderscore;\n    return this;\n  };\n\n  // Keep the identity function around for default iterators.\n  _.identity = function(value) {\n    return value;\n  };\n\n  // Run a function **n** times.\n  _.times = function(n, iterator, context) {\n    var accum = Array(n);\n    for (var i = 0; i < n; i++) accum[i] = iterator.call(context, i);\n    return accum;\n  };\n\n  // Return a random integer between min and max (inclusive).\n  _.random = function(min, max) {\n    if (max == null) {\n      max = min;\n      min = 0;\n    }\n    return min + Math.floor(Math.random() * (max - min + 1));\n  };\n\n  // List of HTML entities for escaping.\n  var entityMap = {\n    escape: {\n      '&': '&amp;',\n      '<': '&lt;',\n      '>': '&gt;',\n      '\"': '&quot;',\n      \"'\": '&#x27;',\n      '/': '&#x2F;'\n    }\n  };\n  entityMap.unescape = _.invert(entityMap.escape);\n\n  // Regexes containing the keys and values listed immediately above.\n  var entityRegexes = {\n    escape:   new RegExp('[' + _.keys(entityMap.escape).join('') + ']', 'g'),\n    unescape: new RegExp('(' + _.keys(entityMap.unescape).join('|') + ')', 'g')\n  };\n\n  // Functions for escaping and unescaping strings to/from HTML interpolation.\n  _.each(['escape', 'unescape'], function(method) {\n    _[method] = function(string) {\n      if (string == null) return '';\n      return ('' + string).replace(entityRegexes[method], function(match) {\n        return entityMap[method][match];\n      });\n    };\n  });\n\n  // If the value of the named property is a function then invoke it;\n  // otherwise, return it.\n  _.result = function(object, property) {\n    if (object == null) return null;\n    var value = object[property];\n    return _.isFunction(value) ? value.call(object) : value;\n  };\n\n  // Add your own custom functions to the Underscore object.\n  _.mixin = function(obj) {\n    each(_.functions(obj), function(name){\n      var func = _[name] = obj[name];\n      _.prototype[name] = function() {\n        var args = [this._wrapped];\n        push.apply(args, arguments);\n        return result.call(this, func.apply(_, args));\n      };\n    });\n  };\n\n  // Generate a unique integer id (unique within the entire client session).\n  // Useful for temporary DOM ids.\n  var idCounter = 0;\n  _.uniqueId = function(prefix) {\n    var id = ++idCounter + '';\n    return prefix ? prefix + id : id;\n  };\n\n  // By default, Underscore uses ERB-style template delimiters, change the\n  // following template settings to use alternative delimiters.\n  _.templateSettings = {\n    evaluate    : /<%([\\s\\S]+?)%>/g,\n    interpolate : /<%=([\\s\\S]+?)%>/g,\n    escape      : /<%-([\\s\\S]+?)%>/g\n  };\n\n  // When customizing `templateSettings`, if you don't want to define an\n  // interpolation, evaluation or escaping regex, we need one that is\n  // guaranteed not to match.\n  var noMatch = /(.)^/;\n\n  // Certain characters need to be escaped so that they can be put into a\n  // string literal.\n  var escapes = {\n    \"'\":      \"'\",\n    '\\\\':     '\\\\',\n    '\\r':     'r',\n    '\\n':     'n',\n    '\\t':     't',\n    '\\u2028': 'u2028',\n    '\\u2029': 'u2029'\n  };\n\n  var escaper = /\\\\|'|\\r|\\n|\\t|\\u2028|\\u2029/g;\n\n  // JavaScript micro-templating, similar to John Resig's implementation.\n  // Underscore templating handles arbitrary delimiters, preserves whitespace,\n  // and correctly escapes quotes within interpolated code.\n  _.template = function(text, data, settings) {\n    var render;\n    settings = _.defaults({}, settings, _.templateSettings);\n\n    // Combine delimiters into one regular expression via alternation.\n    var matcher = new RegExp([\n      (settings.escape || noMatch).source,\n      (settings.interpolate || noMatch).source,\n      (settings.evaluate || noMatch).source\n    ].join('|') + '|$', 'g');\n\n    // Compile the template source, escaping string literals appropriately.\n    var index = 0;\n    var source = \"__p+='\";\n    text.replace(matcher, function(match, escape, interpolate, evaluate, offset) {\n      source += text.slice(index, offset)\n        .replace(escaper, function(match) { return '\\\\' + escapes[match]; });\n\n      if (escape) {\n        source += \"'+\\n((__t=(\" + escape + \"))==null?'':_.escape(__t))+\\n'\";\n      }\n      if (interpolate) {\n        source += \"'+\\n((__t=(\" + interpolate + \"))==null?'':__t)+\\n'\";\n      }\n      if (evaluate) {\n        source += \"';\\n\" + evaluate + \"\\n__p+='\";\n      }\n      index = offset + match.length;\n      return match;\n    });\n    source += \"';\\n\";\n\n    // If a variable is not specified, place data values in local scope.\n    if (!settings.variable) source = 'with(obj||{}){\\n' + source + '}\\n';\n\n    source = \"var __t,__p='',__j=Array.prototype.join,\" +\n      \"print=function(){__p+=__j.call(arguments,'');};\\n\" +\n      source + \"return __p;\\n\";\n\n    try {\n      render = new Function(settings.variable || 'obj', '_', source);\n    } catch (e) {\n      e.source = source;\n      throw e;\n    }\n\n    if (data) return render(data, _);\n    var template = function(data) {\n      return render.call(this, data, _);\n    };\n\n    // Provide the compiled function source as a convenience for precompilation.\n    template.source = 'function(' + (settings.variable || 'obj') + '){\\n' + source + '}';\n\n    return template;\n  };\n\n  // Add a \"chain\" function, which will delegate to the wrapper.\n  _.chain = function(obj) {\n    return _(obj).chain();\n  };\n\n  // OOP\n  // ---------------\n  // If Underscore is called as a function, it returns a wrapped object that\n  // can be used OO-style. This wrapper holds altered versions of all the\n  // underscore functions. Wrapped objects may be chained.\n\n  // Helper function to continue chaining intermediate results.\n  var result = function(obj) {\n    return this._chain ? _(obj).chain() : obj;\n  };\n\n  // Add all of the Underscore functions to the wrapper object.\n  _.mixin(_);\n\n  // Add all mutator Array functions to the wrapper.\n  each(['pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift'], function(name) {\n    var method = ArrayProto[name];\n    _.prototype[name] = function() {\n      var obj = this._wrapped;\n      method.apply(obj, arguments);\n      if ((name == 'shift' || name == 'splice') && obj.length === 0) delete obj[0];\n      return result.call(this, obj);\n    };\n  });\n\n  // Add all accessor Array functions to the wrapper.\n  each(['concat', 'join', 'slice'], function(name) {\n    var method = ArrayProto[name];\n    _.prototype[name] = function() {\n      return result.call(this, method.apply(this._wrapped, arguments));\n    };\n  });\n\n  _.extend(_.prototype, {\n\n    // Start chaining a wrapped Underscore object.\n    chain: function() {\n      this._chain = true;\n      return this;\n    },\n\n    // Extracts the result from a wrapped and chained object.\n    value: function() {\n      return this._wrapped;\n    }\n\n  });\n\n}).call(this);\n","/**\n * Handle models (i.e. docs)\n * Serialization/deserialization\n * Copying\n * Querying, update\n */\n\nvar util = require('util')\n  , _ = require('underscore')\n  , modifierFunctions = {}\n  , lastStepModifierFunctions = {}\n  , comparisonFunctions = {}\n  , logicalOperators = {}\n  , arrayComparisonFunctions = {}\n  ;\n\n\n/**\n * Check a key, throw an error if the key is non valid\n * @param {String} k key\n * @param {Model} v value, needed to treat the Date edge case\n * Non-treatable edge cases here: if part of the object if of the form { $$date: number } or { $$deleted: true }\n * Its serialized-then-deserialized version it will transformed into a Date object\n * But you really need to want it to trigger such behaviour, even when warned not to use '$' at the beginning of the field names...\n */\nfunction checkKey (k, v) {\n  if (typeof k === 'number') {\n    k = k.toString();\n  }\n\n  if (k[0] === '$' && !(k === '$$date' && typeof v === 'number') && !(k === '$$deleted' && v === true) && !(k === '$$indexCreated') && !(k === '$$indexRemoved')) {\n    throw new Error('Field names cannot begin with the $ character');\n  }\n\n  if (k.indexOf('.') !== -1) {\n    throw new Error('Field names cannot contain a .');\n  }\n}\n\n\n/**\n * Check a DB object and throw an error if it's not valid\n * Works by applying the above checkKey function to all fields recursively\n */\nfunction checkObject (obj) {\n  if (util.isArray(obj)) {\n    obj.forEach(function (o) {\n      checkObject(o);\n    });\n  }\n\n  if (typeof obj === 'object' && obj !== null) {\n    Object.keys(obj).forEach(function (k) {\n      checkKey(k, obj[k]);\n      checkObject(obj[k]);\n    });\n  }\n}\n\n\n/**\n * Serialize an object to be persisted to a one-line string\n * For serialization/deserialization, we use the native JSON parser and not eval or Function\n * That gives us less freedom but data entered in the database may come from users\n * so eval and the like are not safe\n * Accepted primitive types: Number, String, Boolean, Date, null\n * Accepted secondary types: Objects, Arrays\n */\nfunction serialize (obj) {\n  var res;\n\n  res = JSON.stringify(obj, function (k, v) {\n    checkKey(k, v);\n\n    if (v === undefined) { return undefined; }\n    if (v === null) { return null; }\n\n    // Hackish way of checking if object is Date (this way it works between execution contexts in node-webkit).\n    // We can't use value directly because for dates it is already string in this function (date.toJSON was already called), so we use this\n    if (typeof this[k].getTime === 'function') { return { $$date: this[k].getTime() }; }\n\n    return v;\n  });\n\n  return res;\n}\n\n\n/**\n * From a one-line representation of an object generate by the serialize function\n * Return the object itself\n */\nfunction deserialize (rawData) {\n  return JSON.parse(rawData, function (k, v) {\n    if (k === '$$date') { return new Date(v); }\n    if (typeof v === 'string' || typeof v === 'number' || typeof v === 'boolean' || v === null) { return v; }\n    if (v && v.$$date) { return v.$$date; }\n\n    return v;\n  });\n}\n\n\n/**\n * Deep copy a DB object\n * The optional strictKeys flag (defaulting to false) indicates whether to copy everything or only fields\n * where the keys are valid, i.e. don't begin with $ and don't contain a .\n */\nfunction deepCopy (obj, strictKeys) {\n  var res;\n\n  if ( typeof obj === 'boolean' ||\n       typeof obj === 'number' ||\n       typeof obj === 'string' ||\n       obj === null ||\n       (util.isDate(obj)) ) {\n    return obj;\n  }\n\n  if (util.isArray(obj)) {\n    res = [];\n    obj.forEach(function (o) { res.push(deepCopy(o, strictKeys)); });\n    return res;\n  }\n\n  if (typeof obj === 'object') {\n    res = {};\n    Object.keys(obj).forEach(function (k) {\n      if (!strictKeys || (k[0] !== '$' && k.indexOf('.') === -1)) {\n        res[k] = deepCopy(obj[k], strictKeys);\n      }\n    });\n    return res;\n  }\n\n  return undefined;   // For now everything else is undefined. We should probably throw an error instead\n}\n\n\n/**\n * Tells if an object is a primitive type or a \"real\" object\n * Arrays are considered primitive\n */\nfunction isPrimitiveType (obj) {\n  return ( typeof obj === 'boolean' ||\n       typeof obj === 'number' ||\n       typeof obj === 'string' ||\n       obj === null ||\n       util.isDate(obj) ||\n       util.isArray(obj));\n}\n\n\n/**\n * Utility functions for comparing things\n * Assumes type checking was already done (a and b already have the same type)\n * compareNSB works for numbers, strings and booleans\n */\nfunction compareNSB (a, b) {\n  if (a < b) { return -1; }\n  if (a > b) { return 1; }\n  return 0;\n}\n\nfunction compareArrays (a, b) {\n  var i, comp;\n\n  for (i = 0; i < Math.min(a.length, b.length); i += 1) {\n    comp = compareThings(a[i], b[i]);\n\n    if (comp !== 0) { return comp; }\n  }\n\n  // Common section was identical, longest one wins\n  return compareNSB(a.length, b.length);\n}\n\n\n/**\n * Compare { things U undefined }\n * Things are defined as any native types (string, number, boolean, null, date) and objects\n * We need to compare with undefined as it will be used in indexes\n * In the case of objects and arrays, we deep-compare\n * If two objects dont have the same type, the (arbitrary) type hierarchy is: undefined, null, number, strings, boolean, dates, arrays, objects\n * Return -1 if a < b, 1 if a > b and 0 if a = b (note that equality here is NOT the same as defined in areThingsEqual!)\n *\n * @param {Function} _compareStrings String comparing function, returning -1, 0 or 1, overriding default string comparison (useful for languages with accented letters)\n */\nfunction compareThings (a, b, _compareStrings) {\n  var aKeys, bKeys, comp, i\n    , compareStrings = _compareStrings || compareNSB;\n\n  // undefined\n  if (a === undefined) { return b === undefined ? 0 : -1; }\n  if (b === undefined) { return a === undefined ? 0 : 1; }\n\n  // null\n  if (a === null) { return b === null ? 0 : -1; }\n  if (b === null) { return a === null ? 0 : 1; }\n\n  // Numbers\n  if (typeof a === 'number') { return typeof b === 'number' ? compareNSB(a, b) : -1; }\n  if (typeof b === 'number') { return typeof a === 'number' ? compareNSB(a, b) : 1; }\n\n  // Strings\n  if (typeof a === 'string') { return typeof b === 'string' ? compareStrings(a, b) : -1; }\n  if (typeof b === 'string') { return typeof a === 'string' ? compareStrings(a, b) : 1; }\n\n  // Booleans\n  if (typeof a === 'boolean') { return typeof b === 'boolean' ? compareNSB(a, b) : -1; }\n  if (typeof b === 'boolean') { return typeof a === 'boolean' ? compareNSB(a, b) : 1; }\n\n  // Dates\n  if (util.isDate(a)) { return util.isDate(b) ? compareNSB(a.getTime(), b.getTime()) : -1; }\n  if (util.isDate(b)) { return util.isDate(a) ? compareNSB(a.getTime(), b.getTime()) : 1; }\n\n  // Arrays (first element is most significant and so on)\n  if (util.isArray(a)) { return util.isArray(b) ? compareArrays(a, b) : -1; }\n  if (util.isArray(b)) { return util.isArray(a) ? compareArrays(a, b) : 1; }\n\n  // Objects\n  aKeys = Object.keys(a).sort();\n  bKeys = Object.keys(b).sort();\n\n  for (i = 0; i < Math.min(aKeys.length, bKeys.length); i += 1) {\n    comp = compareThings(a[aKeys[i]], b[bKeys[i]]);\n\n    if (comp !== 0) { return comp; }\n  }\n\n  return compareNSB(aKeys.length, bKeys.length);\n}\n\n\n\n// ==============================================================\n// Updating documents\n// ==============================================================\n\n/**\n * The signature of modifier functions is as follows\n * Their structure is always the same: recursively follow the dot notation while creating\n * the nested documents if needed, then apply the \"last step modifier\"\n * @param {Object} obj The model to modify\n * @param {String} field Can contain dots, in that case that means we will set a subfield recursively\n * @param {Model} value\n */\n\n/**\n * Set a field to a new value\n */\nlastStepModifierFunctions.$set = function (obj, field, value) {\n  obj[field] = value;\n};\n\n\n/**\n * Unset a field\n */\nlastStepModifierFunctions.$unset = function (obj, field, value) {\n  delete obj[field];\n};\n\n\n/**\n * Push an element to the end of an array field\n * Optional modifier $each instead of value to push several values\n * Optional modifier $slice to slice the resulting array, see https://docs.mongodb.org/manual/reference/operator/update/slice/\n * Différeence with MongoDB: if $slice is specified and not $each, we act as if value is an empty array\n */\nlastStepModifierFunctions.$push = function (obj, field, value) {\n  // Create the array if it doesn't exist\n  if (!obj.hasOwnProperty(field)) { obj[field] = []; }\n\n  if (!util.isArray(obj[field])) { throw new Error(\"Can't $push an element on non-array values\"); }\n\n  if (value !== null && typeof value === 'object' && value.$slice && value.$each === undefined) {\n    value.$each = [];\n  }\n\n  if (value !== null && typeof value === 'object' && value.$each) {\n    if (Object.keys(value).length >= 3 || (Object.keys(value).length === 2 && value.$slice === undefined)) { throw new Error(\"Can only use $slice in cunjunction with $each when $push to array\"); }\n    if (!util.isArray(value.$each)) { throw new Error(\"$each requires an array value\"); }\n\n    value.$each.forEach(function (v) {\n      obj[field].push(v);\n    });\n\n    if (value.$slice === undefined || typeof value.$slice !== 'number') { return; }\n\n    if (value.$slice === 0) {\n      obj[field] = [];\n    } else {\n      var start, end, n = obj[field].length;\n      if (value.$slice < 0) {\n        start = Math.max(0, n + value.$slice);\n        end = n;\n      } else if (value.$slice > 0) {\n        start = 0;\n        end = Math.min(n, value.$slice);\n      }\n      obj[field] = obj[field].slice(start, end);\n    }\n  } else {\n    obj[field].push(value);\n  }\n};\n\n\n/**\n * Add an element to an array field only if it is not already in it\n * No modification if the element is already in the array\n * Note that it doesn't check whether the original array contains duplicates\n */\nlastStepModifierFunctions.$addToSet = function (obj, field, value) {\n  var addToSet = true;\n\n  // Create the array if it doesn't exist\n  if (!obj.hasOwnProperty(field)) { obj[field] = []; }\n\n  if (!util.isArray(obj[field])) { throw new Error(\"Can't $addToSet an element on non-array values\"); }\n\n  if (value !== null && typeof value === 'object' && value.$each) {\n    if (Object.keys(value).length > 1) { throw new Error(\"Can't use another field in conjunction with $each\"); }\n    if (!util.isArray(value.$each)) { throw new Error(\"$each requires an array value\"); }\n\n    value.$each.forEach(function (v) {\n      lastStepModifierFunctions.$addToSet(obj, field, v);\n    });\n  } else {\n    obj[field].forEach(function (v) {\n      if (compareThings(v, value) === 0) { addToSet = false; }\n    });\n    if (addToSet) { obj[field].push(value); }\n  }\n};\n\n\n/**\n * Remove the first or last element of an array\n */\nlastStepModifierFunctions.$pop = function (obj, field, value) {\n  if (!util.isArray(obj[field])) { throw new Error(\"Can't $pop an element from non-array values\"); }\n  if (typeof value !== 'number') { throw new Error(value + \" isn't an integer, can't use it with $pop\"); }\n  if (value === 0) { return; }\n\n  if (value > 0) {\n    obj[field] = obj[field].slice(0, obj[field].length - 1);\n  } else {\n    obj[field] = obj[field].slice(1);\n  }\n};\n\n\n/**\n * Removes all instances of a value from an existing array\n */\nlastStepModifierFunctions.$pull = function (obj, field, value) {\n  var arr, i;\n\n  if (!util.isArray(obj[field])) { throw new Error(\"Can't $pull an element from non-array values\"); }\n\n  arr = obj[field];\n  for (i = arr.length - 1; i >= 0; i -= 1) {\n    if (match(arr[i], value)) {\n      arr.splice(i, 1);\n    }\n  }\n};\n\n\n/**\n * Increment a numeric field's value\n */\nlastStepModifierFunctions.$inc = function (obj, field, value) {\n  if (typeof value !== 'number') { throw new Error(value + \" must be a number\"); }\n\n  if (typeof obj[field] !== 'number') {\n    if (!_.has(obj, field)) {\n      obj[field] = value;\n    } else {\n      throw new Error(\"Don't use the $inc modifier on non-number fields\");\n    }\n  } else {\n    obj[field] += value;\n  }\n};\n\n/**\n * Updates the value of the field, only if specified field is greater than the current value of the field\n */\nlastStepModifierFunctions.$max = function (obj, field, value) {\n  if (typeof obj[field] === 'undefined') {\n    obj[field] = value;\n  } else if (value > obj[field]) {\n    obj[field] = value;\n  }\n};\n\n/**\n * Updates the value of the field, only if specified field is smaller than the current value of the field\n */\nlastStepModifierFunctions.$min = function (obj, field, value) {\n  if (typeof obj[field] === 'undefined') { \n    obj[field] = value;\n  } else if (value < obj[field]) {\n    obj[field] = value;\n  }\n};\n\n// Given its name, create the complete modifier function\nfunction createModifierFunction (modifier) {\n  return function (obj, field, value) {\n    var fieldParts = typeof field === 'string' ? field.split('.') : field;\n\n    if (fieldParts.length === 1) {\n      lastStepModifierFunctions[modifier](obj, field, value);\n    } else {\n      if (obj[fieldParts[0]] === undefined) {\n        if (modifier === '$unset') { return; }   // Bad looking specific fix, needs to be generalized modifiers that behave like $unset are implemented\n        obj[fieldParts[0]] = {};\n      }\n      modifierFunctions[modifier](obj[fieldParts[0]], fieldParts.slice(1), value);\n    }\n  };\n}\n\n// Actually create all modifier functions\nObject.keys(lastStepModifierFunctions).forEach(function (modifier) {\n  modifierFunctions[modifier] = createModifierFunction(modifier);\n});\n\n\n/**\n * Modify a DB object according to an update query\n */\nfunction modify (obj, updateQuery) {\n  var keys = Object.keys(updateQuery)\n    , firstChars = _.map(keys, function (item) { return item[0]; })\n    , dollarFirstChars = _.filter(firstChars, function (c) { return c === '$'; })\n    , newDoc, modifiers\n    ;\n\n  if (keys.indexOf('_id') !== -1 && updateQuery._id !== obj._id) { throw new Error(\"You cannot change a document's _id\"); }\n\n  if (dollarFirstChars.length !== 0 && dollarFirstChars.length !== firstChars.length) {\n    throw new Error(\"You cannot mix modifiers and normal fields\");\n  }\n\n  if (dollarFirstChars.length === 0) {\n    // Simply replace the object with the update query contents\n    newDoc = deepCopy(updateQuery);\n    newDoc._id = obj._id;\n  } else {\n    // Apply modifiers\n    modifiers = _.uniq(keys);\n    newDoc = deepCopy(obj);\n    modifiers.forEach(function (m) {\n      var keys;\n\n      if (!modifierFunctions[m]) { throw new Error(\"Unknown modifier \" + m); }\n\n      // Can't rely on Object.keys throwing on non objects since ES6\n      // Not 100% satisfying as non objects can be interpreted as objects but no false negatives so we can live with it\n      if (typeof updateQuery[m] !== 'object') {\n        throw new Error(\"Modifier \" + m + \"'s argument must be an object\");\n      }\n\n      keys = Object.keys(updateQuery[m]);\n      keys.forEach(function (k) {\n        modifierFunctions[m](newDoc, k, updateQuery[m][k]);\n      });\n    });\n  }\n\n  // Check result is valid and return it\n  checkObject(newDoc);\n\n  if (obj._id !== newDoc._id) { throw new Error(\"You can't change a document's _id\"); }\n  return newDoc;\n};\n\n\n// ==============================================================\n// Finding documents\n// ==============================================================\n\n/**\n * Get a value from object with dot notation\n * @param {Object} obj\n * @param {String} field\n */\nfunction getDotValue (obj, field) {\n  var fieldParts = typeof field === 'string' ? field.split('.') : field\n    , i, objs;\n\n  if (!obj) { return undefined; }   // field cannot be empty so that means we should return undefined so that nothing can match\n\n  if (fieldParts.length === 0) { return obj; }\n\n  if (fieldParts.length === 1) { return obj[fieldParts[0]]; }\n\n  if (util.isArray(obj[fieldParts[0]])) {\n    // If the next field is an integer, return only this item of the array\n    i = parseInt(fieldParts[1], 10);\n    if (typeof i === 'number' && !isNaN(i)) {\n      return getDotValue(obj[fieldParts[0]][i], fieldParts.slice(2))\n    }\n\n    // Return the array of values\n    objs = new Array();\n    for (i = 0; i < obj[fieldParts[0]].length; i += 1) {\n       objs.push(getDotValue(obj[fieldParts[0]][i], fieldParts.slice(1)));\n    }\n    return objs;\n  } else {\n    return getDotValue(obj[fieldParts[0]], fieldParts.slice(1));\n  }\n}\n\n\n/**\n * Check whether 'things' are equal\n * Things are defined as any native types (string, number, boolean, null, date) and objects\n * In the case of object, we check deep equality\n * Returns true if they are, false otherwise\n */\nfunction areThingsEqual (a, b) {\n  var aKeys , bKeys , i;\n\n  // Strings, booleans, numbers, null\n  if (a === null || typeof a === 'string' || typeof a === 'boolean' || typeof a === 'number' ||\n      b === null || typeof b === 'string' || typeof b === 'boolean' || typeof b === 'number') { return a === b; }\n\n  // Dates\n  if (util.isDate(a) || util.isDate(b)) { return util.isDate(a) && util.isDate(b) && a.getTime() === b.getTime(); }\n\n  // Arrays (no match since arrays are used as a $in)\n  // undefined (no match since they mean field doesn't exist and can't be serialized)\n  if ((!(util.isArray(a) && util.isArray(b)) && (util.isArray(a) || util.isArray(b))) || a === undefined || b === undefined) { return false; }\n\n  // General objects (check for deep equality)\n  // a and b should be objects at this point\n  try {\n    aKeys = Object.keys(a);\n    bKeys = Object.keys(b);\n  } catch (e) {\n    return false;\n  }\n\n  if (aKeys.length !== bKeys.length) { return false; }\n  for (i = 0; i < aKeys.length; i += 1) {\n    if (bKeys.indexOf(aKeys[i]) === -1) { return false; }\n    if (!areThingsEqual(a[aKeys[i]], b[aKeys[i]])) { return false; }\n  }\n  return true;\n}\n\n\n/**\n * Check that two values are comparable\n */\nfunction areComparable (a, b) {\n  if (typeof a !== 'string' && typeof a !== 'number' && !util.isDate(a) &&\n      typeof b !== 'string' && typeof b !== 'number' && !util.isDate(b)) {\n    return false;\n  }\n\n  if (typeof a !== typeof b) { return false; }\n\n  return true;\n}\n\n\n/**\n * Arithmetic and comparison operators\n * @param {Native value} a Value in the object\n * @param {Native value} b Value in the query\n */\ncomparisonFunctions.$lt = function (a, b) {\n  return areComparable(a, b) && a < b;\n};\n\ncomparisonFunctions.$lte = function (a, b) {\n  return areComparable(a, b) && a <= b;\n};\n\ncomparisonFunctions.$gt = function (a, b) {\n  return areComparable(a, b) && a > b;\n};\n\ncomparisonFunctions.$gte = function (a, b) {\n  return areComparable(a, b) && a >= b;\n};\n\ncomparisonFunctions.$ne = function (a, b) {\n  if (a === undefined) { return true; }\n  return !areThingsEqual(a, b);\n};\n\ncomparisonFunctions.$in = function (a, b) {\n  var i;\n\n  if (!util.isArray(b)) { throw new Error(\"$in operator called with a non-array\"); }\n\n  for (i = 0; i < b.length; i += 1) {\n    if (areThingsEqual(a, b[i])) { return true; }\n  }\n\n  return false;\n};\n\ncomparisonFunctions.$nin = function (a, b) {\n  if (!util.isArray(b)) { throw new Error(\"$nin operator called with a non-array\"); }\n\n  return !comparisonFunctions.$in(a, b);\n};\n\ncomparisonFunctions.$regex = function (a, b) {\n  if (!util.isRegExp(b)) { throw new Error(\"$regex operator called with non regular expression\"); }\n\n  if (typeof a !== 'string') {\n    return false\n  } else {\n    return b.test(a);\n  }\n};\n\ncomparisonFunctions.$exists = function (value, exists) {\n  if (exists || exists === '') {   // This will be true for all values of exists except false, null, undefined and 0\n    exists = true;                 // That's strange behaviour (we should only use true/false) but that's the way Mongo does it...\n  } else {\n    exists = false;\n  }\n\n  if (value === undefined) {\n    return !exists\n  } else {\n    return exists;\n  }\n};\n\n// Specific to arrays\ncomparisonFunctions.$size = function (obj, value) {\n    if (!util.isArray(obj)) { return false; }\n    if (value % 1 !== 0) { throw new Error(\"$size operator called without an integer\"); }\n\n    return (obj.length == value);\n};\ncomparisonFunctions.$elemMatch = function (obj, value) {\n  if (!util.isArray(obj)) { return false; }\n  var i = obj.length;\n  var result = false;   // Initialize result\n  while (i--) {\n    if (match(obj[i], value)) {   // If match for array element, return true\n      result = true;\n      break;\n    }\n  }\n  return result;\n};\narrayComparisonFunctions.$size = true;\narrayComparisonFunctions.$elemMatch = true;\n\n\n/**\n * Match any of the subqueries\n * @param {Model} obj\n * @param {Array of Queries} query\n */\nlogicalOperators.$or = function (obj, query) {\n  var i;\n\n  if (!util.isArray(query)) { throw new Error(\"$or operator used without an array\"); }\n\n  for (i = 0; i < query.length; i += 1) {\n    if (match(obj, query[i])) { return true; }\n  }\n\n  return false;\n};\n\n\n/**\n * Match all of the subqueries\n * @param {Model} obj\n * @param {Array of Queries} query\n */\nlogicalOperators.$and = function (obj, query) {\n  var i;\n\n  if (!util.isArray(query)) { throw new Error(\"$and operator used without an array\"); }\n\n  for (i = 0; i < query.length; i += 1) {\n    if (!match(obj, query[i])) { return false; }\n  }\n\n  return true;\n};\n\n\n/**\n * Inverted match of the query\n * @param {Model} obj\n * @param {Query} query\n */\nlogicalOperators.$not = function (obj, query) {\n  return !match(obj, query);\n};\n\n\n/**\n * Use a function to match\n * @param {Model} obj\n * @param {Query} query\n */\nlogicalOperators.$where = function (obj, fn) {\n  var result;\n\n  if (!_.isFunction(fn)) { throw new Error(\"$where operator used without a function\"); }\n\n  result = fn.call(obj);\n  if (!_.isBoolean(result)) { throw new Error(\"$where function must return boolean\"); }\n\n  return result;\n};\n\n\n/**\n * Tell if a given document matches a query\n * @param {Object} obj Document to check\n * @param {Object} query\n */\nfunction match (obj, query) {\n  var queryKeys, queryKey, queryValue, i;\n\n  // Primitive query against a primitive type\n  // This is a bit of a hack since we construct an object with an arbitrary key only to dereference it later\n  // But I don't have time for a cleaner implementation now\n  if (isPrimitiveType(obj) || isPrimitiveType(query)) {\n    return matchQueryPart({ needAKey: obj }, 'needAKey', query);\n  }\n\n  // Normal query\n  queryKeys = Object.keys(query);\n  for (i = 0; i < queryKeys.length; i += 1) {\n    queryKey = queryKeys[i];\n    queryValue = query[queryKey];\n\n    if (queryKey[0] === '$') {\n      if (!logicalOperators[queryKey]) { throw new Error(\"Unknown logical operator \" + queryKey); }\n      if (!logicalOperators[queryKey](obj, queryValue)) { return false; }\n    } else {\n      if (!matchQueryPart(obj, queryKey, queryValue)) { return false; }\n    }\n  }\n\n  return true;\n};\n\n\n/**\n * Match an object against a specific { key: value } part of a query\n * if the treatObjAsValue flag is set, don't try to match every part separately, but the array as a whole\n */\nfunction matchQueryPart (obj, queryKey, queryValue, treatObjAsValue) {\n  var objValue = getDotValue(obj, queryKey)\n    , i, keys, firstChars, dollarFirstChars;\n\n  // Check if the value is an array if we don't force a treatment as value\n  if (util.isArray(objValue) && !treatObjAsValue) {\n    // If the queryValue is an array, try to perform an exact match\n    if (util.isArray(queryValue)) {\n      return matchQueryPart(obj, queryKey, queryValue, true);\n    }\n\n    // Check if we are using an array-specific comparison function\n    if (queryValue !== null && typeof queryValue === 'object' && !util.isRegExp(queryValue)) {\n      keys = Object.keys(queryValue);\n      for (i = 0; i < keys.length; i += 1) {\n        if (arrayComparisonFunctions[keys[i]]) { return matchQueryPart(obj, queryKey, queryValue, true); }\n      }\n    }\n\n    // If not, treat it as an array of { obj, query } where there needs to be at least one match\n    for (i = 0; i < objValue.length; i += 1) {\n      if (matchQueryPart({ k: objValue[i] }, 'k', queryValue)) { return true; }   // k here could be any string\n    }\n    return false;\n  }\n\n  // queryValue is an actual object. Determine whether it contains comparison operators\n  // or only normal fields. Mixed objects are not allowed\n  if (queryValue !== null && typeof queryValue === 'object' && !util.isRegExp(queryValue) && !util.isArray(queryValue)) {\n    keys = Object.keys(queryValue);\n    firstChars = _.map(keys, function (item) { return item[0]; });\n    dollarFirstChars = _.filter(firstChars, function (c) { return c === '$'; });\n\n    if (dollarFirstChars.length !== 0 && dollarFirstChars.length !== firstChars.length) {\n      throw new Error(\"You cannot mix operators and normal fields\");\n    }\n\n    // queryValue is an object of this form: { $comparisonOperator1: value1, ... }\n    if (dollarFirstChars.length > 0) {\n      for (i = 0; i < keys.length; i += 1) {\n        if (!comparisonFunctions[keys[i]]) { throw new Error(\"Unknown comparison function \" + keys[i]); }\n\n        if (!comparisonFunctions[keys[i]](objValue, queryValue[keys[i]])) { return false; }\n      }\n      return true;\n    }\n  }\n\n  // Using regular expressions with basic querying\n  if (util.isRegExp(queryValue)) { return comparisonFunctions.$regex(objValue, queryValue); }\n\n  // queryValue is either a native value or a normal object\n  // Basic matching is possible\n  if (!areThingsEqual(objValue, queryValue)) { return false; }\n\n  return true;\n}\n\n\n// Interface\nmodule.exports.serialize = serialize;\nmodule.exports.deserialize = deserialize;\nmodule.exports.deepCopy = deepCopy;\nmodule.exports.checkObject = checkObject;\nmodule.exports.isPrimitiveType = isPrimitiveType;\nmodule.exports.modify = modify;\nmodule.exports.getDotValue = getDotValue;\nmodule.exports.match = match;\nmodule.exports.areThingsEqual = areThingsEqual;\nmodule.exports.compareThings = compareThings;\n","/**\n * Handle every persistence-related task\n * The interface Datastore expects to be implemented is\n * * Persistence.loadDatabase(callback) and callback has signature err\n * * Persistence.persistNewState(newDocs, callback) where newDocs is an array of documents and callback has signature err\n */\n\nvar storage = require('./storage')\n  , path = require('path')\n  , model = require('./model')\n  , async = require('async')\n  , customUtils = require('./customUtils')\n  , Index = require('./indexes')\n  ;\n\n\n/**\n * Create a new Persistence object for database options.db\n * @param {Datastore} options.db\n * @param {Boolean} options.nodeWebkitAppName Optional, specify the name of your NW app if you want options.filename to be relative to the directory where\n *                                            Node Webkit stores application data such as cookies and local storage (the best place to store data in my opinion)\n */\nfunction Persistence (options) {\n  var i, j, randomString;\n\n  this.db = options.db;\n  this.inMemoryOnly = this.db.inMemoryOnly;\n  this.filename = this.db.filename;\n  this.corruptAlertThreshold = options.corruptAlertThreshold !== undefined ? options.corruptAlertThreshold : 0.1;\n\n  if (!this.inMemoryOnly && this.filename && this.filename.charAt(this.filename.length - 1) === '~') {\n    throw new Error(\"The datafile name can't end with a ~, which is reserved for crash safe backup files\");\n  }\n\n  // After serialization and before deserialization hooks with some basic sanity checks\n  if (options.afterSerialization && !options.beforeDeserialization) {\n    throw new Error(\"Serialization hook defined but deserialization hook undefined, cautiously refusing to start NeDB to prevent dataloss\");\n  }\n  if (!options.afterSerialization && options.beforeDeserialization) {\n    throw new Error(\"Serialization hook undefined but deserialization hook defined, cautiously refusing to start NeDB to prevent dataloss\");\n  }\n  this.afterSerialization = options.afterSerialization || function (s) { return s; };\n  this.beforeDeserialization = options.beforeDeserialization || function (s) { return s; };\n  for (i = 1; i < 30; i += 1) {\n    for (j = 0; j < 10; j += 1) {\n      randomString = customUtils.uid(i);\n      if (this.beforeDeserialization(this.afterSerialization(randomString)) !== randomString) {\n        throw new Error(\"beforeDeserialization is not the reverse of afterSerialization, cautiously refusing to start NeDB to prevent dataloss\");\n      }\n    }\n  }\n\n  // For NW apps, store data in the same directory where NW stores application data\n  if (this.filename && options.nodeWebkitAppName) {\n    console.log(\"==================================================================\");\n    console.log(\"WARNING: The nodeWebkitAppName option is deprecated\");\n    console.log(\"To get the path to the directory where Node Webkit stores the data\");\n    console.log(\"for your app, use the internal nw.gui module like this\");\n    console.log(\"require('nw.gui').App.dataPath\");\n    console.log(\"See https://github.com/rogerwang/node-webkit/issues/500\");\n    console.log(\"==================================================================\");\n    this.filename = Persistence.getNWAppFilename(options.nodeWebkitAppName, this.filename);\n  }\n};\n\n\n/**\n * Check if a directory exists and create it on the fly if it is not the case\n * cb is optional, signature: err\n */\nPersistence.ensureDirectoryExists = function (dir, cb) {\n  var callback = cb || function () {}\n    ;\n\n  storage.mkdirp(dir, function (err) { return callback(err); });\n};\n\n\n\n\n/**\n * Return the path the datafile if the given filename is relative to the directory where Node Webkit stores\n * data for this application. Probably the best place to store data\n */\nPersistence.getNWAppFilename = function (appName, relativeFilename) {\n  var home;\n\n  switch (process.platform) {\n    case 'win32':\n    case 'win64':\n      home = process.env.LOCALAPPDATA || process.env.APPDATA;\n      if (!home) { throw new Error(\"Couldn't find the base application data folder\"); }\n      home = path.join(home, appName);\n      break;\n    case 'darwin':\n      home = process.env.HOME;\n      if (!home) { throw new Error(\"Couldn't find the base application data directory\"); }\n      home = path.join(home, 'Library', 'Application Support', appName);\n      break;\n    case 'linux':\n      home = process.env.HOME;\n      if (!home) { throw new Error(\"Couldn't find the base application data directory\"); }\n      home = path.join(home, '.config', appName);\n      break;\n    default:\n      throw new Error(\"Can't use the Node Webkit relative path for platform \" + process.platform);\n      break;\n  }\n\n  return path.join(home, 'nedb-data', relativeFilename);\n}\n\n\n/**\n * Persist cached database\n * This serves as a compaction function since the cache always contains only the number of documents in the collection\n * while the data file is append-only so it may grow larger\n * @param {Function} cb Optional callback, signature: err\n */\nPersistence.prototype.persistCachedDatabase = function (cb) {\n  var callback = cb || function () {}\n    , toPersist = ''\n    , self = this\n    ;\n\n  if (this.inMemoryOnly) { return callback(null); }\n\n  this.db.getAllData().forEach(function (doc) {\n    toPersist += self.afterSerialization(model.serialize(doc)) + '\\n';\n  });\n  Object.keys(this.db.indexes).forEach(function (fieldName) {\n    if (fieldName != \"_id\") {   // The special _id index is managed by datastore.js, the others need to be persisted\n      toPersist += self.afterSerialization(model.serialize({ $$indexCreated: { fieldName: fieldName, unique: self.db.indexes[fieldName].unique, sparse: self.db.indexes[fieldName].sparse }})) + '\\n';\n    }\n  });\n\n  storage.crashSafeWriteFile(this.filename, toPersist, function (err) {\n    if (err) { return callback(err); }\n    self.db.emit('compaction.done');\n    return callback(null);\n  });\n};\n\n\n/**\n * Queue a rewrite of the datafile\n */\nPersistence.prototype.compactDatafile = function () {\n  this.db.executor.push({ this: this, fn: this.persistCachedDatabase, arguments: [] });\n};\n\n\n/**\n * Set automatic compaction every interval ms\n * @param {Number} interval in milliseconds, with an enforced minimum of 5 seconds\n */\nPersistence.prototype.setAutocompactionInterval = function (interval) {\n  var self = this\n    , minInterval = 5000\n    , realInterval = Math.max(interval || 0, minInterval)\n    ;\n\n  this.stopAutocompaction();\n\n  this.autocompactionIntervalId = setInterval(function () {\n    self.compactDatafile();\n  }, realInterval);\n};\n\n\n/**\n * Stop autocompaction (do nothing if autocompaction was not running)\n */\nPersistence.prototype.stopAutocompaction = function () {\n  if (this.autocompactionIntervalId) { clearInterval(this.autocompactionIntervalId); }\n};\n\n\n/**\n * Persist new state for the given newDocs (can be insertion, update or removal)\n * Use an append-only format\n * @param {Array} newDocs Can be empty if no doc was updated/removed\n * @param {Function} cb Optional, signature: err\n */\nPersistence.prototype.persistNewState = function (newDocs, cb) {\n  var self = this\n    , toPersist = ''\n    , callback = cb || function () {}\n    ;\n\n  // In-memory only datastore\n  if (self.inMemoryOnly) { return callback(null); }\n\n  newDocs.forEach(function (doc) {\n    toPersist += self.afterSerialization(model.serialize(doc)) + '\\n';\n  });\n\n  if (toPersist.length === 0) { return callback(null); }\n\n  storage.appendFile(self.filename, toPersist, 'utf8', function (err) {\n    return callback(err);\n  });\n};\n\n\n/**\n * From a database's raw data, return the corresponding\n * machine understandable collection\n */\nPersistence.prototype.treatRawData = function (rawData) {\n  var data = rawData.split('\\n')\n    , dataById = {}\n    , tdata = []\n    , i\n    , indexes = {}\n    , corruptItems = -1   // Last line of every data file is usually blank so not really corrupt\n    ;\n\n  for (i = 0; i < data.length; i += 1) {\n    var doc;\n\n    try {\n      doc = model.deserialize(this.beforeDeserialization(data[i]));\n      if (doc._id) {\n        if (doc.$$deleted === true) {\n          delete dataById[doc._id];\n        } else {\n          dataById[doc._id] = doc;\n        }\n      } else if (doc.$$indexCreated && doc.$$indexCreated.fieldName != undefined) {\n        indexes[doc.$$indexCreated.fieldName] = doc.$$indexCreated;\n      } else if (typeof doc.$$indexRemoved === \"string\") {\n        delete indexes[doc.$$indexRemoved];\n      }\n    } catch (e) {\n      corruptItems += 1;\n    }\n  }\n\n  // A bit lenient on corruption\n  if (data.length > 0 && corruptItems / data.length > this.corruptAlertThreshold) {\n    throw new Error(\"More than \" + Math.floor(100 * this.corruptAlertThreshold) + \"% of the data file is corrupt, the wrong beforeDeserialization hook may be used. Cautiously refusing to start NeDB to prevent dataloss\");\n  }\n\n  Object.keys(dataById).forEach(function (k) {\n    tdata.push(dataById[k]);\n  });\n\n  return { data: tdata, indexes: indexes };\n};\n\n\n/**\n * Load the database\n * 1) Create all indexes\n * 2) Insert all data\n * 3) Compact the database\n * This means pulling data out of the data file or creating it if it doesn't exist\n * Also, all data is persisted right away, which has the effect of compacting the database file\n * This operation is very quick at startup for a big collection (60ms for ~10k docs)\n * @param {Function} cb Optional callback, signature: err\n */\nPersistence.prototype.loadDatabase = function (cb) {\n  var callback = cb || function () {}\n    , self = this\n    ;\n\n  self.db.resetIndexes();\n\n  // In-memory only datastore\n  if (self.inMemoryOnly) { return callback(null); }\n\n  async.waterfall([\n    function (cb) {\n      Persistence.ensureDirectoryExists(path.dirname(self.filename), function (err) {\n        storage.ensureDatafileIntegrity(self.filename, function (err) {\n          storage.readFile(self.filename, 'utf8', function (err, rawData) {\n            if (err) { return cb(err); }\n\n            try {\n              var treatedData = self.treatRawData(rawData);\n            } catch (e) {\n              return cb(e);\n            }\n\n            // Recreate all indexes in the datafile\n            Object.keys(treatedData.indexes).forEach(function (key) {\n              self.db.indexes[key] = new Index(treatedData.indexes[key]);\n            });\n\n            // Fill cached database (i.e. all indexes) with data\n            try {\n              self.db.resetIndexes(treatedData.data);\n            } catch (e) {\n              self.db.resetIndexes();   // Rollback any index which didn't fail\n              return cb(e);\n            }\n\n            self.db.persistence.persistCachedDatabase(cb);\n          });\n        });\n      });\n    }\n  ], function (err) {\n       if (err) { return callback(err); }\n\n       self.db.executor.processBuffer();\n       return callback(null);\n     });\n};\n\n\n// Interface\nmodule.exports = Persistence;\n","'use strict';\nvar $ = require('../internals/export');\nvar $find = require('../internals/array-iteration').find;\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar FIND = 'find';\nvar SKIPS_HOLES = true;\n\nvar USES_TO_LENGTH = arrayMethodUsesToLength(FIND);\n\n// Shouldn't skip holes\nif (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.find` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.find\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES || !USES_TO_LENGTH }, {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND);\n","//     Underscore.js 1.4.4\n//     http://underscorejs.org\n//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.\n//     Underscore may be freely distributed under the MIT license.\n\n(function() {\n\n  // Baseline setup\n  // --------------\n\n  // Establish the root object, `window` in the browser, or `global` on the server.\n  var root = this;\n\n  // Save the previous value of the `_` variable.\n  var previousUnderscore = root._;\n\n  // Establish the object that gets returned to break out of a loop iteration.\n  var breaker = {};\n\n  // Save bytes in the minified (but not gzipped) version:\n  var ArrayProto = Array.prototype, ObjProto = Object.prototype, FuncProto = Function.prototype;\n\n  // Create quick reference variables for speed access to core prototypes.\n  var push             = ArrayProto.push,\n      slice            = ArrayProto.slice,\n      concat           = ArrayProto.concat,\n      toString         = ObjProto.toString,\n      hasOwnProperty   = ObjProto.hasOwnProperty;\n\n  // All **ECMAScript 5** native function implementations that we hope to use\n  // are declared here.\n  var\n    nativeForEach      = ArrayProto.forEach,\n    nativeMap          = ArrayProto.map,\n    nativeReduce       = ArrayProto.reduce,\n    nativeReduceRight  = ArrayProto.reduceRight,\n    nativeFilter       = ArrayProto.filter,\n    nativeEvery        = ArrayProto.every,\n    nativeSome         = ArrayProto.some,\n    nativeIndexOf      = ArrayProto.indexOf,\n    nativeLastIndexOf  = ArrayProto.lastIndexOf,\n    nativeIsArray      = Array.isArray,\n    nativeKeys         = Object.keys,\n    nativeBind         = FuncProto.bind;\n\n  // Create a safe reference to the Underscore object for use below.\n  var _ = function(obj) {\n    if (obj instanceof _) return obj;\n    if (!(this instanceof _)) return new _(obj);\n    this._wrapped = obj;\n  };\n\n  // Export the Underscore object for **Node.js**, with\n  // backwards-compatibility for the old `require()` API. If we're in\n  // the browser, add `_` as a global object via a string identifier,\n  // for Closure Compiler \"advanced\" mode.\n  if (typeof exports !== 'undefined') {\n    if (typeof module !== 'undefined' && module.exports) {\n      exports = module.exports = _;\n    }\n    exports._ = _;\n  } else {\n    root._ = _;\n  }\n\n  // Current version.\n  _.VERSION = '1.4.4';\n\n  // Collection Functions\n  // --------------------\n\n  // The cornerstone, an `each` implementation, aka `forEach`.\n  // Handles objects with the built-in `forEach`, arrays, and raw objects.\n  // Delegates to **ECMAScript 5**'s native `forEach` if available.\n  var each = _.each = _.forEach = function(obj, iterator, context) {\n    if (obj == null) return;\n    if (nativeForEach && obj.forEach === nativeForEach) {\n      obj.forEach(iterator, context);\n    } else if (obj.length === +obj.length) {\n      for (var i = 0, l = obj.length; i < l; i++) {\n        if (iterator.call(context, obj[i], i, obj) === breaker) return;\n      }\n    } else {\n      for (var key in obj) {\n        if (_.has(obj, key)) {\n          if (iterator.call(context, obj[key], key, obj) === breaker) return;\n        }\n      }\n    }\n  };\n\n  // Return the results of applying the iterator to each element.\n  // Delegates to **ECMAScript 5**'s native `map` if available.\n  _.map = _.collect = function(obj, iterator, context) {\n    var results = [];\n    if (obj == null) return results;\n    if (nativeMap && obj.map === nativeMap) return obj.map(iterator, context);\n    each(obj, function(value, index, list) {\n      results[results.length] = iterator.call(context, value, index, list);\n    });\n    return results;\n  };\n\n  var reduceError = 'Reduce of empty array with no initial value';\n\n  // **Reduce** builds up a single result from a list of values, aka `inject`,\n  // or `foldl`. Delegates to **ECMAScript 5**'s native `reduce` if available.\n  _.reduce = _.foldl = _.inject = function(obj, iterator, memo, context) {\n    var initial = arguments.length > 2;\n    if (obj == null) obj = [];\n    if (nativeReduce && obj.reduce === nativeReduce) {\n      if (context) iterator = _.bind(iterator, context);\n      return initial ? obj.reduce(iterator, memo) : obj.reduce(iterator);\n    }\n    each(obj, function(value, index, list) {\n      if (!initial) {\n        memo = value;\n        initial = true;\n      } else {\n        memo = iterator.call(context, memo, value, index, list);\n      }\n    });\n    if (!initial) throw new TypeError(reduceError);\n    return memo;\n  };\n\n  // The right-associative version of reduce, also known as `foldr`.\n  // Delegates to **ECMAScript 5**'s native `reduceRight` if available.\n  _.reduceRight = _.foldr = function(obj, iterator, memo, context) {\n    var initial = arguments.length > 2;\n    if (obj == null) obj = [];\n    if (nativeReduceRight && obj.reduceRight === nativeReduceRight) {\n      if (context) iterator = _.bind(iterator, context);\n      return initial ? obj.reduceRight(iterator, memo) : obj.reduceRight(iterator);\n    }\n    var length = obj.length;\n    if (length !== +length) {\n      var keys = _.keys(obj);\n      length = keys.length;\n    }\n    each(obj, function(value, index, list) {\n      index = keys ? keys[--length] : --length;\n      if (!initial) {\n        memo = obj[index];\n        initial = true;\n      } else {\n        memo = iterator.call(context, memo, obj[index], index, list);\n      }\n    });\n    if (!initial) throw new TypeError(reduceError);\n    return memo;\n  };\n\n  // Return the first value which passes a truth test. Aliased as `detect`.\n  _.find = _.detect = function(obj, iterator, context) {\n    var result;\n    any(obj, function(value, index, list) {\n      if (iterator.call(context, value, index, list)) {\n        result = value;\n        return true;\n      }\n    });\n    return result;\n  };\n\n  // Return all the elements that pass a truth test.\n  // Delegates to **ECMAScript 5**'s native `filter` if available.\n  // Aliased as `select`.\n  _.filter = _.select = function(obj, iterator, context) {\n    var results = [];\n    if (obj == null) return results;\n    if (nativeFilter && obj.filter === nativeFilter) return obj.filter(iterator, context);\n    each(obj, function(value, index, list) {\n      if (iterator.call(context, value, index, list)) results[results.length] = value;\n    });\n    return results;\n  };\n\n  // Return all the elements for which a truth test fails.\n  _.reject = function(obj, iterator, context) {\n    return _.filter(obj, function(value, index, list) {\n      return !iterator.call(context, value, index, list);\n    }, context);\n  };\n\n  // Determine whether all of the elements match a truth test.\n  // Delegates to **ECMAScript 5**'s native `every` if available.\n  // Aliased as `all`.\n  _.every = _.all = function(obj, iterator, context) {\n    iterator || (iterator = _.identity);\n    var result = true;\n    if (obj == null) return result;\n    if (nativeEvery && obj.every === nativeEvery) return obj.every(iterator, context);\n    each(obj, function(value, index, list) {\n      if (!(result = result && iterator.call(context, value, index, list))) return breaker;\n    });\n    return !!result;\n  };\n\n  // Determine if at least one element in the object matches a truth test.\n  // Delegates to **ECMAScript 5**'s native `some` if available.\n  // Aliased as `any`.\n  var any = _.some = _.any = function(obj, iterator, context) {\n    iterator || (iterator = _.identity);\n    var result = false;\n    if (obj == null) return result;\n    if (nativeSome && obj.some === nativeSome) return obj.some(iterator, context);\n    each(obj, function(value, index, list) {\n      if (result || (result = iterator.call(context, value, index, list))) return breaker;\n    });\n    return !!result;\n  };\n\n  // Determine if the array or object contains a given value (using `===`).\n  // Aliased as `include`.\n  _.contains = _.include = function(obj, target) {\n    if (obj == null) return false;\n    if (nativeIndexOf && obj.indexOf === nativeIndexOf) return obj.indexOf(target) != -1;\n    return any(obj, function(value) {\n      return value === target;\n    });\n  };\n\n  // Invoke a method (with arguments) on every item in a collection.\n  _.invoke = function(obj, method) {\n    var args = slice.call(arguments, 2);\n    var isFunc = _.isFunction(method);\n    return _.map(obj, function(value) {\n      return (isFunc ? method : value[method]).apply(value, args);\n    });\n  };\n\n  // Convenience version of a common use case of `map`: fetching a property.\n  _.pluck = function(obj, key) {\n    return _.map(obj, function(value){ return value[key]; });\n  };\n\n  // Convenience version of a common use case of `filter`: selecting only objects\n  // containing specific `key:value` pairs.\n  _.where = function(obj, attrs, first) {\n    if (_.isEmpty(attrs)) return first ? null : [];\n    return _[first ? 'find' : 'filter'](obj, function(value) {\n      for (var key in attrs) {\n        if (attrs[key] !== value[key]) return false;\n      }\n      return true;\n    });\n  };\n\n  // Convenience version of a common use case of `find`: getting the first object\n  // containing specific `key:value` pairs.\n  _.findWhere = function(obj, attrs) {\n    return _.where(obj, attrs, true);\n  };\n\n  // Return the maximum element or (element-based computation).\n  // Can't optimize arrays of integers longer than 65,535 elements.\n  // See: https://bugs.webkit.org/show_bug.cgi?id=80797\n  _.max = function(obj, iterator, context) {\n    if (!iterator && _.isArray(obj) && obj[0] === +obj[0] && obj.length < 65535) {\n      return Math.max.apply(Math, obj);\n    }\n    if (!iterator && _.isEmpty(obj)) return -Infinity;\n    var result = {computed : -Infinity, value: -Infinity};\n    each(obj, function(value, index, list) {\n      var computed = iterator ? iterator.call(context, value, index, list) : value;\n      computed >= result.computed && (result = {value : value, computed : computed});\n    });\n    return result.value;\n  };\n\n  // Return the minimum element (or element-based computation).\n  _.min = function(obj, iterator, context) {\n    if (!iterator && _.isArray(obj) && obj[0] === +obj[0] && obj.length < 65535) {\n      return Math.min.apply(Math, obj);\n    }\n    if (!iterator && _.isEmpty(obj)) return Infinity;\n    var result = {computed : Infinity, value: Infinity};\n    each(obj, function(value, index, list) {\n      var computed = iterator ? iterator.call(context, value, index, list) : value;\n      computed < result.computed && (result = {value : value, computed : computed});\n    });\n    return result.value;\n  };\n\n  // Shuffle an array.\n  _.shuffle = function(obj) {\n    var rand;\n    var index = 0;\n    var shuffled = [];\n    each(obj, function(value) {\n      rand = _.random(index++);\n      shuffled[index - 1] = shuffled[rand];\n      shuffled[rand] = value;\n    });\n    return shuffled;\n  };\n\n  // An internal function to generate lookup iterators.\n  var lookupIterator = function(value) {\n    return _.isFunction(value) ? value : function(obj){ return obj[value]; };\n  };\n\n  // Sort the object's values by a criterion produced by an iterator.\n  _.sortBy = function(obj, value, context) {\n    var iterator = lookupIterator(value);\n    return _.pluck(_.map(obj, function(value, index, list) {\n      return {\n        value : value,\n        index : index,\n        criteria : iterator.call(context, value, index, list)\n      };\n    }).sort(function(left, right) {\n      var a = left.criteria;\n      var b = right.criteria;\n      if (a !== b) {\n        if (a > b || a === void 0) return 1;\n        if (a < b || b === void 0) return -1;\n      }\n      return left.index < right.index ? -1 : 1;\n    }), 'value');\n  };\n\n  // An internal function used for aggregate \"group by\" operations.\n  var group = function(obj, value, context, behavior) {\n    var result = {};\n    var iterator = lookupIterator(value || _.identity);\n    each(obj, function(value, index) {\n      var key = iterator.call(context, value, index, obj);\n      behavior(result, key, value);\n    });\n    return result;\n  };\n\n  // Groups the object's values by a criterion. Pass either a string attribute\n  // to group by, or a function that returns the criterion.\n  _.groupBy = function(obj, value, context) {\n    return group(obj, value, context, function(result, key, value) {\n      (_.has(result, key) ? result[key] : (result[key] = [])).push(value);\n    });\n  };\n\n  // Counts instances of an object that group by a certain criterion. Pass\n  // either a string attribute to count by, or a function that returns the\n  // criterion.\n  _.countBy = function(obj, value, context) {\n    return group(obj, value, context, function(result, key) {\n      if (!_.has(result, key)) result[key] = 0;\n      result[key]++;\n    });\n  };\n\n  // Use a comparator function to figure out the smallest index at which\n  // an object should be inserted so as to maintain order. Uses binary search.\n  _.sortedIndex = function(array, obj, iterator, context) {\n    iterator = iterator == null ? _.identity : lookupIterator(iterator);\n    var value = iterator.call(context, obj);\n    var low = 0, high = array.length;\n    while (low < high) {\n      var mid = (low + high) >>> 1;\n      iterator.call(context, array[mid]) < value ? low = mid + 1 : high = mid;\n    }\n    return low;\n  };\n\n  // Safely convert anything iterable into a real, live array.\n  _.toArray = function(obj) {\n    if (!obj) return [];\n    if (_.isArray(obj)) return slice.call(obj);\n    if (obj.length === +obj.length) return _.map(obj, _.identity);\n    return _.values(obj);\n  };\n\n  // Return the number of elements in an object.\n  _.size = function(obj) {\n    if (obj == null) return 0;\n    return (obj.length === +obj.length) ? obj.length : _.keys(obj).length;\n  };\n\n  // Array Functions\n  // ---------------\n\n  // Get the first element of an array. Passing **n** will return the first N\n  // values in the array. Aliased as `head` and `take`. The **guard** check\n  // allows it to work with `_.map`.\n  _.first = _.head = _.take = function(array, n, guard) {\n    if (array == null) return void 0;\n    return (n != null) && !guard ? slice.call(array, 0, n) : array[0];\n  };\n\n  // Returns everything but the last entry of the array. Especially useful on\n  // the arguments object. Passing **n** will return all the values in\n  // the array, excluding the last N. The **guard** check allows it to work with\n  // `_.map`.\n  _.initial = function(array, n, guard) {\n    return slice.call(array, 0, array.length - ((n == null) || guard ? 1 : n));\n  };\n\n  // Get the last element of an array. Passing **n** will return the last N\n  // values in the array. The **guard** check allows it to work with `_.map`.\n  _.last = function(array, n, guard) {\n    if (array == null) return void 0;\n    if ((n != null) && !guard) {\n      return slice.call(array, Math.max(array.length - n, 0));\n    } else {\n      return array[array.length - 1];\n    }\n  };\n\n  // Returns everything but the first entry of the array. Aliased as `tail` and `drop`.\n  // Especially useful on the arguments object. Passing an **n** will return\n  // the rest N values in the array. The **guard**\n  // check allows it to work with `_.map`.\n  _.rest = _.tail = _.drop = function(array, n, guard) {\n    return slice.call(array, (n == null) || guard ? 1 : n);\n  };\n\n  // Trim out all falsy values from an array.\n  _.compact = function(array) {\n    return _.filter(array, _.identity);\n  };\n\n  // Internal implementation of a recursive `flatten` function.\n  var flatten = function(input, shallow, output) {\n    each(input, function(value) {\n      if (_.isArray(value)) {\n        shallow ? push.apply(output, value) : flatten(value, shallow, output);\n      } else {\n        output.push(value);\n      }\n    });\n    return output;\n  };\n\n  // Return a completely flattened version of an array.\n  _.flatten = function(array, shallow) {\n    return flatten(array, shallow, []);\n  };\n\n  // Return a version of the array that does not contain the specified value(s).\n  _.without = function(array) {\n    return _.difference(array, slice.call(arguments, 1));\n  };\n\n  // Produce a duplicate-free version of the array. If the array has already\n  // been sorted, you have the option of using a faster algorithm.\n  // Aliased as `unique`.\n  _.uniq = _.unique = function(array, isSorted, iterator, context) {\n    if (_.isFunction(isSorted)) {\n      context = iterator;\n      iterator = isSorted;\n      isSorted = false;\n    }\n    var initial = iterator ? _.map(array, iterator, context) : array;\n    var results = [];\n    var seen = [];\n    each(initial, function(value, index) {\n      if (isSorted ? (!index || seen[seen.length - 1] !== value) : !_.contains(seen, value)) {\n        seen.push(value);\n        results.push(array[index]);\n      }\n    });\n    return results;\n  };\n\n  // Produce an array that contains the union: each distinct element from all of\n  // the passed-in arrays.\n  _.union = function() {\n    return _.uniq(concat.apply(ArrayProto, arguments));\n  };\n\n  // Produce an array that contains every item shared between all the\n  // passed-in arrays.\n  _.intersection = function(array) {\n    var rest = slice.call(arguments, 1);\n    return _.filter(_.uniq(array), function(item) {\n      return _.every(rest, function(other) {\n        return _.indexOf(other, item) >= 0;\n      });\n    });\n  };\n\n  // Take the difference between one array and a number of other arrays.\n  // Only the elements present in just the first array will remain.\n  _.difference = function(array) {\n    var rest = concat.apply(ArrayProto, slice.call(arguments, 1));\n    return _.filter(array, function(value){ return !_.contains(rest, value); });\n  };\n\n  // Zip together multiple lists into a single array -- elements that share\n  // an index go together.\n  _.zip = function() {\n    var args = slice.call(arguments);\n    var length = _.max(_.pluck(args, 'length'));\n    var results = new Array(length);\n    for (var i = 0; i < length; i++) {\n      results[i] = _.pluck(args, \"\" + i);\n    }\n    return results;\n  };\n\n  // Converts lists into objects. Pass either a single array of `[key, value]`\n  // pairs, or two parallel arrays of the same length -- one of keys, and one of\n  // the corresponding values.\n  _.object = function(list, values) {\n    if (list == null) return {};\n    var result = {};\n    for (var i = 0, l = list.length; i < l; i++) {\n      if (values) {\n        result[list[i]] = values[i];\n      } else {\n        result[list[i][0]] = list[i][1];\n      }\n    }\n    return result;\n  };\n\n  // If the browser doesn't supply us with indexOf (I'm looking at you, **MSIE**),\n  // we need this function. Return the position of the first occurrence of an\n  // item in an array, or -1 if the item is not included in the array.\n  // Delegates to **ECMAScript 5**'s native `indexOf` if available.\n  // If the array is large and already in sort order, pass `true`\n  // for **isSorted** to use binary search.\n  _.indexOf = function(array, item, isSorted) {\n    if (array == null) return -1;\n    var i = 0, l = array.length;\n    if (isSorted) {\n      if (typeof isSorted == 'number') {\n        i = (isSorted < 0 ? Math.max(0, l + isSorted) : isSorted);\n      } else {\n        i = _.sortedIndex(array, item);\n        return array[i] === item ? i : -1;\n      }\n    }\n    if (nativeIndexOf && array.indexOf === nativeIndexOf) return array.indexOf(item, isSorted);\n    for (; i < l; i++) if (array[i] === item) return i;\n    return -1;\n  };\n\n  // Delegates to **ECMAScript 5**'s native `lastIndexOf` if available.\n  _.lastIndexOf = function(array, item, from) {\n    if (array == null) return -1;\n    var hasIndex = from != null;\n    if (nativeLastIndexOf && array.lastIndexOf === nativeLastIndexOf) {\n      return hasIndex ? array.lastIndexOf(item, from) : array.lastIndexOf(item);\n    }\n    var i = (hasIndex ? from : array.length);\n    while (i--) if (array[i] === item) return i;\n    return -1;\n  };\n\n  // Generate an integer Array containing an arithmetic progression. A port of\n  // the native Python `range()` function. See\n  // [the Python documentation](http://docs.python.org/library/functions.html#range).\n  _.range = function(start, stop, step) {\n    if (arguments.length <= 1) {\n      stop = start || 0;\n      start = 0;\n    }\n    step = arguments[2] || 1;\n\n    var len = Math.max(Math.ceil((stop - start) / step), 0);\n    var idx = 0;\n    var range = new Array(len);\n\n    while(idx < len) {\n      range[idx++] = start;\n      start += step;\n    }\n\n    return range;\n  };\n\n  // Function (ahem) Functions\n  // ------------------\n\n  // Create a function bound to a given object (assigning `this`, and arguments,\n  // optionally). Delegates to **ECMAScript 5**'s native `Function.bind` if\n  // available.\n  _.bind = function(func, context) {\n    if (func.bind === nativeBind && nativeBind) return nativeBind.apply(func, slice.call(arguments, 1));\n    var args = slice.call(arguments, 2);\n    return function() {\n      return func.apply(context, args.concat(slice.call(arguments)));\n    };\n  };\n\n  // Partially apply a function by creating a version that has had some of its\n  // arguments pre-filled, without changing its dynamic `this` context.\n  _.partial = function(func) {\n    var args = slice.call(arguments, 1);\n    return function() {\n      return func.apply(this, args.concat(slice.call(arguments)));\n    };\n  };\n\n  // Bind all of an object's methods to that object. Useful for ensuring that\n  // all callbacks defined on an object belong to it.\n  _.bindAll = function(obj) {\n    var funcs = slice.call(arguments, 1);\n    if (funcs.length === 0) funcs = _.functions(obj);\n    each(funcs, function(f) { obj[f] = _.bind(obj[f], obj); });\n    return obj;\n  };\n\n  // Memoize an expensive function by storing its results.\n  _.memoize = function(func, hasher) {\n    var memo = {};\n    hasher || (hasher = _.identity);\n    return function() {\n      var key = hasher.apply(this, arguments);\n      return _.has(memo, key) ? memo[key] : (memo[key] = func.apply(this, arguments));\n    };\n  };\n\n  // Delays a function for the given number of milliseconds, and then calls\n  // it with the arguments supplied.\n  _.delay = function(func, wait) {\n    var args = slice.call(arguments, 2);\n    return setTimeout(function(){ return func.apply(null, args); }, wait);\n  };\n\n  // Defers a function, scheduling it to run after the current call stack has\n  // cleared.\n  _.defer = function(func) {\n    return _.delay.apply(_, [func, 1].concat(slice.call(arguments, 1)));\n  };\n\n  // Returns a function, that, when invoked, will only be triggered at most once\n  // during a given window of time.\n  _.throttle = function(func, wait) {\n    var context, args, timeout, result;\n    var previous = 0;\n    var later = function() {\n      previous = new Date;\n      timeout = null;\n      result = func.apply(context, args);\n    };\n    return function() {\n      var now = new Date;\n      var remaining = wait - (now - previous);\n      context = this;\n      args = arguments;\n      if (remaining <= 0) {\n        clearTimeout(timeout);\n        timeout = null;\n        previous = now;\n        result = func.apply(context, args);\n      } else if (!timeout) {\n        timeout = setTimeout(later, remaining);\n      }\n      return result;\n    };\n  };\n\n  // Returns a function, that, as long as it continues to be invoked, will not\n  // be triggered. The function will be called after it stops being called for\n  // N milliseconds. If `immediate` is passed, trigger the function on the\n  // leading edge, instead of the trailing.\n  _.debounce = function(func, wait, immediate) {\n    var timeout, result;\n    return function() {\n      var context = this, args = arguments;\n      var later = function() {\n        timeout = null;\n        if (!immediate) result = func.apply(context, args);\n      };\n      var callNow = immediate && !timeout;\n      clearTimeout(timeout);\n      timeout = setTimeout(later, wait);\n      if (callNow) result = func.apply(context, args);\n      return result;\n    };\n  };\n\n  // Returns a function that will be executed at most one time, no matter how\n  // often you call it. Useful for lazy initialization.\n  _.once = function(func) {\n    var ran = false, memo;\n    return function() {\n      if (ran) return memo;\n      ran = true;\n      memo = func.apply(this, arguments);\n      func = null;\n      return memo;\n    };\n  };\n\n  // Returns the first function passed as an argument to the second,\n  // allowing you to adjust arguments, run code before and after, and\n  // conditionally execute the original function.\n  _.wrap = function(func, wrapper) {\n    return function() {\n      var args = [func];\n      push.apply(args, arguments);\n      return wrapper.apply(this, args);\n    };\n  };\n\n  // Returns a function that is the composition of a list of functions, each\n  // consuming the return value of the function that follows.\n  _.compose = function() {\n    var funcs = arguments;\n    return function() {\n      var args = arguments;\n      for (var i = funcs.length - 1; i >= 0; i--) {\n        args = [funcs[i].apply(this, args)];\n      }\n      return args[0];\n    };\n  };\n\n  // Returns a function that will only be executed after being called N times.\n  _.after = function(times, func) {\n    if (times <= 0) return func();\n    return function() {\n      if (--times < 1) {\n        return func.apply(this, arguments);\n      }\n    };\n  };\n\n  // Object Functions\n  // ----------------\n\n  // Retrieve the names of an object's properties.\n  // Delegates to **ECMAScript 5**'s native `Object.keys`\n  _.keys = nativeKeys || function(obj) {\n    if (obj !== Object(obj)) throw new TypeError('Invalid object');\n    var keys = [];\n    for (var key in obj) if (_.has(obj, key)) keys[keys.length] = key;\n    return keys;\n  };\n\n  // Retrieve the values of an object's properties.\n  _.values = function(obj) {\n    var values = [];\n    for (var key in obj) if (_.has(obj, key)) values.push(obj[key]);\n    return values;\n  };\n\n  // Convert an object into a list of `[key, value]` pairs.\n  _.pairs = function(obj) {\n    var pairs = [];\n    for (var key in obj) if (_.has(obj, key)) pairs.push([key, obj[key]]);\n    return pairs;\n  };\n\n  // Invert the keys and values of an object. The values must be serializable.\n  _.invert = function(obj) {\n    var result = {};\n    for (var key in obj) if (_.has(obj, key)) result[obj[key]] = key;\n    return result;\n  };\n\n  // Return a sorted list of the function names available on the object.\n  // Aliased as `methods`\n  _.functions = _.methods = function(obj) {\n    var names = [];\n    for (var key in obj) {\n      if (_.isFunction(obj[key])) names.push(key);\n    }\n    return names.sort();\n  };\n\n  // Extend a given object with all the properties in passed-in object(s).\n  _.extend = function(obj) {\n    each(slice.call(arguments, 1), function(source) {\n      if (source) {\n        for (var prop in source) {\n          obj[prop] = source[prop];\n        }\n      }\n    });\n    return obj;\n  };\n\n  // Return a copy of the object only containing the whitelisted properties.\n  _.pick = function(obj) {\n    var copy = {};\n    var keys = concat.apply(ArrayProto, slice.call(arguments, 1));\n    each(keys, function(key) {\n      if (key in obj) copy[key] = obj[key];\n    });\n    return copy;\n  };\n\n   // Return a copy of the object without the blacklisted properties.\n  _.omit = function(obj) {\n    var copy = {};\n    var keys = concat.apply(ArrayProto, slice.call(arguments, 1));\n    for (var key in obj) {\n      if (!_.contains(keys, key)) copy[key] = obj[key];\n    }\n    return copy;\n  };\n\n  // Fill in a given object with default properties.\n  _.defaults = function(obj) {\n    each(slice.call(arguments, 1), function(source) {\n      if (source) {\n        for (var prop in source) {\n          if (obj[prop] == null) obj[prop] = source[prop];\n        }\n      }\n    });\n    return obj;\n  };\n\n  // Create a (shallow-cloned) duplicate of an object.\n  _.clone = function(obj) {\n    if (!_.isObject(obj)) return obj;\n    return _.isArray(obj) ? obj.slice() : _.extend({}, obj);\n  };\n\n  // Invokes interceptor with the obj, and then returns obj.\n  // The primary purpose of this method is to \"tap into\" a method chain, in\n  // order to perform operations on intermediate results within the chain.\n  _.tap = function(obj, interceptor) {\n    interceptor(obj);\n    return obj;\n  };\n\n  // Internal recursive comparison function for `isEqual`.\n  var eq = function(a, b, aStack, bStack) {\n    // Identical objects are equal. `0 === -0`, but they aren't identical.\n    // See the Harmony `egal` proposal: http://wiki.ecmascript.org/doku.php?id=harmony:egal.\n    if (a === b) return a !== 0 || 1 / a == 1 / b;\n    // A strict comparison is necessary because `null == undefined`.\n    if (a == null || b == null) return a === b;\n    // Unwrap any wrapped objects.\n    if (a instanceof _) a = a._wrapped;\n    if (b instanceof _) b = b._wrapped;\n    // Compare `[[Class]]` names.\n    var className = toString.call(a);\n    if (className != toString.call(b)) return false;\n    switch (className) {\n      // Strings, numbers, dates, and booleans are compared by value.\n      case '[object String]':\n        // Primitives and their corresponding object wrappers are equivalent; thus, `\"5\"` is\n        // equivalent to `new String(\"5\")`.\n        return a == String(b);\n      case '[object Number]':\n        // `NaN`s are equivalent, but non-reflexive. An `egal` comparison is performed for\n        // other numeric values.\n        return a != +a ? b != +b : (a == 0 ? 1 / a == 1 / b : a == +b);\n      case '[object Date]':\n      case '[object Boolean]':\n        // Coerce dates and booleans to numeric primitive values. Dates are compared by their\n        // millisecond representations. Note that invalid dates with millisecond representations\n        // of `NaN` are not equivalent.\n        return +a == +b;\n      // RegExps are compared by their source patterns and flags.\n      case '[object RegExp]':\n        return a.source == b.source &&\n               a.global == b.global &&\n               a.multiline == b.multiline &&\n               a.ignoreCase == b.ignoreCase;\n    }\n    if (typeof a != 'object' || typeof b != 'object') return false;\n    // Assume equality for cyclic structures. The algorithm for detecting cyclic\n    // structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.\n    var length = aStack.length;\n    while (length--) {\n      // Linear search. Performance is inversely proportional to the number of\n      // unique nested structures.\n      if (aStack[length] == a) return bStack[length] == b;\n    }\n    // Add the first object to the stack of traversed objects.\n    aStack.push(a);\n    bStack.push(b);\n    var size = 0, result = true;\n    // Recursively compare objects and arrays.\n    if (className == '[object Array]') {\n      // Compare array lengths to determine if a deep comparison is necessary.\n      size = a.length;\n      result = size == b.length;\n      if (result) {\n        // Deep compare the contents, ignoring non-numeric properties.\n        while (size--) {\n          if (!(result = eq(a[size], b[size], aStack, bStack))) break;\n        }\n      }\n    } else {\n      // Objects with different constructors are not equivalent, but `Object`s\n      // from different frames are.\n      var aCtor = a.constructor, bCtor = b.constructor;\n      if (aCtor !== bCtor && !(_.isFunction(aCtor) && (aCtor instanceof aCtor) &&\n                               _.isFunction(bCtor) && (bCtor instanceof bCtor))) {\n        return false;\n      }\n      // Deep compare objects.\n      for (var key in a) {\n        if (_.has(a, key)) {\n          // Count the expected number of properties.\n          size++;\n          // Deep compare each member.\n          if (!(result = _.has(b, key) && eq(a[key], b[key], aStack, bStack))) break;\n        }\n      }\n      // Ensure that both objects contain the same number of properties.\n      if (result) {\n        for (key in b) {\n          if (_.has(b, key) && !(size--)) break;\n        }\n        result = !size;\n      }\n    }\n    // Remove the first object from the stack of traversed objects.\n    aStack.pop();\n    bStack.pop();\n    return result;\n  };\n\n  // Perform a deep comparison to check if two objects are equal.\n  _.isEqual = function(a, b) {\n    return eq(a, b, [], []);\n  };\n\n  // Is a given array, string, or object empty?\n  // An \"empty\" object has no enumerable own-properties.\n  _.isEmpty = function(obj) {\n    if (obj == null) return true;\n    if (_.isArray(obj) || _.isString(obj)) return obj.length === 0;\n    for (var key in obj) if (_.has(obj, key)) return false;\n    return true;\n  };\n\n  // Is a given value a DOM element?\n  _.isElement = function(obj) {\n    return !!(obj && obj.nodeType === 1);\n  };\n\n  // Is a given value an array?\n  // Delegates to ECMA5's native Array.isArray\n  _.isArray = nativeIsArray || function(obj) {\n    return toString.call(obj) == '[object Array]';\n  };\n\n  // Is a given variable an object?\n  _.isObject = function(obj) {\n    return obj === Object(obj);\n  };\n\n  // Add some isType methods: isArguments, isFunction, isString, isNumber, isDate, isRegExp.\n  each(['Arguments', 'Function', 'String', 'Number', 'Date', 'RegExp'], function(name) {\n    _['is' + name] = function(obj) {\n      return toString.call(obj) == '[object ' + name + ']';\n    };\n  });\n\n  // Define a fallback version of the method in browsers (ahem, IE), where\n  // there isn't any inspectable \"Arguments\" type.\n  if (!_.isArguments(arguments)) {\n    _.isArguments = function(obj) {\n      return !!(obj && _.has(obj, 'callee'));\n    };\n  }\n\n  // Optimize `isFunction` if appropriate.\n  if (typeof (/./) !== 'function') {\n    _.isFunction = function(obj) {\n      return typeof obj === 'function';\n    };\n  }\n\n  // Is a given object a finite number?\n  _.isFinite = function(obj) {\n    return isFinite(obj) && !isNaN(parseFloat(obj));\n  };\n\n  // Is the given value `NaN`? (NaN is the only number which does not equal itself).\n  _.isNaN = function(obj) {\n    return _.isNumber(obj) && obj != +obj;\n  };\n\n  // Is a given value a boolean?\n  _.isBoolean = function(obj) {\n    return obj === true || obj === false || toString.call(obj) == '[object Boolean]';\n  };\n\n  // Is a given value equal to null?\n  _.isNull = function(obj) {\n    return obj === null;\n  };\n\n  // Is a given variable undefined?\n  _.isUndefined = function(obj) {\n    return obj === void 0;\n  };\n\n  // Shortcut function for checking if an object has a given property directly\n  // on itself (in other words, not on a prototype).\n  _.has = function(obj, key) {\n    return hasOwnProperty.call(obj, key);\n  };\n\n  // Utility Functions\n  // -----------------\n\n  // Run Underscore.js in *noConflict* mode, returning the `_` variable to its\n  // previous owner. Returns a reference to the Underscore object.\n  _.noConflict = function() {\n    root._ = previousUnderscore;\n    return this;\n  };\n\n  // Keep the identity function around for default iterators.\n  _.identity = function(value) {\n    return value;\n  };\n\n  // Run a function **n** times.\n  _.times = function(n, iterator, context) {\n    var accum = Array(n);\n    for (var i = 0; i < n; i++) accum[i] = iterator.call(context, i);\n    return accum;\n  };\n\n  // Return a random integer between min and max (inclusive).\n  _.random = function(min, max) {\n    if (max == null) {\n      max = min;\n      min = 0;\n    }\n    return min + Math.floor(Math.random() * (max - min + 1));\n  };\n\n  // List of HTML entities for escaping.\n  var entityMap = {\n    escape: {\n      '&': '&amp;',\n      '<': '&lt;',\n      '>': '&gt;',\n      '\"': '&quot;',\n      \"'\": '&#x27;',\n      '/': '&#x2F;'\n    }\n  };\n  entityMap.unescape = _.invert(entityMap.escape);\n\n  // Regexes containing the keys and values listed immediately above.\n  var entityRegexes = {\n    escape:   new RegExp('[' + _.keys(entityMap.escape).join('') + ']', 'g'),\n    unescape: new RegExp('(' + _.keys(entityMap.unescape).join('|') + ')', 'g')\n  };\n\n  // Functions for escaping and unescaping strings to/from HTML interpolation.\n  _.each(['escape', 'unescape'], function(method) {\n    _[method] = function(string) {\n      if (string == null) return '';\n      return ('' + string).replace(entityRegexes[method], function(match) {\n        return entityMap[method][match];\n      });\n    };\n  });\n\n  // If the value of the named property is a function then invoke it;\n  // otherwise, return it.\n  _.result = function(object, property) {\n    if (object == null) return null;\n    var value = object[property];\n    return _.isFunction(value) ? value.call(object) : value;\n  };\n\n  // Add your own custom functions to the Underscore object.\n  _.mixin = function(obj) {\n    each(_.functions(obj), function(name){\n      var func = _[name] = obj[name];\n      _.prototype[name] = function() {\n        var args = [this._wrapped];\n        push.apply(args, arguments);\n        return result.call(this, func.apply(_, args));\n      };\n    });\n  };\n\n  // Generate a unique integer id (unique within the entire client session).\n  // Useful for temporary DOM ids.\n  var idCounter = 0;\n  _.uniqueId = function(prefix) {\n    var id = ++idCounter + '';\n    return prefix ? prefix + id : id;\n  };\n\n  // By default, Underscore uses ERB-style template delimiters, change the\n  // following template settings to use alternative delimiters.\n  _.templateSettings = {\n    evaluate    : /<%([\\s\\S]+?)%>/g,\n    interpolate : /<%=([\\s\\S]+?)%>/g,\n    escape      : /<%-([\\s\\S]+?)%>/g\n  };\n\n  // When customizing `templateSettings`, if you don't want to define an\n  // interpolation, evaluation or escaping regex, we need one that is\n  // guaranteed not to match.\n  var noMatch = /(.)^/;\n\n  // Certain characters need to be escaped so that they can be put into a\n  // string literal.\n  var escapes = {\n    \"'\":      \"'\",\n    '\\\\':     '\\\\',\n    '\\r':     'r',\n    '\\n':     'n',\n    '\\t':     't',\n    '\\u2028': 'u2028',\n    '\\u2029': 'u2029'\n  };\n\n  var escaper = /\\\\|'|\\r|\\n|\\t|\\u2028|\\u2029/g;\n\n  // JavaScript micro-templating, similar to John Resig's implementation.\n  // Underscore templating handles arbitrary delimiters, preserves whitespace,\n  // and correctly escapes quotes within interpolated code.\n  _.template = function(text, data, settings) {\n    var render;\n    settings = _.defaults({}, settings, _.templateSettings);\n\n    // Combine delimiters into one regular expression via alternation.\n    var matcher = new RegExp([\n      (settings.escape || noMatch).source,\n      (settings.interpolate || noMatch).source,\n      (settings.evaluate || noMatch).source\n    ].join('|') + '|$', 'g');\n\n    // Compile the template source, escaping string literals appropriately.\n    var index = 0;\n    var source = \"__p+='\";\n    text.replace(matcher, function(match, escape, interpolate, evaluate, offset) {\n      source += text.slice(index, offset)\n        .replace(escaper, function(match) { return '\\\\' + escapes[match]; });\n\n      if (escape) {\n        source += \"'+\\n((__t=(\" + escape + \"))==null?'':_.escape(__t))+\\n'\";\n      }\n      if (interpolate) {\n        source += \"'+\\n((__t=(\" + interpolate + \"))==null?'':__t)+\\n'\";\n      }\n      if (evaluate) {\n        source += \"';\\n\" + evaluate + \"\\n__p+='\";\n      }\n      index = offset + match.length;\n      return match;\n    });\n    source += \"';\\n\";\n\n    // If a variable is not specified, place data values in local scope.\n    if (!settings.variable) source = 'with(obj||{}){\\n' + source + '}\\n';\n\n    source = \"var __t,__p='',__j=Array.prototype.join,\" +\n      \"print=function(){__p+=__j.call(arguments,'');};\\n\" +\n      source + \"return __p;\\n\";\n\n    try {\n      render = new Function(settings.variable || 'obj', '_', source);\n    } catch (e) {\n      e.source = source;\n      throw e;\n    }\n\n    if (data) return render(data, _);\n    var template = function(data) {\n      return render.call(this, data, _);\n    };\n\n    // Provide the compiled function source as a convenience for precompilation.\n    template.source = 'function(' + (settings.variable || 'obj') + '){\\n' + source + '}';\n\n    return template;\n  };\n\n  // Add a \"chain\" function, which will delegate to the wrapper.\n  _.chain = function(obj) {\n    return _(obj).chain();\n  };\n\n  // OOP\n  // ---------------\n  // If Underscore is called as a function, it returns a wrapped object that\n  // can be used OO-style. This wrapper holds altered versions of all the\n  // underscore functions. Wrapped objects may be chained.\n\n  // Helper function to continue chaining intermediate results.\n  var result = function(obj) {\n    return this._chain ? _(obj).chain() : obj;\n  };\n\n  // Add all of the Underscore functions to the wrapper object.\n  _.mixin(_);\n\n  // Add all mutator Array functions to the wrapper.\n  each(['pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift'], function(name) {\n    var method = ArrayProto[name];\n    _.prototype[name] = function() {\n      var obj = this._wrapped;\n      method.apply(obj, arguments);\n      if ((name == 'shift' || name == 'splice') && obj.length === 0) delete obj[0];\n      return result.call(this, obj);\n    };\n  });\n\n  // Add all accessor Array functions to the wrapper.\n  each(['concat', 'join', 'slice'], function(name) {\n    var method = ArrayProto[name];\n    _.prototype[name] = function() {\n      return result.call(this, method.apply(this._wrapped, arguments));\n    };\n  });\n\n  _.extend(_.prototype, {\n\n    // Start chaining a wrapped Underscore object.\n    chain: function() {\n      this._chain = true;\n      return this;\n    },\n\n    // Extracts the result from a wrapped and chained object.\n    value: function() {\n      return this._wrapped;\n    }\n\n  });\n\n}).call(this);\n","/**\n * Return an array with the numbers from 0 to n-1, in a random order\n */\nfunction getRandomArray (n) {\n  var res, next;\n\n  if (n === 0) { return []; }\n  if (n === 1) { return [0]; }\n\n  res = getRandomArray(n - 1);\n  next = Math.floor(Math.random() * n);\n  res.splice(next, 0, n - 1);   // Add n-1 at a random position in the array\n\n  return res;\n};\nmodule.exports.getRandomArray = getRandomArray;\n\n\n/*\n * Default compareKeys function will work for numbers, strings and dates\n */\nfunction defaultCompareKeysFunction (a, b) {\n  if (a < b) { return -1; }\n  if (a > b) { return 1; }\n  if (a === b) { return 0; }\n\n  var err = new Error(\"Couldn't compare elements\");\n  err.a = a;\n  err.b = b;\n  throw err;\n}\nmodule.exports.defaultCompareKeysFunction = defaultCompareKeysFunction;\n\n\n/**\n * Check whether two values are equal (used in non-unique deletion)\n */\nfunction defaultCheckValueEquality (a, b) {\n  return a === b;\n}\nmodule.exports.defaultCheckValueEquality = defaultCheckValueEquality;\n","/**\n * Simple binary search tree\n */\nvar customUtils = require('./customUtils');\n\n\n/**\n * Constructor\n * @param {Object} options Optional\n * @param {Boolean}  options.unique Whether to enforce a 'unique' constraint on the key or not\n * @param {Key}      options.key Initialize this BST's key with key\n * @param {Value}    options.value Initialize this BST's data with [value]\n * @param {Function} options.compareKeys Initialize this BST's compareKeys\n */\nfunction BinarySearchTree (options) {\n  options = options || {};\n\n  this.left = null;\n  this.right = null;\n  this.parent = options.parent !== undefined ? options.parent : null;\n  if (options.hasOwnProperty('key')) { this.key = options.key; }\n  this.data = options.hasOwnProperty('value') ? [options.value] : [];\n  this.unique = options.unique || false;\n\n  this.compareKeys = options.compareKeys || customUtils.defaultCompareKeysFunction;\n  this.checkValueEquality = options.checkValueEquality || customUtils.defaultCheckValueEquality;\n}\n\n\n// ================================\n// Methods used to test the tree\n// ================================\n\n\n/**\n * Get the descendant with max key\n */\nBinarySearchTree.prototype.getMaxKeyDescendant = function () {\n  if (this.right) {\n    return this.right.getMaxKeyDescendant();\n  } else {\n    return this;\n  }\n};\n\n\n/**\n * Get the maximum key\n */\nBinarySearchTree.prototype.getMaxKey = function () {\n  return this.getMaxKeyDescendant().key;\n};\n\n\n/**\n * Get the descendant with min key\n */\nBinarySearchTree.prototype.getMinKeyDescendant = function () {\n  if (this.left) {\n    return this.left.getMinKeyDescendant()\n  } else {\n    return this;\n  }\n};\n\n\n/**\n * Get the minimum key\n */\nBinarySearchTree.prototype.getMinKey = function () {\n  return this.getMinKeyDescendant().key;\n};\n\n\n/**\n * Check that all nodes (incl. leaves) fullfil condition given by fn\n * test is a function passed every (key, data) and which throws if the condition is not met\n */\nBinarySearchTree.prototype.checkAllNodesFullfillCondition = function (test) {\n  if (!this.hasOwnProperty('key')) { return; }\n\n  test(this.key, this.data);\n  if (this.left) { this.left.checkAllNodesFullfillCondition(test); }\n  if (this.right) { this.right.checkAllNodesFullfillCondition(test); }\n};\n\n\n/**\n * Check that the core BST properties on node ordering are verified\n * Throw if they aren't\n */\nBinarySearchTree.prototype.checkNodeOrdering = function () {\n  var self = this;\n\n  if (!this.hasOwnProperty('key')) { return; }\n\n  if (this.left) {\n    this.left.checkAllNodesFullfillCondition(function (k) {\n      if (self.compareKeys(k, self.key) >= 0) {\n        throw new Error('Tree with root ' + self.key + ' is not a binary search tree');\n      }\n    });\n    this.left.checkNodeOrdering();\n  }\n\n  if (this.right) {\n    this.right.checkAllNodesFullfillCondition(function (k) {\n      if (self.compareKeys(k, self.key) <= 0) {\n        throw new Error('Tree with root ' + self.key + ' is not a binary search tree');\n      }\n    });\n    this.right.checkNodeOrdering();\n  }\n};\n\n\n/**\n * Check that all pointers are coherent in this tree\n */\nBinarySearchTree.prototype.checkInternalPointers = function () {\n  if (this.left) {\n    if (this.left.parent !== this) { throw new Error('Parent pointer broken for key ' + this.key); }\n    this.left.checkInternalPointers();\n  }\n\n  if (this.right) {\n    if (this.right.parent !== this) { throw new Error('Parent pointer broken for key ' + this.key); }\n    this.right.checkInternalPointers();\n  }\n};\n\n\n/**\n * Check that a tree is a BST as defined here (node ordering and pointer references)\n */\nBinarySearchTree.prototype.checkIsBST = function () {\n  this.checkNodeOrdering();\n  this.checkInternalPointers();\n  if (this.parent) { throw new Error(\"The root shouldn't have a parent\"); }\n};\n\n\n/**\n * Get number of keys inserted\n */\nBinarySearchTree.prototype.getNumberOfKeys = function () {\n  var res;\n\n  if (!this.hasOwnProperty('key')) { return 0; }\n\n  res = 1;\n  if (this.left) { res += this.left.getNumberOfKeys(); }\n  if (this.right) { res += this.right.getNumberOfKeys(); }\n\n  return res;\n};\n\n\n\n// ============================================\n// Methods used to actually work on the tree\n// ============================================\n\n/**\n * Create a BST similar (i.e. same options except for key and value) to the current one\n * Use the same constructor (i.e. BinarySearchTree, AVLTree etc)\n * @param {Object} options see constructor\n */\nBinarySearchTree.prototype.createSimilar = function (options) {\n  options = options || {};\n  options.unique = this.unique;\n  options.compareKeys = this.compareKeys;\n  options.checkValueEquality = this.checkValueEquality;\n\n  return new this.constructor(options);\n};\n\n\n/**\n * Create the left child of this BST and return it\n */\nBinarySearchTree.prototype.createLeftChild = function (options) {\n  var leftChild = this.createSimilar(options);\n  leftChild.parent = this;\n  this.left = leftChild;\n\n  return leftChild;\n};\n\n\n/**\n * Create the right child of this BST and return it\n */\nBinarySearchTree.prototype.createRightChild = function (options) {\n  var rightChild = this.createSimilar(options);\n  rightChild.parent = this;\n  this.right = rightChild;\n\n  return rightChild;\n};\n\n\n/**\n * Insert a new element\n */\nBinarySearchTree.prototype.insert = function (key, value) {\n  // Empty tree, insert as root\n  if (!this.hasOwnProperty('key')) {\n    this.key = key;\n    this.data.push(value);\n    return;\n  }\n\n  // Same key as root\n  if (this.compareKeys(this.key, key) === 0) {\n    if (this.unique) {\n      var err = new Error(\"Can't insert key \" + key + \", it violates the unique constraint\");\n      err.key = key;\n      err.errorType = 'uniqueViolated';\n      throw err;\n    } else {\n      this.data.push(value);\n    }\n    return;\n  }\n\n  if (this.compareKeys(key, this.key) < 0) {\n    // Insert in left subtree\n    if (this.left) {\n      this.left.insert(key, value);\n    } else {\n      this.createLeftChild({ key: key, value: value });\n    }\n  } else {\n    // Insert in right subtree\n    if (this.right) {\n      this.right.insert(key, value);\n    } else {\n      this.createRightChild({ key: key, value: value });\n    }\n  }\n};\n\n\n/**\n * Search for all data corresponding to a key\n */\nBinarySearchTree.prototype.search = function (key) {\n  if (!this.hasOwnProperty('key')) { return []; }\n\n  if (this.compareKeys(this.key, key) === 0) { return this.data; }\n\n  if (this.compareKeys(key, this.key) < 0) {\n    if (this.left) {\n      return this.left.search(key);\n    } else {\n      return [];\n    }\n  } else {\n    if (this.right) {\n      return this.right.search(key);\n    } else {\n      return [];\n    }\n  }\n};\n\n\n/**\n * Return a function that tells whether a given key matches a lower bound\n */\nBinarySearchTree.prototype.getLowerBoundMatcher = function (query) {\n  var self = this;\n\n  // No lower bound\n  if (!query.hasOwnProperty('$gt') && !query.hasOwnProperty('$gte')) {\n    return function () { return true; };\n  }\n\n  if (query.hasOwnProperty('$gt') && query.hasOwnProperty('$gte')) {\n    if (self.compareKeys(query.$gte, query.$gt) === 0) {\n      return function (key) { return self.compareKeys(key, query.$gt) > 0; };\n    }\n\n    if (self.compareKeys(query.$gte, query.$gt) > 0) {\n      return function (key) { return self.compareKeys(key, query.$gte) >= 0; };\n    } else {\n      return function (key) { return self.compareKeys(key, query.$gt) > 0; };\n    }\n  }\n\n  if (query.hasOwnProperty('$gt')) {\n    return function (key) { return self.compareKeys(key, query.$gt) > 0; };\n  } else {\n    return function (key) { return self.compareKeys(key, query.$gte) >= 0; };\n  }\n};\n\n\n/**\n * Return a function that tells whether a given key matches an upper bound\n */\nBinarySearchTree.prototype.getUpperBoundMatcher = function (query) {\n  var self = this;\n\n  // No lower bound\n  if (!query.hasOwnProperty('$lt') && !query.hasOwnProperty('$lte')) {\n    return function () { return true; };\n  }\n\n  if (query.hasOwnProperty('$lt') && query.hasOwnProperty('$lte')) {\n    if (self.compareKeys(query.$lte, query.$lt) === 0) {\n      return function (key) { return self.compareKeys(key, query.$lt) < 0; };\n    }\n\n    if (self.compareKeys(query.$lte, query.$lt) < 0) {\n      return function (key) { return self.compareKeys(key, query.$lte) <= 0; };\n    } else {\n      return function (key) { return self.compareKeys(key, query.$lt) < 0; };\n    }\n  }\n\n  if (query.hasOwnProperty('$lt')) {\n    return function (key) { return self.compareKeys(key, query.$lt) < 0; };\n  } else {\n    return function (key) { return self.compareKeys(key, query.$lte) <= 0; };\n  }\n};\n\n\n// Append all elements in toAppend to array\nfunction append (array, toAppend) {\n  var i;\n\n  for (i = 0; i < toAppend.length; i += 1) {\n    array.push(toAppend[i]);\n  }\n}\n\n\n/**\n * Get all data for a key between bounds\n * Return it in key order\n * @param {Object} query Mongo-style query where keys are $lt, $lte, $gt or $gte (other keys are not considered)\n * @param {Functions} lbm/ubm matching functions calculated at the first recursive step\n */\nBinarySearchTree.prototype.betweenBounds = function (query, lbm, ubm) {\n  var res = [];\n\n  if (!this.hasOwnProperty('key')) { return []; }   // Empty tree\n\n  lbm = lbm || this.getLowerBoundMatcher(query);\n  ubm = ubm || this.getUpperBoundMatcher(query);\n\n  if (lbm(this.key) && this.left) { append(res, this.left.betweenBounds(query, lbm, ubm)); }\n  if (lbm(this.key) && ubm(this.key)) { append(res, this.data); }\n  if (ubm(this.key) && this.right) { append(res, this.right.betweenBounds(query, lbm, ubm)); }\n\n  return res;\n};\n\n\n/**\n * Delete the current node if it is a leaf\n * Return true if it was deleted\n */\nBinarySearchTree.prototype.deleteIfLeaf = function () {\n  if (this.left || this.right) { return false; }\n\n  // The leaf is itself a root\n  if (!this.parent) {\n    delete this.key;\n    this.data = [];\n    return true;\n  }\n\n  if (this.parent.left === this) {\n    this.parent.left = null;\n  } else {\n    this.parent.right = null;\n  }\n\n  return true;\n};\n\n\n/**\n * Delete the current node if it has only one child\n * Return true if it was deleted\n */\nBinarySearchTree.prototype.deleteIfOnlyOneChild = function () {\n  var child;\n\n  if (this.left && !this.right) { child = this.left; }\n  if (!this.left && this.right) { child = this.right; }\n  if (!child) { return false; }\n\n  // Root\n  if (!this.parent) {\n    this.key = child.key;\n    this.data = child.data;\n\n    this.left = null;\n    if (child.left) {\n      this.left = child.left;\n      child.left.parent = this;\n    }\n\n    this.right = null;\n    if (child.right) {\n      this.right = child.right;\n      child.right.parent = this;\n    }\n\n    return true;\n  }\n\n  if (this.parent.left === this) {\n    this.parent.left = child;\n    child.parent = this.parent;\n  } else {\n    this.parent.right = child;\n    child.parent = this.parent;\n  }\n\n  return true;\n};\n\n\n/**\n * Delete a key or just a value\n * @param {Key} key\n * @param {Value} value Optional. If not set, the whole key is deleted. If set, only this value is deleted\n */\nBinarySearchTree.prototype.delete = function (key, value) {\n  var newData = [], replaceWith\n    , self = this\n    ;\n\n  if (!this.hasOwnProperty('key')) { return; }\n\n  if (this.compareKeys(key, this.key) < 0) {\n    if (this.left) { this.left.delete(key, value); }\n    return;\n  }\n\n  if (this.compareKeys(key, this.key) > 0) {\n    if (this.right) { this.right.delete(key, value); }\n    return;\n  }\n\n  if (!this.compareKeys(key, this.key) === 0) { return; }\n\n  // Delete only a value\n  if (this.data.length > 1 && value !== undefined) {\n    this.data.forEach(function (d) {\n      if (!self.checkValueEquality(d, value)) { newData.push(d); }\n    });\n    self.data = newData;\n    return;\n  }\n\n  // Delete the whole node\n  if (this.deleteIfLeaf()) {\n    return;\n  }\n  if (this.deleteIfOnlyOneChild()) {\n    return;\n  }\n\n  // We are in the case where the node to delete has two children\n  if (Math.random() >= 0.5) {   // Randomize replacement to avoid unbalancing the tree too much\n    // Use the in-order predecessor\n    replaceWith = this.left.getMaxKeyDescendant();\n\n    this.key = replaceWith.key;\n    this.data = replaceWith.data;\n\n    if (this === replaceWith.parent) {   // Special case\n      this.left = replaceWith.left;\n      if (replaceWith.left) { replaceWith.left.parent = replaceWith.parent; }\n    } else {\n      replaceWith.parent.right = replaceWith.left;\n      if (replaceWith.left) { replaceWith.left.parent = replaceWith.parent; }\n    }\n  } else {\n    // Use the in-order successor\n    replaceWith = this.right.getMinKeyDescendant();\n\n    this.key = replaceWith.key;\n    this.data = replaceWith.data;\n\n    if (this === replaceWith.parent) {   // Special case\n      this.right = replaceWith.right;\n      if (replaceWith.right) { replaceWith.right.parent = replaceWith.parent; }\n    } else {\n      replaceWith.parent.left = replaceWith.right;\n      if (replaceWith.right) { replaceWith.right.parent = replaceWith.parent; }\n    }\n  }\n};\n\n\n/**\n * Execute a function on every node of the tree, in key order\n * @param {Function} fn Signature: node. Most useful will probably be node.key and node.data\n */\nBinarySearchTree.prototype.executeOnEveryNode = function (fn) {\n  if (this.left) { this.left.executeOnEveryNode(fn); }\n  fn(this);\n  if (this.right) { this.right.executeOnEveryNode(fn); }\n};\n\n\n/**\n * Pretty print a tree\n * @param {Boolean} printData To print the nodes' data along with the key\n */\nBinarySearchTree.prototype.prettyPrint = function (printData, spacing) {\n  spacing = spacing || \"\";\n\n  console.log(spacing + \"* \" + this.key);\n  if (printData) { console.log(spacing + \"* \" + this.data); }\n\n  if (!this.left && !this.right) { return; }\n\n  if (this.left) {\n    this.left.prettyPrint(printData, spacing + \"  \");\n  } else {\n    console.log(spacing + \"  *\");\n  }\n  if (this.right) {\n    this.right.prettyPrint(printData, spacing + \"  \");\n  } else {\n    console.log(spacing + \"  *\");\n  }\n};\n\n\n\n\n// Interface\nmodule.exports = BinarySearchTree;\n","/*global setImmediate: false, setTimeout: false, console: false */\n(function () {\n\n    var async = {};\n\n    // global on the server, window in the browser\n    var root, previous_async;\n\n    root = this;\n    if (root != null) {\n      previous_async = root.async;\n    }\n\n    async.noConflict = function () {\n        root.async = previous_async;\n        return async;\n    };\n\n    function only_once(fn) {\n        var called = false;\n        return function() {\n            if (called) throw new Error(\"Callback was already called.\");\n            called = true;\n            fn.apply(root, arguments);\n        }\n    }\n\n    //// cross-browser compatiblity functions ////\n\n    var _each = function (arr, iterator) {\n        if (arr.forEach) {\n            return arr.forEach(iterator);\n        }\n        for (var i = 0; i < arr.length; i += 1) {\n            iterator(arr[i], i, arr);\n        }\n    };\n\n    var _map = function (arr, iterator) {\n        if (arr.map) {\n            return arr.map(iterator);\n        }\n        var results = [];\n        _each(arr, function (x, i, a) {\n            results.push(iterator(x, i, a));\n        });\n        return results;\n    };\n\n    var _reduce = function (arr, iterator, memo) {\n        if (arr.reduce) {\n            return arr.reduce(iterator, memo);\n        }\n        _each(arr, function (x, i, a) {\n            memo = iterator(memo, x, i, a);\n        });\n        return memo;\n    };\n\n    var _keys = function (obj) {\n        if (Object.keys) {\n            return Object.keys(obj);\n        }\n        var keys = [];\n        for (var k in obj) {\n            if (obj.hasOwnProperty(k)) {\n                keys.push(k);\n            }\n        }\n        return keys;\n    };\n\n    //// exported async module functions ////\n\n    //// nextTick implementation with browser-compatible fallback ////\n    if (typeof process === 'undefined' || !(process.nextTick)) {\n        if (typeof setImmediate === 'function') {\n            async.nextTick = function (fn) {\n                // not a direct alias for IE10 compatibility\n                setImmediate(fn);\n            };\n            async.setImmediate = async.nextTick;\n        }\n        else {\n            async.nextTick = function (fn) {\n                setTimeout(fn, 0);\n            };\n            async.setImmediate = async.nextTick;\n        }\n    }\n    else {\n        async.nextTick = process.nextTick;\n        if (typeof setImmediate !== 'undefined') {\n            async.setImmediate = function (fn) {\n              // not a direct alias for IE10 compatibility\n              setImmediate(fn);\n            };\n        }\n        else {\n            async.setImmediate = async.nextTick;\n        }\n    }\n\n    async.each = function (arr, iterator, callback) {\n        callback = callback || function () {};\n        if (!arr.length) {\n            return callback();\n        }\n        var completed = 0;\n        _each(arr, function (x) {\n            iterator(x, only_once(function (err) {\n                if (err) {\n                    callback(err);\n                    callback = function () {};\n                }\n                else {\n                    completed += 1;\n                    if (completed >= arr.length) {\n                        callback(null);\n                    }\n                }\n            }));\n        });\n    };\n    async.forEach = async.each;\n\n    async.eachSeries = function (arr, iterator, callback) {\n        callback = callback || function () {};\n        if (!arr.length) {\n            return callback();\n        }\n        var completed = 0;\n        var iterate = function () {\n            iterator(arr[completed], function (err) {\n                if (err) {\n                    callback(err);\n                    callback = function () {};\n                }\n                else {\n                    completed += 1;\n                    if (completed >= arr.length) {\n                        callback(null);\n                    }\n                    else {\n                        iterate();\n                    }\n                }\n            });\n        };\n        iterate();\n    };\n    async.forEachSeries = async.eachSeries;\n\n    async.eachLimit = function (arr, limit, iterator, callback) {\n        var fn = _eachLimit(limit);\n        fn.apply(null, [arr, iterator, callback]);\n    };\n    async.forEachLimit = async.eachLimit;\n\n    var _eachLimit = function (limit) {\n\n        return function (arr, iterator, callback) {\n            callback = callback || function () {};\n            if (!arr.length || limit <= 0) {\n                return callback();\n            }\n            var completed = 0;\n            var started = 0;\n            var running = 0;\n\n            (function replenish () {\n                if (completed >= arr.length) {\n                    return callback();\n                }\n\n                while (running < limit && started < arr.length) {\n                    started += 1;\n                    running += 1;\n                    iterator(arr[started - 1], function (err) {\n                        if (err) {\n                            callback(err);\n                            callback = function () {};\n                        }\n                        else {\n                            completed += 1;\n                            running -= 1;\n                            if (completed >= arr.length) {\n                                callback();\n                            }\n                            else {\n                                replenish();\n                            }\n                        }\n                    });\n                }\n            })();\n        };\n    };\n\n\n    var doParallel = function (fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [async.each].concat(args));\n        };\n    };\n    var doParallelLimit = function(limit, fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [_eachLimit(limit)].concat(args));\n        };\n    };\n    var doSeries = function (fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [async.eachSeries].concat(args));\n        };\n    };\n\n\n    var _asyncMap = function (eachfn, arr, iterator, callback) {\n        var results = [];\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        eachfn(arr, function (x, callback) {\n            iterator(x.value, function (err, v) {\n                results[x.index] = v;\n                callback(err);\n            });\n        }, function (err) {\n            callback(err, results);\n        });\n    };\n    async.map = doParallel(_asyncMap);\n    async.mapSeries = doSeries(_asyncMap);\n    async.mapLimit = function (arr, limit, iterator, callback) {\n        return _mapLimit(limit)(arr, iterator, callback);\n    };\n\n    var _mapLimit = function(limit) {\n        return doParallelLimit(limit, _asyncMap);\n    };\n\n    // reduce only has a series version, as doing reduce in parallel won't\n    // work in many situations.\n    async.reduce = function (arr, memo, iterator, callback) {\n        async.eachSeries(arr, function (x, callback) {\n            iterator(memo, x, function (err, v) {\n                memo = v;\n                callback(err);\n            });\n        }, function (err) {\n            callback(err, memo);\n        });\n    };\n    // inject alias\n    async.inject = async.reduce;\n    // foldl alias\n    async.foldl = async.reduce;\n\n    async.reduceRight = function (arr, memo, iterator, callback) {\n        var reversed = _map(arr, function (x) {\n            return x;\n        }).reverse();\n        async.reduce(reversed, memo, iterator, callback);\n    };\n    // foldr alias\n    async.foldr = async.reduceRight;\n\n    var _filter = function (eachfn, arr, iterator, callback) {\n        var results = [];\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        eachfn(arr, function (x, callback) {\n            iterator(x.value, function (v) {\n                if (v) {\n                    results.push(x);\n                }\n                callback();\n            });\n        }, function (err) {\n            callback(_map(results.sort(function (a, b) {\n                return a.index - b.index;\n            }), function (x) {\n                return x.value;\n            }));\n        });\n    };\n    async.filter = doParallel(_filter);\n    async.filterSeries = doSeries(_filter);\n    // select alias\n    async.select = async.filter;\n    async.selectSeries = async.filterSeries;\n\n    var _reject = function (eachfn, arr, iterator, callback) {\n        var results = [];\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        eachfn(arr, function (x, callback) {\n            iterator(x.value, function (v) {\n                if (!v) {\n                    results.push(x);\n                }\n                callback();\n            });\n        }, function (err) {\n            callback(_map(results.sort(function (a, b) {\n                return a.index - b.index;\n            }), function (x) {\n                return x.value;\n            }));\n        });\n    };\n    async.reject = doParallel(_reject);\n    async.rejectSeries = doSeries(_reject);\n\n    var _detect = function (eachfn, arr, iterator, main_callback) {\n        eachfn(arr, function (x, callback) {\n            iterator(x, function (result) {\n                if (result) {\n                    main_callback(x);\n                    main_callback = function () {};\n                }\n                else {\n                    callback();\n                }\n            });\n        }, function (err) {\n            main_callback();\n        });\n    };\n    async.detect = doParallel(_detect);\n    async.detectSeries = doSeries(_detect);\n\n    async.some = function (arr, iterator, main_callback) {\n        async.each(arr, function (x, callback) {\n            iterator(x, function (v) {\n                if (v) {\n                    main_callback(true);\n                    main_callback = function () {};\n                }\n                callback();\n            });\n        }, function (err) {\n            main_callback(false);\n        });\n    };\n    // any alias\n    async.any = async.some;\n\n    async.every = function (arr, iterator, main_callback) {\n        async.each(arr, function (x, callback) {\n            iterator(x, function (v) {\n                if (!v) {\n                    main_callback(false);\n                    main_callback = function () {};\n                }\n                callback();\n            });\n        }, function (err) {\n            main_callback(true);\n        });\n    };\n    // all alias\n    async.all = async.every;\n\n    async.sortBy = function (arr, iterator, callback) {\n        async.map(arr, function (x, callback) {\n            iterator(x, function (err, criteria) {\n                if (err) {\n                    callback(err);\n                }\n                else {\n                    callback(null, {value: x, criteria: criteria});\n                }\n            });\n        }, function (err, results) {\n            if (err) {\n                return callback(err);\n            }\n            else {\n                var fn = function (left, right) {\n                    var a = left.criteria, b = right.criteria;\n                    return a < b ? -1 : a > b ? 1 : 0;\n                };\n                callback(null, _map(results.sort(fn), function (x) {\n                    return x.value;\n                }));\n            }\n        });\n    };\n\n    async.auto = function (tasks, callback) {\n        callback = callback || function () {};\n        var keys = _keys(tasks);\n        if (!keys.length) {\n            return callback(null);\n        }\n\n        var results = {};\n\n        var listeners = [];\n        var addListener = function (fn) {\n            listeners.unshift(fn);\n        };\n        var removeListener = function (fn) {\n            for (var i = 0; i < listeners.length; i += 1) {\n                if (listeners[i] === fn) {\n                    listeners.splice(i, 1);\n                    return;\n                }\n            }\n        };\n        var taskComplete = function () {\n            _each(listeners.slice(0), function (fn) {\n                fn();\n            });\n        };\n\n        addListener(function () {\n            if (_keys(results).length === keys.length) {\n                callback(null, results);\n                callback = function () {};\n            }\n        });\n\n        _each(keys, function (k) {\n            var task = (tasks[k] instanceof Function) ? [tasks[k]]: tasks[k];\n            var taskCallback = function (err) {\n                var args = Array.prototype.slice.call(arguments, 1);\n                if (args.length <= 1) {\n                    args = args[0];\n                }\n                if (err) {\n                    var safeResults = {};\n                    _each(_keys(results), function(rkey) {\n                        safeResults[rkey] = results[rkey];\n                    });\n                    safeResults[k] = args;\n                    callback(err, safeResults);\n                    // stop subsequent errors hitting callback multiple times\n                    callback = function () {};\n                }\n                else {\n                    results[k] = args;\n                    async.setImmediate(taskComplete);\n                }\n            };\n            var requires = task.slice(0, Math.abs(task.length - 1)) || [];\n            var ready = function () {\n                return _reduce(requires, function (a, x) {\n                    return (a && results.hasOwnProperty(x));\n                }, true) && !results.hasOwnProperty(k);\n            };\n            if (ready()) {\n                task[task.length - 1](taskCallback, results);\n            }\n            else {\n                var listener = function () {\n                    if (ready()) {\n                        removeListener(listener);\n                        task[task.length - 1](taskCallback, results);\n                    }\n                };\n                addListener(listener);\n            }\n        });\n    };\n\n    async.waterfall = function (tasks, callback) {\n        callback = callback || function () {};\n        if (tasks.constructor !== Array) {\n          var err = new Error('First argument to waterfall must be an array of functions');\n          return callback(err);\n        }\n        if (!tasks.length) {\n            return callback();\n        }\n        var wrapIterator = function (iterator) {\n            return function (err) {\n                if (err) {\n                    callback.apply(null, arguments);\n                    callback = function () {};\n                }\n                else {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    var next = iterator.next();\n                    if (next) {\n                        args.push(wrapIterator(next));\n                    }\n                    else {\n                        args.push(callback);\n                    }\n                    async.setImmediate(function () {\n                        iterator.apply(null, args);\n                    });\n                }\n            };\n        };\n        wrapIterator(async.iterator(tasks))();\n    };\n\n    var _parallel = function(eachfn, tasks, callback) {\n        callback = callback || function () {};\n        if (tasks.constructor === Array) {\n            eachfn.map(tasks, function (fn, callback) {\n                if (fn) {\n                    fn(function (err) {\n                        var args = Array.prototype.slice.call(arguments, 1);\n                        if (args.length <= 1) {\n                            args = args[0];\n                        }\n                        callback.call(null, err, args);\n                    });\n                }\n            }, callback);\n        }\n        else {\n            var results = {};\n            eachfn.each(_keys(tasks), function (k, callback) {\n                tasks[k](function (err) {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    if (args.length <= 1) {\n                        args = args[0];\n                    }\n                    results[k] = args;\n                    callback(err);\n                });\n            }, function (err) {\n                callback(err, results);\n            });\n        }\n    };\n\n    async.parallel = function (tasks, callback) {\n        _parallel({ map: async.map, each: async.each }, tasks, callback);\n    };\n\n    async.parallelLimit = function(tasks, limit, callback) {\n        _parallel({ map: _mapLimit(limit), each: _eachLimit(limit) }, tasks, callback);\n    };\n\n    async.series = function (tasks, callback) {\n        callback = callback || function () {};\n        if (tasks.constructor === Array) {\n            async.mapSeries(tasks, function (fn, callback) {\n                if (fn) {\n                    fn(function (err) {\n                        var args = Array.prototype.slice.call(arguments, 1);\n                        if (args.length <= 1) {\n                            args = args[0];\n                        }\n                        callback.call(null, err, args);\n                    });\n                }\n            }, callback);\n        }\n        else {\n            var results = {};\n            async.eachSeries(_keys(tasks), function (k, callback) {\n                tasks[k](function (err) {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    if (args.length <= 1) {\n                        args = args[0];\n                    }\n                    results[k] = args;\n                    callback(err);\n                });\n            }, function (err) {\n                callback(err, results);\n            });\n        }\n    };\n\n    async.iterator = function (tasks) {\n        var makeCallback = function (index) {\n            var fn = function () {\n                if (tasks.length) {\n                    tasks[index].apply(null, arguments);\n                }\n                return fn.next();\n            };\n            fn.next = function () {\n                return (index < tasks.length - 1) ? makeCallback(index + 1): null;\n            };\n            return fn;\n        };\n        return makeCallback(0);\n    };\n\n    async.apply = function (fn) {\n        var args = Array.prototype.slice.call(arguments, 1);\n        return function () {\n            return fn.apply(\n                null, args.concat(Array.prototype.slice.call(arguments))\n            );\n        };\n    };\n\n    var _concat = function (eachfn, arr, fn, callback) {\n        var r = [];\n        eachfn(arr, function (x, cb) {\n            fn(x, function (err, y) {\n                r = r.concat(y || []);\n                cb(err);\n            });\n        }, function (err) {\n            callback(err, r);\n        });\n    };\n    async.concat = doParallel(_concat);\n    async.concatSeries = doSeries(_concat);\n\n    async.whilst = function (test, iterator, callback) {\n        if (test()) {\n            iterator(function (err) {\n                if (err) {\n                    return callback(err);\n                }\n                async.whilst(test, iterator, callback);\n            });\n        }\n        else {\n            callback();\n        }\n    };\n\n    async.doWhilst = function (iterator, test, callback) {\n        iterator(function (err) {\n            if (err) {\n                return callback(err);\n            }\n            if (test()) {\n                async.doWhilst(iterator, test, callback);\n            }\n            else {\n                callback();\n            }\n        });\n    };\n\n    async.until = function (test, iterator, callback) {\n        if (!test()) {\n            iterator(function (err) {\n                if (err) {\n                    return callback(err);\n                }\n                async.until(test, iterator, callback);\n            });\n        }\n        else {\n            callback();\n        }\n    };\n\n    async.doUntil = function (iterator, test, callback) {\n        iterator(function (err) {\n            if (err) {\n                return callback(err);\n            }\n            if (!test()) {\n                async.doUntil(iterator, test, callback);\n            }\n            else {\n                callback();\n            }\n        });\n    };\n\n    async.queue = function (worker, concurrency) {\n        if (concurrency === undefined) {\n            concurrency = 1;\n        }\n        function _insert(q, data, pos, callback) {\n          if(data.constructor !== Array) {\n              data = [data];\n          }\n          _each(data, function(task) {\n              var item = {\n                  data: task,\n                  callback: typeof callback === 'function' ? callback : null\n              };\n\n              if (pos) {\n                q.tasks.unshift(item);\n              } else {\n                q.tasks.push(item);\n              }\n\n              if (q.saturated && q.tasks.length === concurrency) {\n                  q.saturated();\n              }\n              async.setImmediate(q.process);\n          });\n        }\n\n        var workers = 0;\n        var q = {\n            tasks: [],\n            concurrency: concurrency,\n            saturated: null,\n            empty: null,\n            drain: null,\n            push: function (data, callback) {\n              _insert(q, data, false, callback);\n            },\n            unshift: function (data, callback) {\n              _insert(q, data, true, callback);\n            },\n            process: function () {\n                if (workers < q.concurrency && q.tasks.length) {\n                    var task = q.tasks.shift();\n                    if (q.empty && q.tasks.length === 0) {\n                        q.empty();\n                    }\n                    workers += 1;\n                    var next = function () {\n                        workers -= 1;\n                        if (task.callback) {\n                            task.callback.apply(task, arguments);\n                        }\n                        if (q.drain && q.tasks.length + workers === 0) {\n                            q.drain();\n                        }\n                        q.process();\n                    };\n                    var cb = only_once(next);\n                    worker(task.data, cb);\n                }\n            },\n            length: function () {\n                return q.tasks.length;\n            },\n            running: function () {\n                return workers;\n            }\n        };\n        return q;\n    };\n\n    async.cargo = function (worker, payload) {\n        var working     = false,\n            tasks       = [];\n\n        var cargo = {\n            tasks: tasks,\n            payload: payload,\n            saturated: null,\n            empty: null,\n            drain: null,\n            push: function (data, callback) {\n                if(data.constructor !== Array) {\n                    data = [data];\n                }\n                _each(data, function(task) {\n                    tasks.push({\n                        data: task,\n                        callback: typeof callback === 'function' ? callback : null\n                    });\n                    if (cargo.saturated && tasks.length === payload) {\n                        cargo.saturated();\n                    }\n                });\n                async.setImmediate(cargo.process);\n            },\n            process: function process() {\n                if (working) return;\n                if (tasks.length === 0) {\n                    if(cargo.drain) cargo.drain();\n                    return;\n                }\n\n                var ts = typeof payload === 'number'\n                            ? tasks.splice(0, payload)\n                            : tasks.splice(0);\n\n                var ds = _map(ts, function (task) {\n                    return task.data;\n                });\n\n                if(cargo.empty) cargo.empty();\n                working = true;\n                worker(ds, function () {\n                    working = false;\n\n                    var args = arguments;\n                    _each(ts, function (data) {\n                        if (data.callback) {\n                            data.callback.apply(null, args);\n                        }\n                    });\n\n                    process();\n                });\n            },\n            length: function () {\n                return tasks.length;\n            },\n            running: function () {\n                return working;\n            }\n        };\n        return cargo;\n    };\n\n    var _console_fn = function (name) {\n        return function (fn) {\n            var args = Array.prototype.slice.call(arguments, 1);\n            fn.apply(null, args.concat([function (err) {\n                var args = Array.prototype.slice.call(arguments, 1);\n                if (typeof console !== 'undefined') {\n                    if (err) {\n                        if (console.error) {\n                            console.error(err);\n                        }\n                    }\n                    else if (console[name]) {\n                        _each(args, function (x) {\n                            console[name](x);\n                        });\n                    }\n                }\n            }]));\n        };\n    };\n    async.log = _console_fn('log');\n    async.dir = _console_fn('dir');\n    /*async.info = _console_fn('info');\n    async.warn = _console_fn('warn');\n    async.error = _console_fn('error');*/\n\n    async.memoize = function (fn, hasher) {\n        var memo = {};\n        var queues = {};\n        hasher = hasher || function (x) {\n            return x;\n        };\n        var memoized = function () {\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop();\n            var key = hasher.apply(null, args);\n            if (key in memo) {\n                callback.apply(null, memo[key]);\n            }\n            else if (key in queues) {\n                queues[key].push(callback);\n            }\n            else {\n                queues[key] = [callback];\n                fn.apply(null, args.concat([function () {\n                    memo[key] = arguments;\n                    var q = queues[key];\n                    delete queues[key];\n                    for (var i = 0, l = q.length; i < l; i++) {\n                      q[i].apply(null, arguments);\n                    }\n                }]));\n            }\n        };\n        memoized.memo = memo;\n        memoized.unmemoized = fn;\n        return memoized;\n    };\n\n    async.unmemoize = function (fn) {\n      return function () {\n        return (fn.unmemoized || fn).apply(null, arguments);\n      };\n    };\n\n    async.times = function (count, iterator, callback) {\n        var counter = [];\n        for (var i = 0; i < count; i++) {\n            counter.push(i);\n        }\n        return async.map(counter, iterator, callback);\n    };\n\n    async.timesSeries = function (count, iterator, callback) {\n        var counter = [];\n        for (var i = 0; i < count; i++) {\n            counter.push(i);\n        }\n        return async.mapSeries(counter, iterator, callback);\n    };\n\n    async.compose = function (/* functions... */) {\n        var fns = Array.prototype.reverse.call(arguments);\n        return function () {\n            var that = this;\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop();\n            async.reduce(fns, args, function (newargs, fn, cb) {\n                fn.apply(that, newargs.concat([function () {\n                    var err = arguments[0];\n                    var nextargs = Array.prototype.slice.call(arguments, 1);\n                    cb(err, nextargs);\n                }]))\n            },\n            function (err, results) {\n                callback.apply(that, [err].concat(results));\n            });\n        };\n    };\n\n    var _applyEach = function (eachfn, fns /*args...*/) {\n        var go = function () {\n            var that = this;\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop();\n            return eachfn(fns, function (fn, cb) {\n                fn.apply(that, args.concat([cb]));\n            },\n            callback);\n        };\n        if (arguments.length > 2) {\n            var args = Array.prototype.slice.call(arguments, 2);\n            return go.apply(this, args);\n        }\n        else {\n            return go;\n        }\n    };\n    async.applyEach = doParallel(_applyEach);\n    async.applyEachSeries = doSeries(_applyEach);\n\n    async.forever = function (fn, callback) {\n        function next(err) {\n            if (err) {\n                if (callback) {\n                    return callback(err);\n                }\n                throw err;\n            }\n            fn(next);\n        }\n        next();\n    };\n\n    // AMD / RequireJS\n    if (typeof define !== 'undefined' && define.amd) {\n        define([], function () {\n            return async;\n        });\n    }\n    // Node.js\n    else if (typeof module !== 'undefined' && module.exports) {\n        module.exports = async;\n    }\n    // included directly via <script> tag\n    else {\n        root.async = async;\n    }\n\n}());\n","/*!\n    localForage -- Offline Storage, Improved\n    Version 1.7.3\n    https://localforage.github.io/localForage\n    (c) 2013-2017 Mozilla, Apache License 2.0\n*/\n(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.localforage = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw (f.code=\"MODULE_NOT_FOUND\", f)}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n(function (global){\n'use strict';\nvar Mutation = global.MutationObserver || global.WebKitMutationObserver;\n\nvar scheduleDrain;\n\n{\n  if (Mutation) {\n    var called = 0;\n    var observer = new Mutation(nextTick);\n    var element = global.document.createTextNode('');\n    observer.observe(element, {\n      characterData: true\n    });\n    scheduleDrain = function () {\n      element.data = (called = ++called % 2);\n    };\n  } else if (!global.setImmediate && typeof global.MessageChannel !== 'undefined') {\n    var channel = new global.MessageChannel();\n    channel.port1.onmessage = nextTick;\n    scheduleDrain = function () {\n      channel.port2.postMessage(0);\n    };\n  } else if ('document' in global && 'onreadystatechange' in global.document.createElement('script')) {\n    scheduleDrain = function () {\n\n      // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n      // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n      var scriptEl = global.document.createElement('script');\n      scriptEl.onreadystatechange = function () {\n        nextTick();\n\n        scriptEl.onreadystatechange = null;\n        scriptEl.parentNode.removeChild(scriptEl);\n        scriptEl = null;\n      };\n      global.document.documentElement.appendChild(scriptEl);\n    };\n  } else {\n    scheduleDrain = function () {\n      setTimeout(nextTick, 0);\n    };\n  }\n}\n\nvar draining;\nvar queue = [];\n//named nextTick for less confusing stack traces\nfunction nextTick() {\n  draining = true;\n  var i, oldQueue;\n  var len = queue.length;\n  while (len) {\n    oldQueue = queue;\n    queue = [];\n    i = -1;\n    while (++i < len) {\n      oldQueue[i]();\n    }\n    len = queue.length;\n  }\n  draining = false;\n}\n\nmodule.exports = immediate;\nfunction immediate(task) {\n  if (queue.push(task) === 1 && !draining) {\n    scheduleDrain();\n  }\n}\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}],2:[function(_dereq_,module,exports){\n'use strict';\nvar immediate = _dereq_(1);\n\n/* istanbul ignore next */\nfunction INTERNAL() {}\n\nvar handlers = {};\n\nvar REJECTED = ['REJECTED'];\nvar FULFILLED = ['FULFILLED'];\nvar PENDING = ['PENDING'];\n\nmodule.exports = Promise;\n\nfunction Promise(resolver) {\n  if (typeof resolver !== 'function') {\n    throw new TypeError('resolver must be a function');\n  }\n  this.state = PENDING;\n  this.queue = [];\n  this.outcome = void 0;\n  if (resolver !== INTERNAL) {\n    safelyResolveThenable(this, resolver);\n  }\n}\n\nPromise.prototype[\"catch\"] = function (onRejected) {\n  return this.then(null, onRejected);\n};\nPromise.prototype.then = function (onFulfilled, onRejected) {\n  if (typeof onFulfilled !== 'function' && this.state === FULFILLED ||\n    typeof onRejected !== 'function' && this.state === REJECTED) {\n    return this;\n  }\n  var promise = new this.constructor(INTERNAL);\n  if (this.state !== PENDING) {\n    var resolver = this.state === FULFILLED ? onFulfilled : onRejected;\n    unwrap(promise, resolver, this.outcome);\n  } else {\n    this.queue.push(new QueueItem(promise, onFulfilled, onRejected));\n  }\n\n  return promise;\n};\nfunction QueueItem(promise, onFulfilled, onRejected) {\n  this.promise = promise;\n  if (typeof onFulfilled === 'function') {\n    this.onFulfilled = onFulfilled;\n    this.callFulfilled = this.otherCallFulfilled;\n  }\n  if (typeof onRejected === 'function') {\n    this.onRejected = onRejected;\n    this.callRejected = this.otherCallRejected;\n  }\n}\nQueueItem.prototype.callFulfilled = function (value) {\n  handlers.resolve(this.promise, value);\n};\nQueueItem.prototype.otherCallFulfilled = function (value) {\n  unwrap(this.promise, this.onFulfilled, value);\n};\nQueueItem.prototype.callRejected = function (value) {\n  handlers.reject(this.promise, value);\n};\nQueueItem.prototype.otherCallRejected = function (value) {\n  unwrap(this.promise, this.onRejected, value);\n};\n\nfunction unwrap(promise, func, value) {\n  immediate(function () {\n    var returnValue;\n    try {\n      returnValue = func(value);\n    } catch (e) {\n      return handlers.reject(promise, e);\n    }\n    if (returnValue === promise) {\n      handlers.reject(promise, new TypeError('Cannot resolve promise with itself'));\n    } else {\n      handlers.resolve(promise, returnValue);\n    }\n  });\n}\n\nhandlers.resolve = function (self, value) {\n  var result = tryCatch(getThen, value);\n  if (result.status === 'error') {\n    return handlers.reject(self, result.value);\n  }\n  var thenable = result.value;\n\n  if (thenable) {\n    safelyResolveThenable(self, thenable);\n  } else {\n    self.state = FULFILLED;\n    self.outcome = value;\n    var i = -1;\n    var len = self.queue.length;\n    while (++i < len) {\n      self.queue[i].callFulfilled(value);\n    }\n  }\n  return self;\n};\nhandlers.reject = function (self, error) {\n  self.state = REJECTED;\n  self.outcome = error;\n  var i = -1;\n  var len = self.queue.length;\n  while (++i < len) {\n    self.queue[i].callRejected(error);\n  }\n  return self;\n};\n\nfunction getThen(obj) {\n  // Make sure we only access the accessor once as required by the spec\n  var then = obj && obj.then;\n  if (obj && (typeof obj === 'object' || typeof obj === 'function') && typeof then === 'function') {\n    return function appyThen() {\n      then.apply(obj, arguments);\n    };\n  }\n}\n\nfunction safelyResolveThenable(self, thenable) {\n  // Either fulfill, reject or reject with error\n  var called = false;\n  function onError(value) {\n    if (called) {\n      return;\n    }\n    called = true;\n    handlers.reject(self, value);\n  }\n\n  function onSuccess(value) {\n    if (called) {\n      return;\n    }\n    called = true;\n    handlers.resolve(self, value);\n  }\n\n  function tryToUnwrap() {\n    thenable(onSuccess, onError);\n  }\n\n  var result = tryCatch(tryToUnwrap);\n  if (result.status === 'error') {\n    onError(result.value);\n  }\n}\n\nfunction tryCatch(func, value) {\n  var out = {};\n  try {\n    out.value = func(value);\n    out.status = 'success';\n  } catch (e) {\n    out.status = 'error';\n    out.value = e;\n  }\n  return out;\n}\n\nPromise.resolve = resolve;\nfunction resolve(value) {\n  if (value instanceof this) {\n    return value;\n  }\n  return handlers.resolve(new this(INTERNAL), value);\n}\n\nPromise.reject = reject;\nfunction reject(reason) {\n  var promise = new this(INTERNAL);\n  return handlers.reject(promise, reason);\n}\n\nPromise.all = all;\nfunction all(iterable) {\n  var self = this;\n  if (Object.prototype.toString.call(iterable) !== '[object Array]') {\n    return this.reject(new TypeError('must be an array'));\n  }\n\n  var len = iterable.length;\n  var called = false;\n  if (!len) {\n    return this.resolve([]);\n  }\n\n  var values = new Array(len);\n  var resolved = 0;\n  var i = -1;\n  var promise = new this(INTERNAL);\n\n  while (++i < len) {\n    allResolver(iterable[i], i);\n  }\n  return promise;\n  function allResolver(value, i) {\n    self.resolve(value).then(resolveFromAll, function (error) {\n      if (!called) {\n        called = true;\n        handlers.reject(promise, error);\n      }\n    });\n    function resolveFromAll(outValue) {\n      values[i] = outValue;\n      if (++resolved === len && !called) {\n        called = true;\n        handlers.resolve(promise, values);\n      }\n    }\n  }\n}\n\nPromise.race = race;\nfunction race(iterable) {\n  var self = this;\n  if (Object.prototype.toString.call(iterable) !== '[object Array]') {\n    return this.reject(new TypeError('must be an array'));\n  }\n\n  var len = iterable.length;\n  var called = false;\n  if (!len) {\n    return this.resolve([]);\n  }\n\n  var i = -1;\n  var promise = new this(INTERNAL);\n\n  while (++i < len) {\n    resolver(iterable[i]);\n  }\n  return promise;\n  function resolver(value) {\n    self.resolve(value).then(function (response) {\n      if (!called) {\n        called = true;\n        handlers.resolve(promise, response);\n      }\n    }, function (error) {\n      if (!called) {\n        called = true;\n        handlers.reject(promise, error);\n      }\n    });\n  }\n}\n\n},{\"1\":1}],3:[function(_dereq_,module,exports){\n(function (global){\n'use strict';\nif (typeof global.Promise !== 'function') {\n  global.Promise = _dereq_(2);\n}\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"2\":2}],4:[function(_dereq_,module,exports){\n'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction getIDB() {\n    /* global indexedDB,webkitIndexedDB,mozIndexedDB,OIndexedDB,msIndexedDB */\n    try {\n        if (typeof indexedDB !== 'undefined') {\n            return indexedDB;\n        }\n        if (typeof webkitIndexedDB !== 'undefined') {\n            return webkitIndexedDB;\n        }\n        if (typeof mozIndexedDB !== 'undefined') {\n            return mozIndexedDB;\n        }\n        if (typeof OIndexedDB !== 'undefined') {\n            return OIndexedDB;\n        }\n        if (typeof msIndexedDB !== 'undefined') {\n            return msIndexedDB;\n        }\n    } catch (e) {\n        return;\n    }\n}\n\nvar idb = getIDB();\n\nfunction isIndexedDBValid() {\n    try {\n        // Initialize IndexedDB; fall back to vendor-prefixed versions\n        // if needed.\n        if (!idb) {\n            return false;\n        }\n        // We mimic PouchDB here;\n        //\n        // We test for openDatabase because IE Mobile identifies itself\n        // as Safari. Oh the lulz...\n        var isSafari = typeof openDatabase !== 'undefined' && /(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent) && !/Chrome/.test(navigator.userAgent) && !/BlackBerry/.test(navigator.platform);\n\n        var hasFetch = typeof fetch === 'function' && fetch.toString().indexOf('[native code') !== -1;\n\n        // Safari <10.1 does not meet our requirements for IDB support (#5572)\n        // since Safari 10.1 shipped with fetch, we can use that to detect it\n        return (!isSafari || hasFetch) && typeof indexedDB !== 'undefined' &&\n        // some outdated implementations of IDB that appear on Samsung\n        // and HTC Android devices <4.4 are missing IDBKeyRange\n        // See: https://github.com/mozilla/localForage/issues/128\n        // See: https://github.com/mozilla/localForage/issues/272\n        typeof IDBKeyRange !== 'undefined';\n    } catch (e) {\n        return false;\n    }\n}\n\n// Abstracts constructing a Blob object, so it also works in older\n// browsers that don't support the native Blob constructor. (i.e.\n// old QtWebKit versions, at least).\n// Abstracts constructing a Blob object, so it also works in older\n// browsers that don't support the native Blob constructor. (i.e.\n// old QtWebKit versions, at least).\nfunction createBlob(parts, properties) {\n    /* global BlobBuilder,MSBlobBuilder,MozBlobBuilder,WebKitBlobBuilder */\n    parts = parts || [];\n    properties = properties || {};\n    try {\n        return new Blob(parts, properties);\n    } catch (e) {\n        if (e.name !== 'TypeError') {\n            throw e;\n        }\n        var Builder = typeof BlobBuilder !== 'undefined' ? BlobBuilder : typeof MSBlobBuilder !== 'undefined' ? MSBlobBuilder : typeof MozBlobBuilder !== 'undefined' ? MozBlobBuilder : WebKitBlobBuilder;\n        var builder = new Builder();\n        for (var i = 0; i < parts.length; i += 1) {\n            builder.append(parts[i]);\n        }\n        return builder.getBlob(properties.type);\n    }\n}\n\n// This is CommonJS because lie is an external dependency, so Rollup\n// can just ignore it.\nif (typeof Promise === 'undefined') {\n    // In the \"nopromises\" build this will just throw if you don't have\n    // a global promise object, but it would throw anyway later.\n    _dereq_(3);\n}\nvar Promise$1 = Promise;\n\nfunction executeCallback(promise, callback) {\n    if (callback) {\n        promise.then(function (result) {\n            callback(null, result);\n        }, function (error) {\n            callback(error);\n        });\n    }\n}\n\nfunction executeTwoCallbacks(promise, callback, errorCallback) {\n    if (typeof callback === 'function') {\n        promise.then(callback);\n    }\n\n    if (typeof errorCallback === 'function') {\n        promise[\"catch\"](errorCallback);\n    }\n}\n\nfunction normalizeKey(key) {\n    // Cast the key to a string, as that's all we can set as a key.\n    if (typeof key !== 'string') {\n        console.warn(key + ' used as a key, but it is not a string.');\n        key = String(key);\n    }\n\n    return key;\n}\n\nfunction getCallback() {\n    if (arguments.length && typeof arguments[arguments.length - 1] === 'function') {\n        return arguments[arguments.length - 1];\n    }\n}\n\n// Some code originally from async_storage.js in\n// [Gaia](https://github.com/mozilla-b2g/gaia).\n\nvar DETECT_BLOB_SUPPORT_STORE = 'local-forage-detect-blob-support';\nvar supportsBlobs = void 0;\nvar dbContexts = {};\nvar toString = Object.prototype.toString;\n\n// Transaction Modes\nvar READ_ONLY = 'readonly';\nvar READ_WRITE = 'readwrite';\n\n// Transform a binary string to an array buffer, because otherwise\n// weird stuff happens when you try to work with the binary string directly.\n// It is known.\n// From http://stackoverflow.com/questions/14967647/ (continues on next line)\n// encode-decode-image-with-base64-breaks-image (2013-04-21)\nfunction _binStringToArrayBuffer(bin) {\n    var length = bin.length;\n    var buf = new ArrayBuffer(length);\n    var arr = new Uint8Array(buf);\n    for (var i = 0; i < length; i++) {\n        arr[i] = bin.charCodeAt(i);\n    }\n    return buf;\n}\n\n//\n// Blobs are not supported in all versions of IndexedDB, notably\n// Chrome <37 and Android <5. In those versions, storing a blob will throw.\n//\n// Various other blob bugs exist in Chrome v37-42 (inclusive).\n// Detecting them is expensive and confusing to users, and Chrome 37-42\n// is at very low usage worldwide, so we do a hacky userAgent check instead.\n//\n// content-type bug: https://code.google.com/p/chromium/issues/detail?id=408120\n// 404 bug: https://code.google.com/p/chromium/issues/detail?id=447916\n// FileReader bug: https://code.google.com/p/chromium/issues/detail?id=447836\n//\n// Code borrowed from PouchDB. See:\n// https://github.com/pouchdb/pouchdb/blob/master/packages/node_modules/pouchdb-adapter-idb/src/blobSupport.js\n//\nfunction _checkBlobSupportWithoutCaching(idb) {\n    return new Promise$1(function (resolve) {\n        var txn = idb.transaction(DETECT_BLOB_SUPPORT_STORE, READ_WRITE);\n        var blob = createBlob(['']);\n        txn.objectStore(DETECT_BLOB_SUPPORT_STORE).put(blob, 'key');\n\n        txn.onabort = function (e) {\n            // If the transaction aborts now its due to not being able to\n            // write to the database, likely due to the disk being full\n            e.preventDefault();\n            e.stopPropagation();\n            resolve(false);\n        };\n\n        txn.oncomplete = function () {\n            var matchedChrome = navigator.userAgent.match(/Chrome\\/(\\d+)/);\n            var matchedEdge = navigator.userAgent.match(/Edge\\//);\n            // MS Edge pretends to be Chrome 42:\n            // https://msdn.microsoft.com/en-us/library/hh869301%28v=vs.85%29.aspx\n            resolve(matchedEdge || !matchedChrome || parseInt(matchedChrome[1], 10) >= 43);\n        };\n    })[\"catch\"](function () {\n        return false; // error, so assume unsupported\n    });\n}\n\nfunction _checkBlobSupport(idb) {\n    if (typeof supportsBlobs === 'boolean') {\n        return Promise$1.resolve(supportsBlobs);\n    }\n    return _checkBlobSupportWithoutCaching(idb).then(function (value) {\n        supportsBlobs = value;\n        return supportsBlobs;\n    });\n}\n\nfunction _deferReadiness(dbInfo) {\n    var dbContext = dbContexts[dbInfo.name];\n\n    // Create a deferred object representing the current database operation.\n    var deferredOperation = {};\n\n    deferredOperation.promise = new Promise$1(function (resolve, reject) {\n        deferredOperation.resolve = resolve;\n        deferredOperation.reject = reject;\n    });\n\n    // Enqueue the deferred operation.\n    dbContext.deferredOperations.push(deferredOperation);\n\n    // Chain its promise to the database readiness.\n    if (!dbContext.dbReady) {\n        dbContext.dbReady = deferredOperation.promise;\n    } else {\n        dbContext.dbReady = dbContext.dbReady.then(function () {\n            return deferredOperation.promise;\n        });\n    }\n}\n\nfunction _advanceReadiness(dbInfo) {\n    var dbContext = dbContexts[dbInfo.name];\n\n    // Dequeue a deferred operation.\n    var deferredOperation = dbContext.deferredOperations.pop();\n\n    // Resolve its promise (which is part of the database readiness\n    // chain of promises).\n    if (deferredOperation) {\n        deferredOperation.resolve();\n        return deferredOperation.promise;\n    }\n}\n\nfunction _rejectReadiness(dbInfo, err) {\n    var dbContext = dbContexts[dbInfo.name];\n\n    // Dequeue a deferred operation.\n    var deferredOperation = dbContext.deferredOperations.pop();\n\n    // Reject its promise (which is part of the database readiness\n    // chain of promises).\n    if (deferredOperation) {\n        deferredOperation.reject(err);\n        return deferredOperation.promise;\n    }\n}\n\nfunction _getConnection(dbInfo, upgradeNeeded) {\n    return new Promise$1(function (resolve, reject) {\n        dbContexts[dbInfo.name] = dbContexts[dbInfo.name] || createDbContext();\n\n        if (dbInfo.db) {\n            if (upgradeNeeded) {\n                _deferReadiness(dbInfo);\n                dbInfo.db.close();\n            } else {\n                return resolve(dbInfo.db);\n            }\n        }\n\n        var dbArgs = [dbInfo.name];\n\n        if (upgradeNeeded) {\n            dbArgs.push(dbInfo.version);\n        }\n\n        var openreq = idb.open.apply(idb, dbArgs);\n\n        if (upgradeNeeded) {\n            openreq.onupgradeneeded = function (e) {\n                var db = openreq.result;\n                try {\n                    db.createObjectStore(dbInfo.storeName);\n                    if (e.oldVersion <= 1) {\n                        // Added when support for blob shims was added\n                        db.createObjectStore(DETECT_BLOB_SUPPORT_STORE);\n                    }\n                } catch (ex) {\n                    if (ex.name === 'ConstraintError') {\n                        console.warn('The database \"' + dbInfo.name + '\"' + ' has been upgraded from version ' + e.oldVersion + ' to version ' + e.newVersion + ', but the storage \"' + dbInfo.storeName + '\" already exists.');\n                    } else {\n                        throw ex;\n                    }\n                }\n            };\n        }\n\n        openreq.onerror = function (e) {\n            e.preventDefault();\n            reject(openreq.error);\n        };\n\n        openreq.onsuccess = function () {\n            resolve(openreq.result);\n            _advanceReadiness(dbInfo);\n        };\n    });\n}\n\nfunction _getOriginalConnection(dbInfo) {\n    return _getConnection(dbInfo, false);\n}\n\nfunction _getUpgradedConnection(dbInfo) {\n    return _getConnection(dbInfo, true);\n}\n\nfunction _isUpgradeNeeded(dbInfo, defaultVersion) {\n    if (!dbInfo.db) {\n        return true;\n    }\n\n    var isNewStore = !dbInfo.db.objectStoreNames.contains(dbInfo.storeName);\n    var isDowngrade = dbInfo.version < dbInfo.db.version;\n    var isUpgrade = dbInfo.version > dbInfo.db.version;\n\n    if (isDowngrade) {\n        // If the version is not the default one\n        // then warn for impossible downgrade.\n        if (dbInfo.version !== defaultVersion) {\n            console.warn('The database \"' + dbInfo.name + '\"' + \" can't be downgraded from version \" + dbInfo.db.version + ' to version ' + dbInfo.version + '.');\n        }\n        // Align the versions to prevent errors.\n        dbInfo.version = dbInfo.db.version;\n    }\n\n    if (isUpgrade || isNewStore) {\n        // If the store is new then increment the version (if needed).\n        // This will trigger an \"upgradeneeded\" event which is required\n        // for creating a store.\n        if (isNewStore) {\n            var incVersion = dbInfo.db.version + 1;\n            if (incVersion > dbInfo.version) {\n                dbInfo.version = incVersion;\n            }\n        }\n\n        return true;\n    }\n\n    return false;\n}\n\n// encode a blob for indexeddb engines that don't support blobs\nfunction _encodeBlob(blob) {\n    return new Promise$1(function (resolve, reject) {\n        var reader = new FileReader();\n        reader.onerror = reject;\n        reader.onloadend = function (e) {\n            var base64 = btoa(e.target.result || '');\n            resolve({\n                __local_forage_encoded_blob: true,\n                data: base64,\n                type: blob.type\n            });\n        };\n        reader.readAsBinaryString(blob);\n    });\n}\n\n// decode an encoded blob\nfunction _decodeBlob(encodedBlob) {\n    var arrayBuff = _binStringToArrayBuffer(atob(encodedBlob.data));\n    return createBlob([arrayBuff], { type: encodedBlob.type });\n}\n\n// is this one of our fancy encoded blobs?\nfunction _isEncodedBlob(value) {\n    return value && value.__local_forage_encoded_blob;\n}\n\n// Specialize the default `ready()` function by making it dependent\n// on the current database operations. Thus, the driver will be actually\n// ready when it's been initialized (default) *and* there are no pending\n// operations on the database (initiated by some other instances).\nfunction _fullyReady(callback) {\n    var self = this;\n\n    var promise = self._initReady().then(function () {\n        var dbContext = dbContexts[self._dbInfo.name];\n\n        if (dbContext && dbContext.dbReady) {\n            return dbContext.dbReady;\n        }\n    });\n\n    executeTwoCallbacks(promise, callback, callback);\n    return promise;\n}\n\n// Try to establish a new db connection to replace the\n// current one which is broken (i.e. experiencing\n// InvalidStateError while creating a transaction).\nfunction _tryReconnect(dbInfo) {\n    _deferReadiness(dbInfo);\n\n    var dbContext = dbContexts[dbInfo.name];\n    var forages = dbContext.forages;\n\n    for (var i = 0; i < forages.length; i++) {\n        var forage = forages[i];\n        if (forage._dbInfo.db) {\n            forage._dbInfo.db.close();\n            forage._dbInfo.db = null;\n        }\n    }\n    dbInfo.db = null;\n\n    return _getOriginalConnection(dbInfo).then(function (db) {\n        dbInfo.db = db;\n        if (_isUpgradeNeeded(dbInfo)) {\n            // Reopen the database for upgrading.\n            return _getUpgradedConnection(dbInfo);\n        }\n        return db;\n    }).then(function (db) {\n        // store the latest db reference\n        // in case the db was upgraded\n        dbInfo.db = dbContext.db = db;\n        for (var i = 0; i < forages.length; i++) {\n            forages[i]._dbInfo.db = db;\n        }\n    })[\"catch\"](function (err) {\n        _rejectReadiness(dbInfo, err);\n        throw err;\n    });\n}\n\n// FF doesn't like Promises (micro-tasks) and IDDB store operations,\n// so we have to do it with callbacks\nfunction createTransaction(dbInfo, mode, callback, retries) {\n    if (retries === undefined) {\n        retries = 1;\n    }\n\n    try {\n        var tx = dbInfo.db.transaction(dbInfo.storeName, mode);\n        callback(null, tx);\n    } catch (err) {\n        if (retries > 0 && (!dbInfo.db || err.name === 'InvalidStateError' || err.name === 'NotFoundError')) {\n            return Promise$1.resolve().then(function () {\n                if (!dbInfo.db || err.name === 'NotFoundError' && !dbInfo.db.objectStoreNames.contains(dbInfo.storeName) && dbInfo.version <= dbInfo.db.version) {\n                    // increase the db version, to create the new ObjectStore\n                    if (dbInfo.db) {\n                        dbInfo.version = dbInfo.db.version + 1;\n                    }\n                    // Reopen the database for upgrading.\n                    return _getUpgradedConnection(dbInfo);\n                }\n            }).then(function () {\n                return _tryReconnect(dbInfo).then(function () {\n                    createTransaction(dbInfo, mode, callback, retries - 1);\n                });\n            })[\"catch\"](callback);\n        }\n\n        callback(err);\n    }\n}\n\nfunction createDbContext() {\n    return {\n        // Running localForages sharing a database.\n        forages: [],\n        // Shared database.\n        db: null,\n        // Database readiness (promise).\n        dbReady: null,\n        // Deferred operations on the database.\n        deferredOperations: []\n    };\n}\n\n// Open the IndexedDB database (automatically creates one if one didn't\n// previously exist), using any options set in the config.\nfunction _initStorage(options) {\n    var self = this;\n    var dbInfo = {\n        db: null\n    };\n\n    if (options) {\n        for (var i in options) {\n            dbInfo[i] = options[i];\n        }\n    }\n\n    // Get the current context of the database;\n    var dbContext = dbContexts[dbInfo.name];\n\n    // ...or create a new context.\n    if (!dbContext) {\n        dbContext = createDbContext();\n        // Register the new context in the global container.\n        dbContexts[dbInfo.name] = dbContext;\n    }\n\n    // Register itself as a running localForage in the current context.\n    dbContext.forages.push(self);\n\n    // Replace the default `ready()` function with the specialized one.\n    if (!self._initReady) {\n        self._initReady = self.ready;\n        self.ready = _fullyReady;\n    }\n\n    // Create an array of initialization states of the related localForages.\n    var initPromises = [];\n\n    function ignoreErrors() {\n        // Don't handle errors here,\n        // just makes sure related localForages aren't pending.\n        return Promise$1.resolve();\n    }\n\n    for (var j = 0; j < dbContext.forages.length; j++) {\n        var forage = dbContext.forages[j];\n        if (forage !== self) {\n            // Don't wait for itself...\n            initPromises.push(forage._initReady()[\"catch\"](ignoreErrors));\n        }\n    }\n\n    // Take a snapshot of the related localForages.\n    var forages = dbContext.forages.slice(0);\n\n    // Initialize the connection process only when\n    // all the related localForages aren't pending.\n    return Promise$1.all(initPromises).then(function () {\n        dbInfo.db = dbContext.db;\n        // Get the connection or open a new one without upgrade.\n        return _getOriginalConnection(dbInfo);\n    }).then(function (db) {\n        dbInfo.db = db;\n        if (_isUpgradeNeeded(dbInfo, self._defaultConfig.version)) {\n            // Reopen the database for upgrading.\n            return _getUpgradedConnection(dbInfo);\n        }\n        return db;\n    }).then(function (db) {\n        dbInfo.db = dbContext.db = db;\n        self._dbInfo = dbInfo;\n        // Share the final connection amongst related localForages.\n        for (var k = 0; k < forages.length; k++) {\n            var forage = forages[k];\n            if (forage !== self) {\n                // Self is already up-to-date.\n                forage._dbInfo.db = dbInfo.db;\n                forage._dbInfo.version = dbInfo.version;\n            }\n        }\n    });\n}\n\nfunction getItem(key, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_ONLY, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    var req = store.get(key);\n\n                    req.onsuccess = function () {\n                        var value = req.result;\n                        if (value === undefined) {\n                            value = null;\n                        }\n                        if (_isEncodedBlob(value)) {\n                            value = _decodeBlob(value);\n                        }\n                        resolve(value);\n                    };\n\n                    req.onerror = function () {\n                        reject(req.error);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Iterate over all items stored in database.\nfunction iterate(iterator, callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_ONLY, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    var req = store.openCursor();\n                    var iterationNumber = 1;\n\n                    req.onsuccess = function () {\n                        var cursor = req.result;\n\n                        if (cursor) {\n                            var value = cursor.value;\n                            if (_isEncodedBlob(value)) {\n                                value = _decodeBlob(value);\n                            }\n                            var result = iterator(value, cursor.key, iterationNumber++);\n\n                            // when the iterator callback retuns any\n                            // (non-`undefined`) value, then we stop\n                            // the iteration immediately\n                            if (result !== void 0) {\n                                resolve(result);\n                            } else {\n                                cursor[\"continue\"]();\n                            }\n                        } else {\n                            resolve();\n                        }\n                    };\n\n                    req.onerror = function () {\n                        reject(req.error);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n\n    return promise;\n}\n\nfunction setItem(key, value, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = new Promise$1(function (resolve, reject) {\n        var dbInfo;\n        self.ready().then(function () {\n            dbInfo = self._dbInfo;\n            if (toString.call(value) === '[object Blob]') {\n                return _checkBlobSupport(dbInfo.db).then(function (blobSupport) {\n                    if (blobSupport) {\n                        return value;\n                    }\n                    return _encodeBlob(value);\n                });\n            }\n            return value;\n        }).then(function (value) {\n            createTransaction(self._dbInfo, READ_WRITE, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n\n                    // The reason we don't _save_ null is because IE 10 does\n                    // not support saving the `null` type in IndexedDB. How\n                    // ironic, given the bug below!\n                    // See: https://github.com/mozilla/localForage/issues/161\n                    if (value === null) {\n                        value = undefined;\n                    }\n\n                    var req = store.put(value, key);\n\n                    transaction.oncomplete = function () {\n                        // Cast to undefined so the value passed to\n                        // callback/promise is the same as what one would get out\n                        // of `getItem()` later. This leads to some weirdness\n                        // (setItem('foo', undefined) will return `null`), but\n                        // it's not my fault localStorage is our baseline and that\n                        // it's weird.\n                        if (value === undefined) {\n                            value = null;\n                        }\n\n                        resolve(value);\n                    };\n                    transaction.onabort = transaction.onerror = function () {\n                        var err = req.error ? req.error : req.transaction.error;\n                        reject(err);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction removeItem(key, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_WRITE, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    // We use a Grunt task to make this safe for IE and some\n                    // versions of Android (including those used by Cordova).\n                    // Normally IE won't like `.delete()` and will insist on\n                    // using `['delete']()`, but we have a build step that\n                    // fixes this for us now.\n                    var req = store[\"delete\"](key);\n                    transaction.oncomplete = function () {\n                        resolve();\n                    };\n\n                    transaction.onerror = function () {\n                        reject(req.error);\n                    };\n\n                    // The request will be also be aborted if we've exceeded our storage\n                    // space.\n                    transaction.onabort = function () {\n                        var err = req.error ? req.error : req.transaction.error;\n                        reject(err);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction clear(callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_WRITE, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    var req = store.clear();\n\n                    transaction.oncomplete = function () {\n                        resolve();\n                    };\n\n                    transaction.onabort = transaction.onerror = function () {\n                        var err = req.error ? req.error : req.transaction.error;\n                        reject(err);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction length(callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_ONLY, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    var req = store.count();\n\n                    req.onsuccess = function () {\n                        resolve(req.result);\n                    };\n\n                    req.onerror = function () {\n                        reject(req.error);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction key(n, callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        if (n < 0) {\n            resolve(null);\n\n            return;\n        }\n\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_ONLY, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    var advanced = false;\n                    var req = store.openCursor();\n\n                    req.onsuccess = function () {\n                        var cursor = req.result;\n                        if (!cursor) {\n                            // this means there weren't enough keys\n                            resolve(null);\n\n                            return;\n                        }\n\n                        if (n === 0) {\n                            // We have the first key, return it if that's what they\n                            // wanted.\n                            resolve(cursor.key);\n                        } else {\n                            if (!advanced) {\n                                // Otherwise, ask the cursor to skip ahead n\n                                // records.\n                                advanced = true;\n                                cursor.advance(n);\n                            } else {\n                                // When we get here, we've got the nth key.\n                                resolve(cursor.key);\n                            }\n                        }\n                    };\n\n                    req.onerror = function () {\n                        reject(req.error);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction keys(callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_ONLY, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    var req = store.openCursor();\n                    var keys = [];\n\n                    req.onsuccess = function () {\n                        var cursor = req.result;\n\n                        if (!cursor) {\n                            resolve(keys);\n                            return;\n                        }\n\n                        keys.push(cursor.key);\n                        cursor[\"continue\"]();\n                    };\n\n                    req.onerror = function () {\n                        reject(req.error);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction dropInstance(options, callback) {\n    callback = getCallback.apply(this, arguments);\n\n    var currentConfig = this.config();\n    options = typeof options !== 'function' && options || {};\n    if (!options.name) {\n        options.name = options.name || currentConfig.name;\n        options.storeName = options.storeName || currentConfig.storeName;\n    }\n\n    var self = this;\n    var promise;\n    if (!options.name) {\n        promise = Promise$1.reject('Invalid arguments');\n    } else {\n        var isCurrentDb = options.name === currentConfig.name && self._dbInfo.db;\n\n        var dbPromise = isCurrentDb ? Promise$1.resolve(self._dbInfo.db) : _getOriginalConnection(options).then(function (db) {\n            var dbContext = dbContexts[options.name];\n            var forages = dbContext.forages;\n            dbContext.db = db;\n            for (var i = 0; i < forages.length; i++) {\n                forages[i]._dbInfo.db = db;\n            }\n            return db;\n        });\n\n        if (!options.storeName) {\n            promise = dbPromise.then(function (db) {\n                _deferReadiness(options);\n\n                var dbContext = dbContexts[options.name];\n                var forages = dbContext.forages;\n\n                db.close();\n                for (var i = 0; i < forages.length; i++) {\n                    var forage = forages[i];\n                    forage._dbInfo.db = null;\n                }\n\n                var dropDBPromise = new Promise$1(function (resolve, reject) {\n                    var req = idb.deleteDatabase(options.name);\n\n                    req.onerror = req.onblocked = function (err) {\n                        var db = req.result;\n                        if (db) {\n                            db.close();\n                        }\n                        reject(err);\n                    };\n\n                    req.onsuccess = function () {\n                        var db = req.result;\n                        if (db) {\n                            db.close();\n                        }\n                        resolve(db);\n                    };\n                });\n\n                return dropDBPromise.then(function (db) {\n                    dbContext.db = db;\n                    for (var i = 0; i < forages.length; i++) {\n                        var _forage = forages[i];\n                        _advanceReadiness(_forage._dbInfo);\n                    }\n                })[\"catch\"](function (err) {\n                    (_rejectReadiness(options, err) || Promise$1.resolve())[\"catch\"](function () {});\n                    throw err;\n                });\n            });\n        } else {\n            promise = dbPromise.then(function (db) {\n                if (!db.objectStoreNames.contains(options.storeName)) {\n                    return;\n                }\n\n                var newVersion = db.version + 1;\n\n                _deferReadiness(options);\n\n                var dbContext = dbContexts[options.name];\n                var forages = dbContext.forages;\n\n                db.close();\n                for (var i = 0; i < forages.length; i++) {\n                    var forage = forages[i];\n                    forage._dbInfo.db = null;\n                    forage._dbInfo.version = newVersion;\n                }\n\n                var dropObjectPromise = new Promise$1(function (resolve, reject) {\n                    var req = idb.open(options.name, newVersion);\n\n                    req.onerror = function (err) {\n                        var db = req.result;\n                        db.close();\n                        reject(err);\n                    };\n\n                    req.onupgradeneeded = function () {\n                        var db = req.result;\n                        db.deleteObjectStore(options.storeName);\n                    };\n\n                    req.onsuccess = function () {\n                        var db = req.result;\n                        db.close();\n                        resolve(db);\n                    };\n                });\n\n                return dropObjectPromise.then(function (db) {\n                    dbContext.db = db;\n                    for (var j = 0; j < forages.length; j++) {\n                        var _forage2 = forages[j];\n                        _forage2._dbInfo.db = db;\n                        _advanceReadiness(_forage2._dbInfo);\n                    }\n                })[\"catch\"](function (err) {\n                    (_rejectReadiness(options, err) || Promise$1.resolve())[\"catch\"](function () {});\n                    throw err;\n                });\n            });\n        }\n    }\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nvar asyncStorage = {\n    _driver: 'asyncStorage',\n    _initStorage: _initStorage,\n    _support: isIndexedDBValid(),\n    iterate: iterate,\n    getItem: getItem,\n    setItem: setItem,\n    removeItem: removeItem,\n    clear: clear,\n    length: length,\n    key: key,\n    keys: keys,\n    dropInstance: dropInstance\n};\n\nfunction isWebSQLValid() {\n    return typeof openDatabase === 'function';\n}\n\n// Sadly, the best way to save binary data in WebSQL/localStorage is serializing\n// it to Base64, so this is how we store it to prevent very strange errors with less\n// verbose ways of binary <-> string data storage.\nvar BASE_CHARS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\nvar BLOB_TYPE_PREFIX = '~~local_forage_type~';\nvar BLOB_TYPE_PREFIX_REGEX = /^~~local_forage_type~([^~]+)~/;\n\nvar SERIALIZED_MARKER = '__lfsc__:';\nvar SERIALIZED_MARKER_LENGTH = SERIALIZED_MARKER.length;\n\n// OMG the serializations!\nvar TYPE_ARRAYBUFFER = 'arbf';\nvar TYPE_BLOB = 'blob';\nvar TYPE_INT8ARRAY = 'si08';\nvar TYPE_UINT8ARRAY = 'ui08';\nvar TYPE_UINT8CLAMPEDARRAY = 'uic8';\nvar TYPE_INT16ARRAY = 'si16';\nvar TYPE_INT32ARRAY = 'si32';\nvar TYPE_UINT16ARRAY = 'ur16';\nvar TYPE_UINT32ARRAY = 'ui32';\nvar TYPE_FLOAT32ARRAY = 'fl32';\nvar TYPE_FLOAT64ARRAY = 'fl64';\nvar TYPE_SERIALIZED_MARKER_LENGTH = SERIALIZED_MARKER_LENGTH + TYPE_ARRAYBUFFER.length;\n\nvar toString$1 = Object.prototype.toString;\n\nfunction stringToBuffer(serializedString) {\n    // Fill the string into a ArrayBuffer.\n    var bufferLength = serializedString.length * 0.75;\n    var len = serializedString.length;\n    var i;\n    var p = 0;\n    var encoded1, encoded2, encoded3, encoded4;\n\n    if (serializedString[serializedString.length - 1] === '=') {\n        bufferLength--;\n        if (serializedString[serializedString.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n\n    var buffer = new ArrayBuffer(bufferLength);\n    var bytes = new Uint8Array(buffer);\n\n    for (i = 0; i < len; i += 4) {\n        encoded1 = BASE_CHARS.indexOf(serializedString[i]);\n        encoded2 = BASE_CHARS.indexOf(serializedString[i + 1]);\n        encoded3 = BASE_CHARS.indexOf(serializedString[i + 2]);\n        encoded4 = BASE_CHARS.indexOf(serializedString[i + 3]);\n\n        /*jslint bitwise: true */\n        bytes[p++] = encoded1 << 2 | encoded2 >> 4;\n        bytes[p++] = (encoded2 & 15) << 4 | encoded3 >> 2;\n        bytes[p++] = (encoded3 & 3) << 6 | encoded4 & 63;\n    }\n    return buffer;\n}\n\n// Converts a buffer to a string to store, serialized, in the backend\n// storage library.\nfunction bufferToString(buffer) {\n    // base64-arraybuffer\n    var bytes = new Uint8Array(buffer);\n    var base64String = '';\n    var i;\n\n    for (i = 0; i < bytes.length; i += 3) {\n        /*jslint bitwise: true */\n        base64String += BASE_CHARS[bytes[i] >> 2];\n        base64String += BASE_CHARS[(bytes[i] & 3) << 4 | bytes[i + 1] >> 4];\n        base64String += BASE_CHARS[(bytes[i + 1] & 15) << 2 | bytes[i + 2] >> 6];\n        base64String += BASE_CHARS[bytes[i + 2] & 63];\n    }\n\n    if (bytes.length % 3 === 2) {\n        base64String = base64String.substring(0, base64String.length - 1) + '=';\n    } else if (bytes.length % 3 === 1) {\n        base64String = base64String.substring(0, base64String.length - 2) + '==';\n    }\n\n    return base64String;\n}\n\n// Serialize a value, afterwards executing a callback (which usually\n// instructs the `setItem()` callback/promise to be executed). This is how\n// we store binary data with localStorage.\nfunction serialize(value, callback) {\n    var valueType = '';\n    if (value) {\n        valueType = toString$1.call(value);\n    }\n\n    // Cannot use `value instanceof ArrayBuffer` or such here, as these\n    // checks fail when running the tests using casper.js...\n    //\n    // TODO: See why those tests fail and use a better solution.\n    if (value && (valueType === '[object ArrayBuffer]' || value.buffer && toString$1.call(value.buffer) === '[object ArrayBuffer]')) {\n        // Convert binary arrays to a string and prefix the string with\n        // a special marker.\n        var buffer;\n        var marker = SERIALIZED_MARKER;\n\n        if (value instanceof ArrayBuffer) {\n            buffer = value;\n            marker += TYPE_ARRAYBUFFER;\n        } else {\n            buffer = value.buffer;\n\n            if (valueType === '[object Int8Array]') {\n                marker += TYPE_INT8ARRAY;\n            } else if (valueType === '[object Uint8Array]') {\n                marker += TYPE_UINT8ARRAY;\n            } else if (valueType === '[object Uint8ClampedArray]') {\n                marker += TYPE_UINT8CLAMPEDARRAY;\n            } else if (valueType === '[object Int16Array]') {\n                marker += TYPE_INT16ARRAY;\n            } else if (valueType === '[object Uint16Array]') {\n                marker += TYPE_UINT16ARRAY;\n            } else if (valueType === '[object Int32Array]') {\n                marker += TYPE_INT32ARRAY;\n            } else if (valueType === '[object Uint32Array]') {\n                marker += TYPE_UINT32ARRAY;\n            } else if (valueType === '[object Float32Array]') {\n                marker += TYPE_FLOAT32ARRAY;\n            } else if (valueType === '[object Float64Array]') {\n                marker += TYPE_FLOAT64ARRAY;\n            } else {\n                callback(new Error('Failed to get type for BinaryArray'));\n            }\n        }\n\n        callback(marker + bufferToString(buffer));\n    } else if (valueType === '[object Blob]') {\n        // Conver the blob to a binaryArray and then to a string.\n        var fileReader = new FileReader();\n\n        fileReader.onload = function () {\n            // Backwards-compatible prefix for the blob type.\n            var str = BLOB_TYPE_PREFIX + value.type + '~' + bufferToString(this.result);\n\n            callback(SERIALIZED_MARKER + TYPE_BLOB + str);\n        };\n\n        fileReader.readAsArrayBuffer(value);\n    } else {\n        try {\n            callback(JSON.stringify(value));\n        } catch (e) {\n            console.error(\"Couldn't convert value into a JSON string: \", value);\n\n            callback(null, e);\n        }\n    }\n}\n\n// Deserialize data we've inserted into a value column/field. We place\n// special markers into our strings to mark them as encoded; this isn't\n// as nice as a meta field, but it's the only sane thing we can do whilst\n// keeping localStorage support intact.\n//\n// Oftentimes this will just deserialize JSON content, but if we have a\n// special marker (SERIALIZED_MARKER, defined above), we will extract\n// some kind of arraybuffer/binary data/typed array out of the string.\nfunction deserialize(value) {\n    // If we haven't marked this string as being specially serialized (i.e.\n    // something other than serialized JSON), we can just return it and be\n    // done with it.\n    if (value.substring(0, SERIALIZED_MARKER_LENGTH) !== SERIALIZED_MARKER) {\n        return JSON.parse(value);\n    }\n\n    // The following code deals with deserializing some kind of Blob or\n    // TypedArray. First we separate out the type of data we're dealing\n    // with from the data itself.\n    var serializedString = value.substring(TYPE_SERIALIZED_MARKER_LENGTH);\n    var type = value.substring(SERIALIZED_MARKER_LENGTH, TYPE_SERIALIZED_MARKER_LENGTH);\n\n    var blobType;\n    // Backwards-compatible blob type serialization strategy.\n    // DBs created with older versions of localForage will simply not have the blob type.\n    if (type === TYPE_BLOB && BLOB_TYPE_PREFIX_REGEX.test(serializedString)) {\n        var matcher = serializedString.match(BLOB_TYPE_PREFIX_REGEX);\n        blobType = matcher[1];\n        serializedString = serializedString.substring(matcher[0].length);\n    }\n    var buffer = stringToBuffer(serializedString);\n\n    // Return the right type based on the code/type set during\n    // serialization.\n    switch (type) {\n        case TYPE_ARRAYBUFFER:\n            return buffer;\n        case TYPE_BLOB:\n            return createBlob([buffer], { type: blobType });\n        case TYPE_INT8ARRAY:\n            return new Int8Array(buffer);\n        case TYPE_UINT8ARRAY:\n            return new Uint8Array(buffer);\n        case TYPE_UINT8CLAMPEDARRAY:\n            return new Uint8ClampedArray(buffer);\n        case TYPE_INT16ARRAY:\n            return new Int16Array(buffer);\n        case TYPE_UINT16ARRAY:\n            return new Uint16Array(buffer);\n        case TYPE_INT32ARRAY:\n            return new Int32Array(buffer);\n        case TYPE_UINT32ARRAY:\n            return new Uint32Array(buffer);\n        case TYPE_FLOAT32ARRAY:\n            return new Float32Array(buffer);\n        case TYPE_FLOAT64ARRAY:\n            return new Float64Array(buffer);\n        default:\n            throw new Error('Unkown type: ' + type);\n    }\n}\n\nvar localforageSerializer = {\n    serialize: serialize,\n    deserialize: deserialize,\n    stringToBuffer: stringToBuffer,\n    bufferToString: bufferToString\n};\n\n/*\n * Includes code from:\n *\n * base64-arraybuffer\n * https://github.com/niklasvh/base64-arraybuffer\n *\n * Copyright (c) 2012 Niklas von Hertzen\n * Licensed under the MIT license.\n */\n\nfunction createDbTable(t, dbInfo, callback, errorCallback) {\n    t.executeSql('CREATE TABLE IF NOT EXISTS ' + dbInfo.storeName + ' ' + '(id INTEGER PRIMARY KEY, key unique, value)', [], callback, errorCallback);\n}\n\n// Open the WebSQL database (automatically creates one if one didn't\n// previously exist), using any options set in the config.\nfunction _initStorage$1(options) {\n    var self = this;\n    var dbInfo = {\n        db: null\n    };\n\n    if (options) {\n        for (var i in options) {\n            dbInfo[i] = typeof options[i] !== 'string' ? options[i].toString() : options[i];\n        }\n    }\n\n    var dbInfoPromise = new Promise$1(function (resolve, reject) {\n        // Open the database; the openDatabase API will automatically\n        // create it for us if it doesn't exist.\n        try {\n            dbInfo.db = openDatabase(dbInfo.name, String(dbInfo.version), dbInfo.description, dbInfo.size);\n        } catch (e) {\n            return reject(e);\n        }\n\n        // Create our key/value table if it doesn't exist.\n        dbInfo.db.transaction(function (t) {\n            createDbTable(t, dbInfo, function () {\n                self._dbInfo = dbInfo;\n                resolve();\n            }, function (t, error) {\n                reject(error);\n            });\n        }, reject);\n    });\n\n    dbInfo.serializer = localforageSerializer;\n    return dbInfoPromise;\n}\n\nfunction tryExecuteSql(t, dbInfo, sqlStatement, args, callback, errorCallback) {\n    t.executeSql(sqlStatement, args, callback, function (t, error) {\n        if (error.code === error.SYNTAX_ERR) {\n            t.executeSql('SELECT name FROM sqlite_master ' + \"WHERE type='table' AND name = ?\", [dbInfo.storeName], function (t, results) {\n                if (!results.rows.length) {\n                    // if the table is missing (was deleted)\n                    // re-create it table and retry\n                    createDbTable(t, dbInfo, function () {\n                        t.executeSql(sqlStatement, args, callback, errorCallback);\n                    }, errorCallback);\n                } else {\n                    errorCallback(t, error);\n                }\n            }, errorCallback);\n        } else {\n            errorCallback(t, error);\n        }\n    }, errorCallback);\n}\n\nfunction getItem$1(key, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n            dbInfo.db.transaction(function (t) {\n                tryExecuteSql(t, dbInfo, 'SELECT * FROM ' + dbInfo.storeName + ' WHERE key = ? LIMIT 1', [key], function (t, results) {\n                    var result = results.rows.length ? results.rows.item(0).value : null;\n\n                    // Check to see if this is serialized content we need to\n                    // unpack.\n                    if (result) {\n                        result = dbInfo.serializer.deserialize(result);\n                    }\n\n                    resolve(result);\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction iterate$1(iterator, callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n\n            dbInfo.db.transaction(function (t) {\n                tryExecuteSql(t, dbInfo, 'SELECT * FROM ' + dbInfo.storeName, [], function (t, results) {\n                    var rows = results.rows;\n                    var length = rows.length;\n\n                    for (var i = 0; i < length; i++) {\n                        var item = rows.item(i);\n                        var result = item.value;\n\n                        // Check to see if this is serialized content\n                        // we need to unpack.\n                        if (result) {\n                            result = dbInfo.serializer.deserialize(result);\n                        }\n\n                        result = iterator(result, item.key, i + 1);\n\n                        // void(0) prevents problems with redefinition\n                        // of `undefined`.\n                        if (result !== void 0) {\n                            resolve(result);\n                            return;\n                        }\n                    }\n\n                    resolve();\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction _setItem(key, value, callback, retriesLeft) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            // The localStorage API doesn't return undefined values in an\n            // \"expected\" way, so undefined is always cast to null in all\n            // drivers. See: https://github.com/mozilla/localForage/pull/42\n            if (value === undefined) {\n                value = null;\n            }\n\n            // Save the original value to pass to the callback.\n            var originalValue = value;\n\n            var dbInfo = self._dbInfo;\n            dbInfo.serializer.serialize(value, function (value, error) {\n                if (error) {\n                    reject(error);\n                } else {\n                    dbInfo.db.transaction(function (t) {\n                        tryExecuteSql(t, dbInfo, 'INSERT OR REPLACE INTO ' + dbInfo.storeName + ' ' + '(key, value) VALUES (?, ?)', [key, value], function () {\n                            resolve(originalValue);\n                        }, function (t, error) {\n                            reject(error);\n                        });\n                    }, function (sqlError) {\n                        // The transaction failed; check\n                        // to see if it's a quota error.\n                        if (sqlError.code === sqlError.QUOTA_ERR) {\n                            // We reject the callback outright for now, but\n                            // it's worth trying to re-run the transaction.\n                            // Even if the user accepts the prompt to use\n                            // more storage on Safari, this error will\n                            // be called.\n                            //\n                            // Try to re-run the transaction.\n                            if (retriesLeft > 0) {\n                                resolve(_setItem.apply(self, [key, originalValue, callback, retriesLeft - 1]));\n                                return;\n                            }\n                            reject(sqlError);\n                        }\n                    });\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction setItem$1(key, value, callback) {\n    return _setItem.apply(this, [key, value, callback, 1]);\n}\n\nfunction removeItem$1(key, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n            dbInfo.db.transaction(function (t) {\n                tryExecuteSql(t, dbInfo, 'DELETE FROM ' + dbInfo.storeName + ' WHERE key = ?', [key], function () {\n                    resolve();\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Deletes every item in the table.\n// TODO: Find out if this resets the AUTO_INCREMENT number.\nfunction clear$1(callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n            dbInfo.db.transaction(function (t) {\n                tryExecuteSql(t, dbInfo, 'DELETE FROM ' + dbInfo.storeName, [], function () {\n                    resolve();\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Does a simple `COUNT(key)` to get the number of items stored in\n// localForage.\nfunction length$1(callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n            dbInfo.db.transaction(function (t) {\n                // Ahhh, SQL makes this one soooooo easy.\n                tryExecuteSql(t, dbInfo, 'SELECT COUNT(key) as c FROM ' + dbInfo.storeName, [], function (t, results) {\n                    var result = results.rows.item(0).c;\n                    resolve(result);\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Return the key located at key index X; essentially gets the key from a\n// `WHERE id = ?`. This is the most efficient way I can think to implement\n// this rarely-used (in my experience) part of the API, but it can seem\n// inconsistent, because we do `INSERT OR REPLACE INTO` on `setItem()`, so\n// the ID of each key will change every time it's updated. Perhaps a stored\n// procedure for the `setItem()` SQL would solve this problem?\n// TODO: Don't change ID on `setItem()`.\nfunction key$1(n, callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n            dbInfo.db.transaction(function (t) {\n                tryExecuteSql(t, dbInfo, 'SELECT key FROM ' + dbInfo.storeName + ' WHERE id = ? LIMIT 1', [n + 1], function (t, results) {\n                    var result = results.rows.length ? results.rows.item(0).key : null;\n                    resolve(result);\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction keys$1(callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n            dbInfo.db.transaction(function (t) {\n                tryExecuteSql(t, dbInfo, 'SELECT key FROM ' + dbInfo.storeName, [], function (t, results) {\n                    var keys = [];\n\n                    for (var i = 0; i < results.rows.length; i++) {\n                        keys.push(results.rows.item(i).key);\n                    }\n\n                    resolve(keys);\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// https://www.w3.org/TR/webdatabase/#databases\n// > There is no way to enumerate or delete the databases available for an origin from this API.\nfunction getAllStoreNames(db) {\n    return new Promise$1(function (resolve, reject) {\n        db.transaction(function (t) {\n            t.executeSql('SELECT name FROM sqlite_master ' + \"WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'\", [], function (t, results) {\n                var storeNames = [];\n\n                for (var i = 0; i < results.rows.length; i++) {\n                    storeNames.push(results.rows.item(i).name);\n                }\n\n                resolve({\n                    db: db,\n                    storeNames: storeNames\n                });\n            }, function (t, error) {\n                reject(error);\n            });\n        }, function (sqlError) {\n            reject(sqlError);\n        });\n    });\n}\n\nfunction dropInstance$1(options, callback) {\n    callback = getCallback.apply(this, arguments);\n\n    var currentConfig = this.config();\n    options = typeof options !== 'function' && options || {};\n    if (!options.name) {\n        options.name = options.name || currentConfig.name;\n        options.storeName = options.storeName || currentConfig.storeName;\n    }\n\n    var self = this;\n    var promise;\n    if (!options.name) {\n        promise = Promise$1.reject('Invalid arguments');\n    } else {\n        promise = new Promise$1(function (resolve) {\n            var db;\n            if (options.name === currentConfig.name) {\n                // use the db reference of the current instance\n                db = self._dbInfo.db;\n            } else {\n                db = openDatabase(options.name, '', '', 0);\n            }\n\n            if (!options.storeName) {\n                // drop all database tables\n                resolve(getAllStoreNames(db));\n            } else {\n                resolve({\n                    db: db,\n                    storeNames: [options.storeName]\n                });\n            }\n        }).then(function (operationInfo) {\n            return new Promise$1(function (resolve, reject) {\n                operationInfo.db.transaction(function (t) {\n                    function dropTable(storeName) {\n                        return new Promise$1(function (resolve, reject) {\n                            t.executeSql('DROP TABLE IF EXISTS ' + storeName, [], function () {\n                                resolve();\n                            }, function (t, error) {\n                                reject(error);\n                            });\n                        });\n                    }\n\n                    var operations = [];\n                    for (var i = 0, len = operationInfo.storeNames.length; i < len; i++) {\n                        operations.push(dropTable(operationInfo.storeNames[i]));\n                    }\n\n                    Promise$1.all(operations).then(function () {\n                        resolve();\n                    })[\"catch\"](function (e) {\n                        reject(e);\n                    });\n                }, function (sqlError) {\n                    reject(sqlError);\n                });\n            });\n        });\n    }\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nvar webSQLStorage = {\n    _driver: 'webSQLStorage',\n    _initStorage: _initStorage$1,\n    _support: isWebSQLValid(),\n    iterate: iterate$1,\n    getItem: getItem$1,\n    setItem: setItem$1,\n    removeItem: removeItem$1,\n    clear: clear$1,\n    length: length$1,\n    key: key$1,\n    keys: keys$1,\n    dropInstance: dropInstance$1\n};\n\nfunction isLocalStorageValid() {\n    try {\n        return typeof localStorage !== 'undefined' && 'setItem' in localStorage &&\n        // in IE8 typeof localStorage.setItem === 'object'\n        !!localStorage.setItem;\n    } catch (e) {\n        return false;\n    }\n}\n\nfunction _getKeyPrefix(options, defaultConfig) {\n    var keyPrefix = options.name + '/';\n\n    if (options.storeName !== defaultConfig.storeName) {\n        keyPrefix += options.storeName + '/';\n    }\n    return keyPrefix;\n}\n\n// Check if localStorage throws when saving an item\nfunction checkIfLocalStorageThrows() {\n    var localStorageTestKey = '_localforage_support_test';\n\n    try {\n        localStorage.setItem(localStorageTestKey, true);\n        localStorage.removeItem(localStorageTestKey);\n\n        return false;\n    } catch (e) {\n        return true;\n    }\n}\n\n// Check if localStorage is usable and allows to save an item\n// This method checks if localStorage is usable in Safari Private Browsing\n// mode, or in any other case where the available quota for localStorage\n// is 0 and there wasn't any saved items yet.\nfunction _isLocalStorageUsable() {\n    return !checkIfLocalStorageThrows() || localStorage.length > 0;\n}\n\n// Config the localStorage backend, using options set in the config.\nfunction _initStorage$2(options) {\n    var self = this;\n    var dbInfo = {};\n    if (options) {\n        for (var i in options) {\n            dbInfo[i] = options[i];\n        }\n    }\n\n    dbInfo.keyPrefix = _getKeyPrefix(options, self._defaultConfig);\n\n    if (!_isLocalStorageUsable()) {\n        return Promise$1.reject();\n    }\n\n    self._dbInfo = dbInfo;\n    dbInfo.serializer = localforageSerializer;\n\n    return Promise$1.resolve();\n}\n\n// Remove all keys from the datastore, effectively destroying all data in\n// the app's key/value store!\nfunction clear$2(callback) {\n    var self = this;\n    var promise = self.ready().then(function () {\n        var keyPrefix = self._dbInfo.keyPrefix;\n\n        for (var i = localStorage.length - 1; i >= 0; i--) {\n            var key = localStorage.key(i);\n\n            if (key.indexOf(keyPrefix) === 0) {\n                localStorage.removeItem(key);\n            }\n        }\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Retrieve an item from the store. Unlike the original async_storage\n// library in Gaia, we don't modify return values at all. If a key's value\n// is `undefined`, we pass that value to the callback function.\nfunction getItem$2(key, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = self.ready().then(function () {\n        var dbInfo = self._dbInfo;\n        var result = localStorage.getItem(dbInfo.keyPrefix + key);\n\n        // If a result was found, parse it from the serialized\n        // string into a JS object. If result isn't truthy, the key\n        // is likely undefined and we'll pass it straight to the\n        // callback.\n        if (result) {\n            result = dbInfo.serializer.deserialize(result);\n        }\n\n        return result;\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Iterate over all items in the store.\nfunction iterate$2(iterator, callback) {\n    var self = this;\n\n    var promise = self.ready().then(function () {\n        var dbInfo = self._dbInfo;\n        var keyPrefix = dbInfo.keyPrefix;\n        var keyPrefixLength = keyPrefix.length;\n        var length = localStorage.length;\n\n        // We use a dedicated iterator instead of the `i` variable below\n        // so other keys we fetch in localStorage aren't counted in\n        // the `iterationNumber` argument passed to the `iterate()`\n        // callback.\n        //\n        // See: github.com/mozilla/localForage/pull/435#discussion_r38061530\n        var iterationNumber = 1;\n\n        for (var i = 0; i < length; i++) {\n            var key = localStorage.key(i);\n            if (key.indexOf(keyPrefix) !== 0) {\n                continue;\n            }\n            var value = localStorage.getItem(key);\n\n            // If a result was found, parse it from the serialized\n            // string into a JS object. If result isn't truthy, the\n            // key is likely undefined and we'll pass it straight\n            // to the iterator.\n            if (value) {\n                value = dbInfo.serializer.deserialize(value);\n            }\n\n            value = iterator(value, key.substring(keyPrefixLength), iterationNumber++);\n\n            if (value !== void 0) {\n                return value;\n            }\n        }\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Same as localStorage's key() method, except takes a callback.\nfunction key$2(n, callback) {\n    var self = this;\n    var promise = self.ready().then(function () {\n        var dbInfo = self._dbInfo;\n        var result;\n        try {\n            result = localStorage.key(n);\n        } catch (error) {\n            result = null;\n        }\n\n        // Remove the prefix from the key, if a key is found.\n        if (result) {\n            result = result.substring(dbInfo.keyPrefix.length);\n        }\n\n        return result;\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction keys$2(callback) {\n    var self = this;\n    var promise = self.ready().then(function () {\n        var dbInfo = self._dbInfo;\n        var length = localStorage.length;\n        var keys = [];\n\n        for (var i = 0; i < length; i++) {\n            var itemKey = localStorage.key(i);\n            if (itemKey.indexOf(dbInfo.keyPrefix) === 0) {\n                keys.push(itemKey.substring(dbInfo.keyPrefix.length));\n            }\n        }\n\n        return keys;\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Supply the number of keys in the datastore to the callback function.\nfunction length$2(callback) {\n    var self = this;\n    var promise = self.keys().then(function (keys) {\n        return keys.length;\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Remove an item from the store, nice and simple.\nfunction removeItem$2(key, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = self.ready().then(function () {\n        var dbInfo = self._dbInfo;\n        localStorage.removeItem(dbInfo.keyPrefix + key);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Set a key's value and run an optional callback once the value is set.\n// Unlike Gaia's implementation, the callback function is passed the value,\n// in case you want to operate on that value only after you're sure it\n// saved, or something like that.\nfunction setItem$2(key, value, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = self.ready().then(function () {\n        // Convert undefined values to null.\n        // https://github.com/mozilla/localForage/pull/42\n        if (value === undefined) {\n            value = null;\n        }\n\n        // Save the original value to pass to the callback.\n        var originalValue = value;\n\n        return new Promise$1(function (resolve, reject) {\n            var dbInfo = self._dbInfo;\n            dbInfo.serializer.serialize(value, function (value, error) {\n                if (error) {\n                    reject(error);\n                } else {\n                    try {\n                        localStorage.setItem(dbInfo.keyPrefix + key, value);\n                        resolve(originalValue);\n                    } catch (e) {\n                        // localStorage capacity exceeded.\n                        // TODO: Make this a specific error/event.\n                        if (e.name === 'QuotaExceededError' || e.name === 'NS_ERROR_DOM_QUOTA_REACHED') {\n                            reject(e);\n                        }\n                        reject(e);\n                    }\n                }\n            });\n        });\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction dropInstance$2(options, callback) {\n    callback = getCallback.apply(this, arguments);\n\n    options = typeof options !== 'function' && options || {};\n    if (!options.name) {\n        var currentConfig = this.config();\n        options.name = options.name || currentConfig.name;\n        options.storeName = options.storeName || currentConfig.storeName;\n    }\n\n    var self = this;\n    var promise;\n    if (!options.name) {\n        promise = Promise$1.reject('Invalid arguments');\n    } else {\n        promise = new Promise$1(function (resolve) {\n            if (!options.storeName) {\n                resolve(options.name + '/');\n            } else {\n                resolve(_getKeyPrefix(options, self._defaultConfig));\n            }\n        }).then(function (keyPrefix) {\n            for (var i = localStorage.length - 1; i >= 0; i--) {\n                var key = localStorage.key(i);\n\n                if (key.indexOf(keyPrefix) === 0) {\n                    localStorage.removeItem(key);\n                }\n            }\n        });\n    }\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nvar localStorageWrapper = {\n    _driver: 'localStorageWrapper',\n    _initStorage: _initStorage$2,\n    _support: isLocalStorageValid(),\n    iterate: iterate$2,\n    getItem: getItem$2,\n    setItem: setItem$2,\n    removeItem: removeItem$2,\n    clear: clear$2,\n    length: length$2,\n    key: key$2,\n    keys: keys$2,\n    dropInstance: dropInstance$2\n};\n\nvar sameValue = function sameValue(x, y) {\n    return x === y || typeof x === 'number' && typeof y === 'number' && isNaN(x) && isNaN(y);\n};\n\nvar includes = function includes(array, searchElement) {\n    var len = array.length;\n    var i = 0;\n    while (i < len) {\n        if (sameValue(array[i], searchElement)) {\n            return true;\n        }\n        i++;\n    }\n\n    return false;\n};\n\nvar isArray = Array.isArray || function (arg) {\n    return Object.prototype.toString.call(arg) === '[object Array]';\n};\n\n// Drivers are stored here when `defineDriver()` is called.\n// They are shared across all instances of localForage.\nvar DefinedDrivers = {};\n\nvar DriverSupport = {};\n\nvar DefaultDrivers = {\n    INDEXEDDB: asyncStorage,\n    WEBSQL: webSQLStorage,\n    LOCALSTORAGE: localStorageWrapper\n};\n\nvar DefaultDriverOrder = [DefaultDrivers.INDEXEDDB._driver, DefaultDrivers.WEBSQL._driver, DefaultDrivers.LOCALSTORAGE._driver];\n\nvar OptionalDriverMethods = ['dropInstance'];\n\nvar LibraryMethods = ['clear', 'getItem', 'iterate', 'key', 'keys', 'length', 'removeItem', 'setItem'].concat(OptionalDriverMethods);\n\nvar DefaultConfig = {\n    description: '',\n    driver: DefaultDriverOrder.slice(),\n    name: 'localforage',\n    // Default DB size is _JUST UNDER_ 5MB, as it's the highest size\n    // we can use without a prompt.\n    size: 4980736,\n    storeName: 'keyvaluepairs',\n    version: 1.0\n};\n\nfunction callWhenReady(localForageInstance, libraryMethod) {\n    localForageInstance[libraryMethod] = function () {\n        var _args = arguments;\n        return localForageInstance.ready().then(function () {\n            return localForageInstance[libraryMethod].apply(localForageInstance, _args);\n        });\n    };\n}\n\nfunction extend() {\n    for (var i = 1; i < arguments.length; i++) {\n        var arg = arguments[i];\n\n        if (arg) {\n            for (var _key in arg) {\n                if (arg.hasOwnProperty(_key)) {\n                    if (isArray(arg[_key])) {\n                        arguments[0][_key] = arg[_key].slice();\n                    } else {\n                        arguments[0][_key] = arg[_key];\n                    }\n                }\n            }\n        }\n    }\n\n    return arguments[0];\n}\n\nvar LocalForage = function () {\n    function LocalForage(options) {\n        _classCallCheck(this, LocalForage);\n\n        for (var driverTypeKey in DefaultDrivers) {\n            if (DefaultDrivers.hasOwnProperty(driverTypeKey)) {\n                var driver = DefaultDrivers[driverTypeKey];\n                var driverName = driver._driver;\n                this[driverTypeKey] = driverName;\n\n                if (!DefinedDrivers[driverName]) {\n                    // we don't need to wait for the promise,\n                    // since the default drivers can be defined\n                    // in a blocking manner\n                    this.defineDriver(driver);\n                }\n            }\n        }\n\n        this._defaultConfig = extend({}, DefaultConfig);\n        this._config = extend({}, this._defaultConfig, options);\n        this._driverSet = null;\n        this._initDriver = null;\n        this._ready = false;\n        this._dbInfo = null;\n\n        this._wrapLibraryMethodsWithReady();\n        this.setDriver(this._config.driver)[\"catch\"](function () {});\n    }\n\n    // Set any config values for localForage; can be called anytime before\n    // the first API call (e.g. `getItem`, `setItem`).\n    // We loop through options so we don't overwrite existing config\n    // values.\n\n\n    LocalForage.prototype.config = function config(options) {\n        // If the options argument is an object, we use it to set values.\n        // Otherwise, we return either a specified config value or all\n        // config values.\n        if ((typeof options === 'undefined' ? 'undefined' : _typeof(options)) === 'object') {\n            // If localforage is ready and fully initialized, we can't set\n            // any new configuration values. Instead, we return an error.\n            if (this._ready) {\n                return new Error(\"Can't call config() after localforage \" + 'has been used.');\n            }\n\n            for (var i in options) {\n                if (i === 'storeName') {\n                    options[i] = options[i].replace(/\\W/g, '_');\n                }\n\n                if (i === 'version' && typeof options[i] !== 'number') {\n                    return new Error('Database version must be a number.');\n                }\n\n                this._config[i] = options[i];\n            }\n\n            // after all config options are set and\n            // the driver option is used, try setting it\n            if ('driver' in options && options.driver) {\n                return this.setDriver(this._config.driver);\n            }\n\n            return true;\n        } else if (typeof options === 'string') {\n            return this._config[options];\n        } else {\n            return this._config;\n        }\n    };\n\n    // Used to define a custom driver, shared across all instances of\n    // localForage.\n\n\n    LocalForage.prototype.defineDriver = function defineDriver(driverObject, callback, errorCallback) {\n        var promise = new Promise$1(function (resolve, reject) {\n            try {\n                var driverName = driverObject._driver;\n                var complianceError = new Error('Custom driver not compliant; see ' + 'https://mozilla.github.io/localForage/#definedriver');\n\n                // A driver name should be defined and not overlap with the\n                // library-defined, default drivers.\n                if (!driverObject._driver) {\n                    reject(complianceError);\n                    return;\n                }\n\n                var driverMethods = LibraryMethods.concat('_initStorage');\n                for (var i = 0, len = driverMethods.length; i < len; i++) {\n                    var driverMethodName = driverMethods[i];\n\n                    // when the property is there,\n                    // it should be a method even when optional\n                    var isRequired = !includes(OptionalDriverMethods, driverMethodName);\n                    if ((isRequired || driverObject[driverMethodName]) && typeof driverObject[driverMethodName] !== 'function') {\n                        reject(complianceError);\n                        return;\n                    }\n                }\n\n                var configureMissingMethods = function configureMissingMethods() {\n                    var methodNotImplementedFactory = function methodNotImplementedFactory(methodName) {\n                        return function () {\n                            var error = new Error('Method ' + methodName + ' is not implemented by the current driver');\n                            var promise = Promise$1.reject(error);\n                            executeCallback(promise, arguments[arguments.length - 1]);\n                            return promise;\n                        };\n                    };\n\n                    for (var _i = 0, _len = OptionalDriverMethods.length; _i < _len; _i++) {\n                        var optionalDriverMethod = OptionalDriverMethods[_i];\n                        if (!driverObject[optionalDriverMethod]) {\n                            driverObject[optionalDriverMethod] = methodNotImplementedFactory(optionalDriverMethod);\n                        }\n                    }\n                };\n\n                configureMissingMethods();\n\n                var setDriverSupport = function setDriverSupport(support) {\n                    if (DefinedDrivers[driverName]) {\n                        console.info('Redefining LocalForage driver: ' + driverName);\n                    }\n                    DefinedDrivers[driverName] = driverObject;\n                    DriverSupport[driverName] = support;\n                    // don't use a then, so that we can define\n                    // drivers that have simple _support methods\n                    // in a blocking manner\n                    resolve();\n                };\n\n                if ('_support' in driverObject) {\n                    if (driverObject._support && typeof driverObject._support === 'function') {\n                        driverObject._support().then(setDriverSupport, reject);\n                    } else {\n                        setDriverSupport(!!driverObject._support);\n                    }\n                } else {\n                    setDriverSupport(true);\n                }\n            } catch (e) {\n                reject(e);\n            }\n        });\n\n        executeTwoCallbacks(promise, callback, errorCallback);\n        return promise;\n    };\n\n    LocalForage.prototype.driver = function driver() {\n        return this._driver || null;\n    };\n\n    LocalForage.prototype.getDriver = function getDriver(driverName, callback, errorCallback) {\n        var getDriverPromise = DefinedDrivers[driverName] ? Promise$1.resolve(DefinedDrivers[driverName]) : Promise$1.reject(new Error('Driver not found.'));\n\n        executeTwoCallbacks(getDriverPromise, callback, errorCallback);\n        return getDriverPromise;\n    };\n\n    LocalForage.prototype.getSerializer = function getSerializer(callback) {\n        var serializerPromise = Promise$1.resolve(localforageSerializer);\n        executeTwoCallbacks(serializerPromise, callback);\n        return serializerPromise;\n    };\n\n    LocalForage.prototype.ready = function ready(callback) {\n        var self = this;\n\n        var promise = self._driverSet.then(function () {\n            if (self._ready === null) {\n                self._ready = self._initDriver();\n            }\n\n            return self._ready;\n        });\n\n        executeTwoCallbacks(promise, callback, callback);\n        return promise;\n    };\n\n    LocalForage.prototype.setDriver = function setDriver(drivers, callback, errorCallback) {\n        var self = this;\n\n        if (!isArray(drivers)) {\n            drivers = [drivers];\n        }\n\n        var supportedDrivers = this._getSupportedDrivers(drivers);\n\n        function setDriverToConfig() {\n            self._config.driver = self.driver();\n        }\n\n        function extendSelfWithDriver(driver) {\n            self._extend(driver);\n            setDriverToConfig();\n\n            self._ready = self._initStorage(self._config);\n            return self._ready;\n        }\n\n        function initDriver(supportedDrivers) {\n            return function () {\n                var currentDriverIndex = 0;\n\n                function driverPromiseLoop() {\n                    while (currentDriverIndex < supportedDrivers.length) {\n                        var driverName = supportedDrivers[currentDriverIndex];\n                        currentDriverIndex++;\n\n                        self._dbInfo = null;\n                        self._ready = null;\n\n                        return self.getDriver(driverName).then(extendSelfWithDriver)[\"catch\"](driverPromiseLoop);\n                    }\n\n                    setDriverToConfig();\n                    var error = new Error('No available storage method found.');\n                    self._driverSet = Promise$1.reject(error);\n                    return self._driverSet;\n                }\n\n                return driverPromiseLoop();\n            };\n        }\n\n        // There might be a driver initialization in progress\n        // so wait for it to finish in order to avoid a possible\n        // race condition to set _dbInfo\n        var oldDriverSetDone = this._driverSet !== null ? this._driverSet[\"catch\"](function () {\n            return Promise$1.resolve();\n        }) : Promise$1.resolve();\n\n        this._driverSet = oldDriverSetDone.then(function () {\n            var driverName = supportedDrivers[0];\n            self._dbInfo = null;\n            self._ready = null;\n\n            return self.getDriver(driverName).then(function (driver) {\n                self._driver = driver._driver;\n                setDriverToConfig();\n                self._wrapLibraryMethodsWithReady();\n                self._initDriver = initDriver(supportedDrivers);\n            });\n        })[\"catch\"](function () {\n            setDriverToConfig();\n            var error = new Error('No available storage method found.');\n            self._driverSet = Promise$1.reject(error);\n            return self._driverSet;\n        });\n\n        executeTwoCallbacks(this._driverSet, callback, errorCallback);\n        return this._driverSet;\n    };\n\n    LocalForage.prototype.supports = function supports(driverName) {\n        return !!DriverSupport[driverName];\n    };\n\n    LocalForage.prototype._extend = function _extend(libraryMethodsAndProperties) {\n        extend(this, libraryMethodsAndProperties);\n    };\n\n    LocalForage.prototype._getSupportedDrivers = function _getSupportedDrivers(drivers) {\n        var supportedDrivers = [];\n        for (var i = 0, len = drivers.length; i < len; i++) {\n            var driverName = drivers[i];\n            if (this.supports(driverName)) {\n                supportedDrivers.push(driverName);\n            }\n        }\n        return supportedDrivers;\n    };\n\n    LocalForage.prototype._wrapLibraryMethodsWithReady = function _wrapLibraryMethodsWithReady() {\n        // Add a stub for each driver API method that delays the call to the\n        // corresponding driver method until localForage is ready. These stubs\n        // will be replaced by the driver methods as soon as the driver is\n        // loaded, so there is no performance impact.\n        for (var i = 0, len = LibraryMethods.length; i < len; i++) {\n            callWhenReady(this, LibraryMethods[i]);\n        }\n    };\n\n    LocalForage.prototype.createInstance = function createInstance(options) {\n        return new LocalForage(options);\n    };\n\n    return LocalForage;\n}();\n\n// The actual localForage object that we expose as a module or via a\n// global. It's extended by pulling in one of our other libraries.\n\n\nvar localforage_js = new LocalForage();\n\nmodule.exports = localforage_js;\n\n},{\"3\":3}]},{},[4])(4)\n});\n","/**\n * Self-balancing binary search tree using the AVL implementation\n */\nvar BinarySearchTree = require('./bst')\n  , customUtils = require('./customUtils')\n  , util = require('util')\n  , _ = require('underscore')\n  ;\n\n\n/**\n * Constructor\n * We can't use a direct pointer to the root node (as in the simple binary search tree)\n * as the root will change during tree rotations\n * @param {Boolean}  options.unique Whether to enforce a 'unique' constraint on the key or not\n * @param {Function} options.compareKeys Initialize this BST's compareKeys\n */\nfunction AVLTree (options) {\n  this.tree = new _AVLTree(options);\n}\n\n\n/**\n * Constructor of the internal AVLTree\n * @param {Object} options Optional\n * @param {Boolean}  options.unique Whether to enforce a 'unique' constraint on the key or not\n * @param {Key}      options.key Initialize this BST's key with key\n * @param {Value}    options.value Initialize this BST's data with [value]\n * @param {Function} options.compareKeys Initialize this BST's compareKeys\n */\nfunction _AVLTree (options) {\n  options = options || {};\n\n  this.left = null;\n  this.right = null;\n  this.parent = options.parent !== undefined ? options.parent : null;\n  if (options.hasOwnProperty('key')) { this.key = options.key; }\n  this.data = options.hasOwnProperty('value') ? [options.value] : [];\n  this.unique = options.unique || false;\n\n  this.compareKeys = options.compareKeys || customUtils.defaultCompareKeysFunction;\n  this.checkValueEquality = options.checkValueEquality || customUtils.defaultCheckValueEquality;\n}\n\n\n/**\n * Inherit basic functions from the basic binary search tree\n */\nutil.inherits(_AVLTree, BinarySearchTree);\n\n/**\n * Keep a pointer to the internal tree constructor for testing purposes\n */\nAVLTree._AVLTree = _AVLTree;\n\n\n/**\n * Check the recorded height is correct for every node\n * Throws if one height doesn't match\n */\n_AVLTree.prototype.checkHeightCorrect = function () {\n  var leftH, rightH;\n\n  if (!this.hasOwnProperty('key')) { return; }   // Empty tree\n\n  if (this.left && this.left.height === undefined) { throw new Error(\"Undefined height for node \" + this.left.key); }\n  if (this.right && this.right.height === undefined) { throw new Error(\"Undefined height for node \" + this.right.key); }\n  if (this.height === undefined) { throw new Error(\"Undefined height for node \" + this.key); }\n\n  leftH = this.left ? this.left.height : 0;\n  rightH = this.right ? this.right.height : 0;\n\n  if (this.height !== 1 + Math.max(leftH, rightH)) { throw new Error(\"Height constraint failed for node \" + this.key); }\n  if (this.left) { this.left.checkHeightCorrect(); }\n  if (this.right) { this.right.checkHeightCorrect(); }\n};\n\n\n/**\n * Return the balance factor\n */\n_AVLTree.prototype.balanceFactor = function () {\n  var leftH = this.left ? this.left.height : 0\n    , rightH = this.right ? this.right.height : 0\n    ;\n  return leftH - rightH;\n};\n\n\n/**\n * Check that the balance factors are all between -1 and 1\n */\n_AVLTree.prototype.checkBalanceFactors = function () {\n  if (Math.abs(this.balanceFactor()) > 1) { throw new Error('Tree is unbalanced at node ' + this.key); }\n\n  if (this.left) { this.left.checkBalanceFactors(); }\n  if (this.right) { this.right.checkBalanceFactors(); }\n};\n\n\n/**\n * When checking if the BST conditions are met, also check that the heights are correct\n * and the tree is balanced\n */\n_AVLTree.prototype.checkIsAVLT = function () {\n  _AVLTree.super_.prototype.checkIsBST.call(this);\n  this.checkHeightCorrect();\n  this.checkBalanceFactors();\n};\nAVLTree.prototype.checkIsAVLT = function () { this.tree.checkIsAVLT(); };\n\n\n/**\n * Perform a right rotation of the tree if possible\n * and return the root of the resulting tree\n * The resulting tree's nodes' heights are also updated\n */\n_AVLTree.prototype.rightRotation = function () {\n  var q = this\n    , p = this.left\n    , b\n    , ah, bh, ch;\n\n  if (!p) { return this; }   // No change\n\n  b = p.right;\n\n  // Alter tree structure\n  if (q.parent) {\n    p.parent = q.parent;\n    if (q.parent.left === q) { q.parent.left = p; } else { q.parent.right = p; }\n  } else {\n    p.parent = null;\n  }\n  p.right = q;\n  q.parent = p;\n  q.left = b;\n  if (b) { b.parent = q; }\n\n  // Update heights\n  ah = p.left ? p.left.height : 0;\n  bh = b ? b.height : 0;\n  ch = q.right ? q.right.height : 0;\n  q.height = Math.max(bh, ch) + 1;\n  p.height = Math.max(ah, q.height) + 1;\n\n  return p;\n};\n\n\n/**\n * Perform a left rotation of the tree if possible\n * and return the root of the resulting tree\n * The resulting tree's nodes' heights are also updated\n */\n_AVLTree.prototype.leftRotation = function () {\n  var p = this\n    , q = this.right\n    , b\n    , ah, bh, ch;\n\n  if (!q) { return this; }   // No change\n\n  b = q.left;\n\n  // Alter tree structure\n  if (p.parent) {\n    q.parent = p.parent;\n    if (p.parent.left === p) { p.parent.left = q; } else { p.parent.right = q; }\n  } else {\n    q.parent = null;\n  }\n  q.left = p;\n  p.parent = q;\n  p.right = b;\n  if (b) { b.parent = p; }\n\n  // Update heights\n  ah = p.left ? p.left.height : 0;\n  bh = b ? b.height : 0;\n  ch = q.right ? q.right.height : 0;\n  p.height = Math.max(ah, bh) + 1;\n  q.height = Math.max(ch, p.height) + 1;\n\n  return q;\n};\n\n\n/**\n * Modify the tree if its right subtree is too small compared to the left\n * Return the new root if any\n */\n_AVLTree.prototype.rightTooSmall = function () {\n  if (this.balanceFactor() <= 1) { return this; }   // Right is not too small, don't change\n\n  if (this.left.balanceFactor() < 0) {\n    this.left.leftRotation();\n  }\n\n  return this.rightRotation();\n};\n\n\n/**\n * Modify the tree if its left subtree is too small compared to the right\n * Return the new root if any\n */\n_AVLTree.prototype.leftTooSmall = function () {\n  if (this.balanceFactor() >= -1) { return this; }   // Left is not too small, don't change\n\n  if (this.right.balanceFactor() > 0) {\n    this.right.rightRotation();\n  }\n\n  return this.leftRotation();\n};\n\n\n/**\n * Rebalance the tree along the given path. The path is given reversed (as he was calculated\n * in the insert and delete functions).\n * Returns the new root of the tree\n * Of course, the first element of the path must be the root of the tree\n */\n_AVLTree.prototype.rebalanceAlongPath = function (path) {\n  var newRoot = this\n    , rotated\n    , i;\n\n  if (!this.hasOwnProperty('key')) { delete this.height; return this; }   // Empty tree\n\n  // Rebalance the tree and update all heights\n  for (i = path.length - 1; i >= 0; i -= 1) {\n    path[i].height = 1 + Math.max(path[i].left ? path[i].left.height : 0, path[i].right ? path[i].right.height : 0);\n\n    if (path[i].balanceFactor() > 1) {\n      rotated = path[i].rightTooSmall();\n      if (i === 0) { newRoot = rotated; }\n    }\n\n    if (path[i].balanceFactor() < -1) {\n      rotated = path[i].leftTooSmall();\n      if (i === 0) { newRoot = rotated; }\n    }\n  }\n\n  return newRoot;\n};\n\n\n/**\n * Insert a key, value pair in the tree while maintaining the AVL tree height constraint\n * Return a pointer to the root node, which may have changed\n */\n_AVLTree.prototype.insert = function (key, value) {\n  var insertPath = []\n    , currentNode = this\n    ;\n\n  // Empty tree, insert as root\n  if (!this.hasOwnProperty('key')) {\n    this.key = key;\n    this.data.push(value);\n    this.height = 1;\n    return this;\n  }\n\n  // Insert new leaf at the right place\n  while (true) {\n    // Same key: no change in the tree structure\n    if (currentNode.compareKeys(currentNode.key, key) === 0) {\n      if (currentNode.unique) {\n        var err = new Error(\"Can't insert key \" + key + \", it violates the unique constraint\");\n        err.key = key;\n        err.errorType = 'uniqueViolated';\n        throw err;\n      } else {\n        currentNode.data.push(value);\n      }\n      return this;\n    }\n\n    insertPath.push(currentNode);\n\n    if (currentNode.compareKeys(key, currentNode.key) < 0) {\n      if (!currentNode.left) {\n        insertPath.push(currentNode.createLeftChild({ key: key, value: value }));\n        break;\n      } else {\n        currentNode = currentNode.left;\n      }\n    } else {\n      if (!currentNode.right) {\n        insertPath.push(currentNode.createRightChild({ key: key, value: value }));\n        break;\n      } else {\n        currentNode = currentNode.right;\n      }\n    }\n  }\n\n  return this.rebalanceAlongPath(insertPath);\n};\n\n// Insert in the internal tree, update the pointer to the root if needed\nAVLTree.prototype.insert = function (key, value) {\n  var newTree = this.tree.insert(key, value);\n\n  // If newTree is undefined, that means its structure was not modified\n  if (newTree) { this.tree = newTree; }\n};\n\n\n/**\n * Delete a key or just a value and return the new root of the tree\n * @param {Key} key\n * @param {Value} value Optional. If not set, the whole key is deleted. If set, only this value is deleted\n */\n_AVLTree.prototype.delete = function (key, value) {\n  var newData = [], replaceWith\n    , self = this\n    , currentNode = this\n    , deletePath = []\n    ;\n\n  if (!this.hasOwnProperty('key')) { return this; }   // Empty tree\n\n  // Either no match is found and the function will return from within the loop\n  // Or a match is found and deletePath will contain the path from the root to the node to delete after the loop\n  while (true) {\n    if (currentNode.compareKeys(key, currentNode.key) === 0) { break; }\n\n    deletePath.push(currentNode);\n\n    if (currentNode.compareKeys(key, currentNode.key) < 0) {\n      if (currentNode.left) {\n        currentNode = currentNode.left;\n      } else {\n        return this;   // Key not found, no modification\n      }\n    } else {\n      // currentNode.compareKeys(key, currentNode.key) is > 0\n      if (currentNode.right) {\n        currentNode = currentNode.right;\n      } else {\n        return this;   // Key not found, no modification\n      }\n    }\n  }\n\n  // Delete only a value (no tree modification)\n  if (currentNode.data.length > 1 && value) {\n    currentNode.data.forEach(function (d) {\n      if (!currentNode.checkValueEquality(d, value)) { newData.push(d); }\n    });\n    currentNode.data = newData;\n    return this;\n  }\n\n  // Delete a whole node\n\n  // Leaf\n  if (!currentNode.left && !currentNode.right) {\n    if (currentNode === this) {   // This leaf is also the root\n      delete currentNode.key;\n      currentNode.data = [];\n      delete currentNode.height;\n      return this;\n    } else {\n      if (currentNode.parent.left === currentNode) {\n        currentNode.parent.left = null;\n      } else {\n        currentNode.parent.right = null;\n      }\n      return this.rebalanceAlongPath(deletePath);\n    }\n  }\n\n\n  // Node with only one child\n  if (!currentNode.left || !currentNode.right) {\n    replaceWith = currentNode.left ? currentNode.left : currentNode.right;\n\n    if (currentNode === this) {   // This node is also the root\n      replaceWith.parent = null;\n      return replaceWith;   // height of replaceWith is necessarily 1 because the tree was balanced before deletion\n    } else {\n      if (currentNode.parent.left === currentNode) {\n        currentNode.parent.left = replaceWith;\n        replaceWith.parent = currentNode.parent;\n      } else {\n        currentNode.parent.right = replaceWith;\n        replaceWith.parent = currentNode.parent;\n      }\n\n      return this.rebalanceAlongPath(deletePath);\n    }\n  }\n\n\n  // Node with two children\n  // Use the in-order predecessor (no need to randomize since we actively rebalance)\n  deletePath.push(currentNode);\n  replaceWith = currentNode.left;\n\n  // Special case: the in-order predecessor is right below the node to delete\n  if (!replaceWith.right) {\n    currentNode.key = replaceWith.key;\n    currentNode.data = replaceWith.data;\n    currentNode.left = replaceWith.left;\n    if (replaceWith.left) { replaceWith.left.parent = currentNode; }\n    return this.rebalanceAlongPath(deletePath);\n  }\n\n  // After this loop, replaceWith is the right-most leaf in the left subtree\n  // and deletePath the path from the root (inclusive) to replaceWith (exclusive)\n  while (true) {\n    if (replaceWith.right) {\n      deletePath.push(replaceWith);\n      replaceWith = replaceWith.right;\n    } else {\n      break;\n    }\n  }\n\n  currentNode.key = replaceWith.key;\n  currentNode.data = replaceWith.data;\n\n  replaceWith.parent.right = replaceWith.left;\n  if (replaceWith.left) { replaceWith.left.parent = replaceWith.parent; }\n\n  return this.rebalanceAlongPath(deletePath);\n};\n\n// Delete a value\nAVLTree.prototype.delete = function (key, value) {\n  var newTree = this.tree.delete(key, value);\n\n  // If newTree is undefined, that means its structure was not modified\n  if (newTree) { this.tree = newTree; }\n};\n\n\n/**\n * Other functions we want to use on an AVLTree as if it were the internal _AVLTree\n */\n['getNumberOfKeys', 'search', 'betweenBounds', 'prettyPrint', 'executeOnEveryNode'].forEach(function (fn) {\n  AVLTree.prototype[fn] = function () {\n    return this.tree[fn].apply(this.tree, arguments);\n  };\n});\n\n\n// Interface\nmodule.exports = AVLTree;\n","'use strict';\nvar fails = require('../internals/fails');\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call,no-throw-literal\n    method.call(null, argument || function () { throw 1; }, 1);\n  });\n};\n","var BinarySearchTree = require('binary-search-tree').AVLTree\n  , model = require('./model')\n  , _ = require('underscore')\n  , util = require('util')\n  ;\n\n/**\n * Two indexed pointers are equal iif they point to the same place\n */\nfunction checkValueEquality (a, b) {\n  return a === b;\n}\n\n/**\n * Type-aware projection\n */\nfunction projectForUnique (elt) {\n  if (elt === null) { return '$null'; }\n  if (typeof elt === 'string') { return '$string' + elt; }\n  if (typeof elt === 'boolean') { return '$boolean' + elt; }\n  if (typeof elt === 'number') { return '$number' + elt; }\n  if (util.isArray(elt)) { return '$date' + elt.getTime(); }\n\n  return elt;   // Arrays and objects, will check for pointer equality\n}\n\n\n/**\n * Create a new index\n * All methods on an index guarantee that either the whole operation was successful and the index changed\n * or the operation was unsuccessful and an error is thrown while the index is unchanged\n * @param {String} options.fieldName On which field should the index apply (can use dot notation to index on sub fields)\n * @param {Boolean} options.unique Optional, enforce a unique constraint (default: false)\n * @param {Boolean} options.sparse Optional, allow a sparse index (we can have documents for which fieldName is undefined) (default: false)\n */\nfunction Index (options) {\n  this.fieldName = options.fieldName;\n  this.unique = options.unique || false;\n  this.sparse = options.sparse || false;\n\n  this.treeOptions = { unique: this.unique, compareKeys: model.compareThings, checkValueEquality: checkValueEquality };\n\n  this.reset();   // No data in the beginning\n}\n\n\n/**\n * Reset an index\n * @param {Document or Array of documents} newData Optional, data to initialize the index with\n *                                                 If an error is thrown during insertion, the index is not modified\n */\nIndex.prototype.reset = function (newData) {\n  this.tree = new BinarySearchTree(this.treeOptions);\n\n  if (newData) { this.insert(newData); }\n};\n\n\n/**\n * Insert a new document in the index\n * If an array is passed, we insert all its elements (if one insertion fails the index is not modified)\n * O(log(n))\n */\nIndex.prototype.insert = function (doc) {\n  var key, self = this\n    , keys, i, failingI, error\n    ;\n\n  if (util.isArray(doc)) { this.insertMultipleDocs(doc); return; }\n\n  key = model.getDotValue(doc, this.fieldName);\n\n  // We don't index documents that don't contain the field if the index is sparse\n  if (key === undefined && this.sparse) { return; }\n\n  if (!util.isArray(key)) {\n    this.tree.insert(key, doc);\n  } else {\n    // If an insert fails due to a unique constraint, roll back all inserts before it\n    keys = _.uniq(key, projectForUnique);\n\n    for (i = 0; i < keys.length; i += 1) {\n      try {\n        this.tree.insert(keys[i], doc);\n      } catch (e) {\n        error = e;\n        failingI = i;\n        break;\n      }\n    }\n\n    if (error) {\n      for (i = 0; i < failingI; i += 1) {\n        this.tree.delete(keys[i], doc);\n      }\n\n      throw error;\n    }\n  }\n};\n\n\n/**\n * Insert an array of documents in the index\n * If a constraint is violated, the changes should be rolled back and an error thrown\n *\n * @API private\n */\nIndex.prototype.insertMultipleDocs = function (docs) {\n  var i, error, failingI;\n\n  for (i = 0; i < docs.length; i += 1) {\n    try {\n      this.insert(docs[i]);\n    } catch (e) {\n      error = e;\n      failingI = i;\n      break;\n    }\n  }\n\n  if (error) {\n    for (i = 0; i < failingI; i += 1) {\n      this.remove(docs[i]);\n    }\n\n    throw error;\n  }\n};\n\n\n/**\n * Remove a document from the index\n * If an array is passed, we remove all its elements\n * The remove operation is safe with regards to the 'unique' constraint\n * O(log(n))\n */\nIndex.prototype.remove = function (doc) {\n  var key, self = this;\n\n  if (util.isArray(doc)) { doc.forEach(function (d) { self.remove(d); }); return; }\n\n  key = model.getDotValue(doc, this.fieldName);\n\n  if (key === undefined && this.sparse) { return; }\n\n  if (!util.isArray(key)) {\n    this.tree.delete(key, doc);\n  } else {\n    _.uniq(key, projectForUnique).forEach(function (_key) {\n      self.tree.delete(_key, doc);\n    });\n  }\n};\n\n\n/**\n * Update a document in the index\n * If a constraint is violated, changes are rolled back and an error thrown\n * Naive implementation, still in O(log(n))\n */\nIndex.prototype.update = function (oldDoc, newDoc) {\n  if (util.isArray(oldDoc)) { this.updateMultipleDocs(oldDoc); return; }\n\n  this.remove(oldDoc);\n\n  try {\n    this.insert(newDoc);\n  } catch (e) {\n    this.insert(oldDoc);\n    throw e;\n  }\n};\n\n\n/**\n * Update multiple documents in the index\n * If a constraint is violated, the changes need to be rolled back\n * and an error thrown\n * @param {Array of oldDoc, newDoc pairs} pairs\n *\n * @API private\n */\nIndex.prototype.updateMultipleDocs = function (pairs) {\n  var i, failingI, error;\n\n  for (i = 0; i < pairs.length; i += 1) {\n    this.remove(pairs[i].oldDoc);\n  }\n\n  for (i = 0; i < pairs.length; i += 1) {\n    try {\n      this.insert(pairs[i].newDoc);\n    } catch (e) {\n      error = e;\n      failingI = i;\n      break;\n    }\n  }\n\n  // If an error was raised, roll back changes in the inverse order\n  if (error) {\n    for (i = 0; i < failingI; i += 1) {\n      this.remove(pairs[i].newDoc);\n    }\n\n    for (i = 0; i < pairs.length; i += 1) {\n      this.insert(pairs[i].oldDoc);\n    }\n\n    throw error;\n  }\n};\n\n\n/**\n * Revert an update\n */\nIndex.prototype.revertUpdate = function (oldDoc, newDoc) {\n  var revert = [];\n\n  if (!util.isArray(oldDoc)) {\n    this.update(newDoc, oldDoc);\n  } else {\n    oldDoc.forEach(function (pair) {\n      revert.push({ oldDoc: pair.newDoc, newDoc: pair.oldDoc });\n    });\n    this.update(revert);\n  }\n};\n\n\n/**\n * Get all documents in index whose key match value (if it is a Thing) or one of the elements of value (if it is an array of Things)\n * @param {Thing} value Value to match the key against\n * @return {Array of documents}\n */\nIndex.prototype.getMatching = function (value) {\n  var self = this;\n\n  if (!util.isArray(value)) {\n    return self.tree.search(value);\n  } else {\n    var _res = {}, res = [];\n\n    value.forEach(function (v) {\n      self.getMatching(v).forEach(function (doc) {\n        _res[doc._id] = doc;\n      });\n    });\n\n    Object.keys(_res).forEach(function (_id) {\n      res.push(_res[_id]);\n    });\n\n    return res;\n  }\n};\n\n\n/**\n * Get all documents in index whose key is between bounds are they are defined by query\n * Documents are sorted by key\n * @param {Query} query\n * @return {Array of documents}\n */\nIndex.prototype.getBetweenBounds = function (query) {\n  return this.tree.betweenBounds(query);\n};\n\n\n/**\n * Get all elements in the index\n * @return {Array of documents}\n */\nIndex.prototype.getAll = function () {\n  var res = [];\n\n  this.tree.executeOnEveryNode(function (node) {\n    var i;\n\n    for (i = 0; i < node.data.length; i += 1) {\n      res.push(node.data[i]);\n    }\n  });\n\n  return res;\n};\n\n\n\n\n// Interface\nmodule.exports = Index;\n","module.exports.BinarySearchTree = require('./lib/bst');\nmodule.exports.AVLTree = require('./lib/avltree');\n","var bind = require('../internals/function-bind-context');\nvar IndexedObject = require('../internals/indexed-object');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\nvar push = [].push;\n\n// `Array.prototype.{ forEach, map, filter, some, every, find, findIndex }` methods implementation\nvar createMethod = function (TYPE) {\n  var IS_MAP = TYPE == 1;\n  var IS_FILTER = TYPE == 2;\n  var IS_SOME = TYPE == 3;\n  var IS_EVERY = TYPE == 4;\n  var IS_FIND_INDEX = TYPE == 6;\n  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n  return function ($this, callbackfn, that, specificCreate) {\n    var O = toObject($this);\n    var self = IndexedObject(O);\n    var boundFunction = bind(callbackfn, that, 3);\n    var length = toLength(self.length);\n    var index = 0;\n    var create = specificCreate || arraySpeciesCreate;\n    var target = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;\n    var value, result;\n    for (;length > index; index++) if (NO_HOLES || index in self) {\n      value = self[index];\n      result = boundFunction(value, index, O);\n      if (TYPE) {\n        if (IS_MAP) target[index] = result; // map\n        else if (result) switch (TYPE) {\n          case 3: return true;              // some\n          case 5: return value;             // find\n          case 6: return index;             // findIndex\n          case 2: push.call(target, value); // filter\n        } else if (IS_EVERY) return false;  // every\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : target;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.forEach` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.foreach\n  forEach: createMethod(0),\n  // `Array.prototype.map` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.map\n  map: createMethod(1),\n  // `Array.prototype.filter` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.filter\n  filter: createMethod(2),\n  // `Array.prototype.some` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.some\n  some: createMethod(3),\n  // `Array.prototype.every` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.every\n  every: createMethod(4),\n  // `Array.prototype.find` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.find\n  find: createMethod(5),\n  // `Array.prototype.findIndex` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.findIndex\n  findIndex: createMethod(6)\n};\n","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}","var global = require('../internals/global');\nvar DOMIterables = require('../internals/dom-iterables');\nvar ArrayIteratorMethods = require('../modules/es.array.iterator');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar ArrayValues = ArrayIteratorMethods.values;\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  var Collection = global[COLLECTION_NAME];\n  var CollectionPrototype = Collection && Collection.prototype;\n  if (CollectionPrototype) {\n    // some Chrome versions have non-configurable methods on DOMTokenList\n    if (CollectionPrototype[ITERATOR] !== ArrayValues) try {\n      createNonEnumerableProperty(CollectionPrototype, ITERATOR, ArrayValues);\n    } catch (error) {\n      CollectionPrototype[ITERATOR] = ArrayValues;\n    }\n    if (!CollectionPrototype[TO_STRING_TAG]) {\n      createNonEnumerableProperty(CollectionPrototype, TO_STRING_TAG, COLLECTION_NAME);\n    }\n    if (DOMIterables[COLLECTION_NAME]) for (var METHOD_NAME in ArrayIteratorMethods) {\n      // some Chrome versions have non-configurable methods on DOMTokenList\n      if (CollectionPrototype[METHOD_NAME] !== ArrayIteratorMethods[METHOD_NAME]) try {\n        createNonEnumerableProperty(CollectionPrototype, METHOD_NAME, ArrayIteratorMethods[METHOD_NAME]);\n      } catch (error) {\n        CollectionPrototype[METHOD_NAME] = ArrayIteratorMethods[METHOD_NAME];\n      }\n    }\n  }\n}\n","// .dirname, .basename, and .extname methods are extracted from Node.js v8.11.1,\n// backported and transplited with Babel, with backwards-compat fixes\n\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// resolves . and .. elements in a path array with directory names there\n// must be no slashes, empty elements, or device names (c:\\) in the array\n// (so also no leading and trailing slashes - it does not distinguish\n// relative and absolute paths)\nfunction normalizeArray(parts, allowAboveRoot) {\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = parts.length - 1; i >= 0; i--) {\n    var last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// path.resolve([from ...], to)\n// posix version\nexports.resolve = function() {\n  var resolvedPath = '',\n      resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = (i >= 0) ? arguments[i] : process.cwd();\n\n    // Skip empty and invalid entries\n    if (typeof path !== 'string') {\n      throw new TypeError('Arguments to path.resolve must be strings');\n    } else if (!path) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {\n    return !!p;\n  }), !resolvedAbsolute).join('/');\n\n  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';\n};\n\n// path.normalize(path)\n// posix version\nexports.normalize = function(path) {\n  var isAbsolute = exports.isAbsolute(path),\n      trailingSlash = substr(path, -1) === '/';\n\n  // Normalize the path\n  path = normalizeArray(filter(path.split('/'), function(p) {\n    return !!p;\n  }), !isAbsolute).join('/');\n\n  if (!path && !isAbsolute) {\n    path = '.';\n  }\n  if (path && trailingSlash) {\n    path += '/';\n  }\n\n  return (isAbsolute ? '/' : '') + path;\n};\n\n// posix version\nexports.isAbsolute = function(path) {\n  return path.charAt(0) === '/';\n};\n\n// posix version\nexports.join = function() {\n  var paths = Array.prototype.slice.call(arguments, 0);\n  return exports.normalize(filter(paths, function(p, index) {\n    if (typeof p !== 'string') {\n      throw new TypeError('Arguments to path.join must be strings');\n    }\n    return p;\n  }).join('/'));\n};\n\n\n// path.relative(from, to)\n// posix version\nexports.relative = function(from, to) {\n  from = exports.resolve(from).substr(1);\n  to = exports.resolve(to).substr(1);\n\n  function trim(arr) {\n    var start = 0;\n    for (; start < arr.length; start++) {\n      if (arr[start] !== '') break;\n    }\n\n    var end = arr.length - 1;\n    for (; end >= 0; end--) {\n      if (arr[end] !== '') break;\n    }\n\n    if (start > end) return [];\n    return arr.slice(start, end - start + 1);\n  }\n\n  var fromParts = trim(from.split('/'));\n  var toParts = trim(to.split('/'));\n\n  var length = Math.min(fromParts.length, toParts.length);\n  var samePartsLength = length;\n  for (var i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  var outputParts = [];\n  for (var i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n};\n\nexports.sep = '/';\nexports.delimiter = ':';\n\nexports.dirname = function (path) {\n  if (typeof path !== 'string') path = path + '';\n  if (path.length === 0) return '.';\n  var code = path.charCodeAt(0);\n  var hasRoot = code === 47 /*/*/;\n  var end = -1;\n  var matchedSlash = true;\n  for (var i = path.length - 1; i >= 1; --i) {\n    code = path.charCodeAt(i);\n    if (code === 47 /*/*/) {\n        if (!matchedSlash) {\n          end = i;\n          break;\n        }\n      } else {\n      // We saw the first non-path separator\n      matchedSlash = false;\n    }\n  }\n\n  if (end === -1) return hasRoot ? '/' : '.';\n  if (hasRoot && end === 1) {\n    // return '//';\n    // Backwards-compat fix:\n    return '/';\n  }\n  return path.slice(0, end);\n};\n\nfunction basename(path) {\n  if (typeof path !== 'string') path = path + '';\n\n  var start = 0;\n  var end = -1;\n  var matchedSlash = true;\n  var i;\n\n  for (i = path.length - 1; i >= 0; --i) {\n    if (path.charCodeAt(i) === 47 /*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          start = i + 1;\n          break;\n        }\n      } else if (end === -1) {\n      // We saw the first non-path separator, mark this as the end of our\n      // path component\n      matchedSlash = false;\n      end = i + 1;\n    }\n  }\n\n  if (end === -1) return '';\n  return path.slice(start, end);\n}\n\n// Uses a mixed approach for backwards-compatibility, as ext behavior changed\n// in new Node.js versions, so only basename() above is backported here\nexports.basename = function (path, ext) {\n  var f = basename(path);\n  if (ext && f.substr(-1 * ext.length) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n};\n\nexports.extname = function (path) {\n  if (typeof path !== 'string') path = path + '';\n  var startDot = -1;\n  var startPart = 0;\n  var end = -1;\n  var matchedSlash = true;\n  // Track the state of characters (if any) we see before our first dot and\n  // after any path separator we find\n  var preDotState = 0;\n  for (var i = path.length - 1; i >= 0; --i) {\n    var code = path.charCodeAt(i);\n    if (code === 47 /*/*/) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          startPart = i + 1;\n          break;\n        }\n        continue;\n      }\n    if (end === -1) {\n      // We saw the first non-path separator, mark this as the end of our\n      // extension\n      matchedSlash = false;\n      end = i + 1;\n    }\n    if (code === 46 /*.*/) {\n        // If this is our first dot, mark it as the start of our extension\n        if (startDot === -1)\n          startDot = i;\n        else if (preDotState !== 1)\n          preDotState = 1;\n    } else if (startDot !== -1) {\n      // We saw a non-dot and non-path separator before our dot, so we should\n      // have a good chance at having a non-empty extension\n      preDotState = -1;\n    }\n  }\n\n  if (startDot === -1 || end === -1 ||\n      // We saw a non-dot character immediately before the dot\n      preDotState === 0 ||\n      // The (right-most) trimmed path component is exactly '..'\n      preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n    return '';\n  }\n  return path.slice(startDot, end);\n};\n\nfunction filter (xs, f) {\n    if (xs.filter) return xs.filter(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        if (f(xs[i], i, xs)) res.push(xs[i]);\n    }\n    return res;\n}\n\n// String.prototype.substr - negative index don't work in IE8\nvar substr = 'ab'.substr(-1) === 'b'\n    ? function (str, start, len) { return str.substr(start, len) }\n    : function (str, start, len) {\n        if (start < 0) start = str.length + start;\n        return str.substr(start, len);\n    }\n;\n","/**\n * Responsible for sequentially executing actions on the database\n */\n\nvar async = require('async')\n  ;\n\nfunction Executor () {\n  this.buffer = [];\n  this.ready = false;\n\n  // This queue will execute all commands, one-by-one in order\n  this.queue = async.queue(function (task, cb) {\n    var newArguments = [];\n\n    // task.arguments is an array-like object on which adding a new field doesn't work, so we transform it into a real array\n    for (var i = 0; i < task.arguments.length; i += 1) { newArguments.push(task.arguments[i]); }\n    var lastArg = task.arguments[task.arguments.length - 1];\n\n    // Always tell the queue task is complete. Execute callback if any was given.\n    if (typeof lastArg === 'function') {\n      // Callback was supplied\n      newArguments[newArguments.length - 1] = function () {\n        if (typeof setImmediate === 'function') {\n           setImmediate(cb);\n        } else {\n          process.nextTick(cb);\n        }\n        lastArg.apply(null, arguments);\n      };\n    } else if (!lastArg && task.arguments.length !== 0) {\n      // false/undefined/null supplied as callbback\n      newArguments[newArguments.length - 1] = function () { cb(); };\n    } else {\n      // Nothing supplied as callback\n      newArguments.push(function () { cb(); });\n    }\n\n\n    task.fn.apply(task.this, newArguments);\n  }, 1);\n}\n\n\n/**\n * If executor is ready, queue task (and process it immediately if executor was idle)\n * If not, buffer task for later processing\n * @param {Object} task\n *                 task.this - Object to use as this\n *                 task.fn - Function to execute\n *                 task.arguments - Array of arguments, IMPORTANT: only the last argument may be a function (the callback)\n *                                                                 and the last argument cannot be false/undefined/null\n * @param {Boolean} forceQueuing Optional (defaults to false) force executor to queue task even if it is not ready\n */\nExecutor.prototype.push = function (task, forceQueuing) {\n  if (this.ready || forceQueuing) {\n    this.queue.push(task);\n  } else {\n    this.buffer.push(task);\n  }\n};\n\n\n/**\n * Queue all tasks in buffer (in the same order they came in)\n * Automatically sets executor as ready\n */\nExecutor.prototype.processBuffer = function () {\n  var i;\n  this.ready = true;\n  for (i = 0; i < this.buffer.length; i += 1) { this.queue.push(this.buffer[i]); }\n  this.buffer = [];\n};\n\n\n\n// Interface\nmodule.exports = Executor;\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","/**\n * Manage access to data, be it to find, update or remove it\n */\nvar model = require('./model')\n  , _ = require('underscore')\n  ;\n\n\n\n/**\n * Create a new cursor for this collection\n * @param {Datastore} db - The datastore this cursor is bound to\n * @param {Query} query - The query this cursor will operate on\n * @param {Function} execFn - Handler to be executed after cursor has found the results and before the callback passed to find/findOne/update/remove\n */\nfunction Cursor (db, query, execFn) {\n  this.db = db;\n  this.query = query || {};\n  if (execFn) { this.execFn = execFn; }\n}\n\n\n/**\n * Set a limit to the number of results\n */\nCursor.prototype.limit = function(limit) {\n  this._limit = limit;\n  return this;\n};\n\n\n/**\n * Skip a the number of results\n */\nCursor.prototype.skip = function(skip) {\n  this._skip = skip;\n  return this;\n};\n\n\n/**\n * Sort results of the query\n * @param {SortQuery} sortQuery - SortQuery is { field: order }, field can use the dot-notation, order is 1 for ascending and -1 for descending\n */\nCursor.prototype.sort = function(sortQuery) {\n  this._sort = sortQuery;\n  return this;\n};\n\n\n/**\n * Add the use of a projection\n * @param {Object} projection - MongoDB-style projection. {} means take all fields. Then it's { key1: 1, key2: 1 } to take only key1 and key2\n *                              { key1: 0, key2: 0 } to omit only key1 and key2. Except _id, you can't mix takes and omits\n */\nCursor.prototype.projection = function(projection) {\n  this._projection = projection;\n  return this;\n};\n\n\n/**\n * Apply the projection\n */\nCursor.prototype.project = function (candidates) {\n  var res = [], self = this\n    , keepId, action, keys\n    ;\n\n  if (this._projection === undefined || Object.keys(this._projection).length === 0) {\n    return candidates;\n  }\n\n  keepId = this._projection._id === 0 ? false : true;\n  this._projection = _.omit(this._projection, '_id');\n\n  // Check for consistency\n  keys = Object.keys(this._projection);\n  keys.forEach(function (k) {\n    if (action !== undefined && self._projection[k] !== action) { throw new Error(\"Can't both keep and omit fields except for _id\"); }\n    action = self._projection[k];\n  });\n\n  // Do the actual projection\n  candidates.forEach(function (candidate) {\n    var toPush;\n    if (action === 1) {   // pick-type projection\n      toPush = { $set: {} };\n      keys.forEach(function (k) {\n        toPush.$set[k] = model.getDotValue(candidate, k);\n        if (toPush.$set[k] === undefined) { delete toPush.$set[k]; }\n      });\n      toPush = model.modify({}, toPush);\n    } else {   // omit-type projection\n      toPush = { $unset: {} };\n      keys.forEach(function (k) { toPush.$unset[k] = true });\n      toPush = model.modify(candidate, toPush);\n    }\n    if (keepId) {\n      toPush._id = candidate._id;\n    } else {\n      delete toPush._id;\n    }\n    res.push(toPush);\n  });\n\n  return res;\n};\n\n\n/**\n * Get all matching elements\n * Will return pointers to matched elements (shallow copies), returning full copies is the role of find or findOne\n * This is an internal function, use exec which uses the executor\n *\n * @param {Function} callback - Signature: err, results\n */\nCursor.prototype._exec = function(_callback) {\n  var res = [], added = 0, skipped = 0, self = this\n    , error = null\n    , i, keys, key\n    ;\n\n  function callback (error, res) {\n    if (self.execFn) {\n      return self.execFn(error, res, _callback);\n    } else {\n      return _callback(error, res);\n    }\n  }\n\n  this.db.getCandidates(this.query, function (err, candidates) {\n    if (err) { return callback(err); }\n\n    try {\n      for (i = 0; i < candidates.length; i += 1) {\n        if (model.match(candidates[i], self.query)) {\n          // If a sort is defined, wait for the results to be sorted before applying limit and skip\n          if (!self._sort) {\n            if (self._skip && self._skip > skipped) {\n              skipped += 1;\n            } else {\n              res.push(candidates[i]);\n              added += 1;\n              if (self._limit && self._limit <= added) { break; }\n            }\n          } else {\n            res.push(candidates[i]);\n          }\n        }\n      }\n    } catch (err) {\n      return callback(err);\n    }\n\n    // Apply all sorts\n    if (self._sort) {\n      keys = Object.keys(self._sort);\n\n      // Sorting\n      var criteria = [];\n      for (i = 0; i < keys.length; i++) {\n        key = keys[i];\n        criteria.push({ key: key, direction: self._sort[key] });\n      }\n      res.sort(function(a, b) {\n        var criterion, compare, i;\n        for (i = 0; i < criteria.length; i++) {\n          criterion = criteria[i];\n          compare = criterion.direction * model.compareThings(model.getDotValue(a, criterion.key), model.getDotValue(b, criterion.key), self.db.compareStrings);\n          if (compare !== 0) {\n            return compare;\n          }\n        }\n        return 0;\n      });\n\n      // Applying limit and skip\n      var limit = self._limit || res.length\n        , skip = self._skip || 0;\n\n      res = res.slice(skip, skip + limit);\n    }\n\n    // Apply projection\n    try {\n      res = self.project(res);\n    } catch (e) {\n      error = e;\n      res = undefined;\n    }\n\n    return callback(error, res);\n  });\n};\n\nCursor.prototype.exec = function () {\n  this.db.executor.push({ this: this, fn: this._exec, arguments: arguments });\n};\n\n\n\n// Interface\nmodule.exports = Cursor;\n","// iterable DOM collections\n// flag - `iterable` interface - 'entries', 'keys', 'values', 'forEach' methods\nmodule.exports = {\n  CSSRuleList: 0,\n  CSSStyleDeclaration: 0,\n  CSSValueList: 0,\n  ClientRectList: 0,\n  DOMRectList: 0,\n  DOMStringList: 0,\n  DOMTokenList: 1,\n  DataTransferItemList: 0,\n  FileList: 0,\n  HTMLAllCollection: 0,\n  HTMLCollection: 0,\n  HTMLFormElement: 0,\n  HTMLSelectElement: 0,\n  MediaList: 0,\n  MimeTypeArray: 0,\n  NamedNodeMap: 0,\n  NodeList: 1,\n  PaintRequestList: 0,\n  Plugin: 0,\n  PluginArray: 0,\n  SVGLengthList: 0,\n  SVGNumberList: 0,\n  SVGPathSegList: 0,\n  SVGPointList: 0,\n  SVGStringList: 0,\n  SVGTransformList: 0,\n  SourceBufferList: 0,\n  StyleSheetList: 0,\n  TextTrackCueList: 0,\n  TextTrackList: 0,\n  TouchList: 0\n};\n"],"sourceRoot":""}